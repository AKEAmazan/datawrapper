!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@datawrapper/shared/chart")):"function"==typeof define&&define.amd?define("svelte/editor",["@datawrapper/shared/chart"],e):t.editor=e(t.Chart)}(this,function(t){"use strict";function e(){}function n(t,e){for(var n in e)t[n]=e[n];return t}function i(t,e,n){e.insertBefore(t,n)}function r(t){t.parentNode.removeChild(t)}function s(t){return document.createTextNode(t)}function a(t){this.destroy=e,this.fire("destroy"),this.set=this.get=e,!1!==t&&this._fragment.u(),this._fragment.d(),this._fragment=this._state=null}function o(t,e){t._handlers=Object.create(null),t._bind=e._bind,t.options=e,t.root=e.root||t,t.store=t.root.store||e.store}function c(t){for(;t&&t.length;)t.shift()()}function u(){this.store._remove(this)}t=t&&t.hasOwnProperty("default")?t.default:t;var h={destroy:a,get:function(t){return t?this._state[t]:this._state},fire:function(t,e){var n=t in this._handlers&&this._handlers[t].slice();if(n)for(var i=0;i<n.length;i+=1){var r=n[i];r.__calling||(r.__calling=!0,r.call(this,e),r.__calling=!1)}},observe:function(t,e,n){var i=e.bind(this);return n&&!1===n.init||i(this.get()[t],void 0),this.on(n&&n.defer?"update":"state",function(e){e.changed[t]&&i(e.current[t],e.previous&&e.previous[t])})},on:function(t,e){if("teardown"===t)return this.on("destroy",e);var n=this._handlers[t]||(this._handlers[t]=[]);return n.push(e),{cancel:function(){var t=n.indexOf(e);~t&&n.splice(t,1)}}},set:function(t){this._set(n({},t)),this.root._lock||(this.root._lock=!0,c(this.root._beforecreate),c(this.root._oncreate),c(this.root._aftercreate),this.root._lock=!1)},teardown:a,_recompute:e,_set:function(t){var e=this._state,i={},r=!1;for(var s in t)this._differs(t[s],e[s])&&(i[s]=r=!0);r&&(this._state=n(n({},e),t),this._recompute(i,this._state),this._bind&&this._bind(i,this._state),this._fragment&&(this.fire("state",{changed:i,current:this._state,previous:e}),this._fragment.p(i,this._state),this.fire("update",{changed:i,current:this._state,previous:e})))},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_unmount:function(){this._fragment&&this._fragment.u()},_differs:function(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}},f=window.dw;function d(t,e){var n=arguments;if(void 0===e&&(e="core"),t=t.trim(),!f.backend.__messages[e])return"MISSING:"+t;var i=f.backend.__messages[e][t]||f.backend.__messages.core[t]||t;if(arguments.length>2)for(var r=2;r<arguments.length;r++){var s=r-1;i=i.replace("$"+s,n[r])}return i}var _="./EditorNav.html",p="../publish/PublishSidebar.html";function l(t,e){var n,a,o={},c={};"step"in e&&(c.active=e.step,o.active=!0),"maxStep"in e&&(c.maxStep=e.maxStep,o.maxStep=!0),"steps"in e&&(c.steps=e.steps,o.steps=!0),"$chart"in e&&(c.chart=e.$chart,o.chart=!0);var u=new _({root:t.root,data:c,_bind:function(e,n){t.get();var i={},r={};!o.active&&e.active&&(i.step=n.active),!o.maxStep&&e.maxStep&&(i.maxStep=n.maxStep),!o.steps&&e.steps&&(i.steps=n.steps),!o.chart&&e.chart&&(r.chart=n.chart),t.store.set(r),t._set(i),o={}}});function h(t){return"upload"==t.step?m:"describe"==t.step?v:"visualize"==t.step?g:"publish"==t.step?b:S}t.root._beforecreate.push(function(){u._bind({active:1,maxStep:1,steps:1,chart:1},u.get())});var f=h(e),d=f(t,e);return{c:function(){var t;u._fragment.c(),n=s("\n\n"),t="div",a=document.createElement(t),d.c()},m:function(t,e){u._mount(t,e),i(n,t,e),i(a,t,e),d.m(a,null)},p:function(e,n){var i={};!o.active&&e.step&&(i.active=n.step,o.active=!0),!o.maxStep&&e.maxStep&&(i.maxStep=n.maxStep,o.maxStep=!0),!o.steps&&e.steps&&(i.steps=n.steps,o.steps=!0),!o.chart&&e.$chart&&(i.chart=n.$chart,o.chart=!0),u._set(i),o={},f!==(f=h(n))&&(d.u(),d.d(),(d=f(t,n)).c(),d.m(a,null))},u:function(){u._unmount(),r(n),r(a),d.u()},d:function(){u.destroy(!1),d.d()}}}function m(t,n){var a;return{c:function(){a=s("UPLOAD")},m:function(t,e){i(a,t,e)},u:function(){r(a)},d:e}}function v(t,n){var a;return{c:function(){a=s("DESCRIBE")},m:function(t,e){i(a,t,e)},u:function(){r(a)},d:e}}function g(t,n){var a;return{c:function(){a=s("VISUALIZE")},m:function(t,e){i(a,t,e)},u:function(){r(a)},d:e}}function b(t,e){var n=new p({root:t.root});return{c:function(){n._fragment.c()},m:function(t,e){n._mount(t,e)},u:function(){n._unmount()},d:function(){n.destroy(!1)}}}function S(t,n){var a;return{c:function(){a=s(":(")},m:function(t,e){i(a,t,e)},u:function(){r(a)},d:e}}function x(t){o(this,t),this._state=n(n(this.store._init(["chart"]),{datasets:[],steps:[{id:"upload",title:d("Upload Data")},{id:"describe",title:d("Check & Describe")},{id:"visualize",title:d("Visualize")},{id:"publish",title:d("Publish & Embed")}]}),t.data),this.store._add(this,["chart"]),this._handlers.destroy=[u];var e=this;t.root||(this._oncreate=[],this._beforecreate=[],this._aftercreate=[]),this._fragment=l(this,this._state),this.root._oncreate.push(function(){(function(){}).call(e),e.fire("update",{changed:{step:1,maxStep:1,steps:1,$chart:1},current:e._state})}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),this._lock=!0,c(this._beforecreate),c(this._oncreate),c(this._aftercreate),this._lock=!1)}n(x.prototype,h);return{App:x,Chart:t,data:{}}});

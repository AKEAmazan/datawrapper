!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("svelte/folder",e):(t=t||self).folder=e()}(this,(function(){"use strict";function t(){}function e(t,e){for(var n in e)t[n]=e[n];return t}function n(t){t()}function i(t,e){t.appendChild(e)}function o(t,e,n){t.insertBefore(e,n)}function r(t){t.parentNode.removeChild(t)}function s(t,e){for(var n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function a(t){return document.createElement(t)}function c(t){return document.createTextNode(t)}function l(t,e,n,i){t.addEventListener(e,n,i)}function u(t,e,n,i){t.removeEventListener(e,n,i)}function d(t,e){t.data=""+e}function f(t){return t}function h(e,i,o,r,s){var a,c,l,u=o.call(e,i,r),d=!1;return{t:s?0:1,running:!1,program:null,pending:null,run:function(t,e){var n=this;"function"==typeof u?v.wait().then((function(){u=u(),n._run(t,e)})):this._run(t,e)},_run:function(e,n){a=u.duration||300,c=u.easing||f;var o={start:window.performance.now()+(u.delay||0),b:e,callback:n||t};s&&!d&&(u.css&&u.delay&&(l=i.style.cssText,i.style.cssText+=u.css(0,1)),u.tick&&u.tick(0,1),d=!0),e||(o.group=p.current,p.current.remaining+=1),u.delay?this.pending=o:this.start(o),this.running||(this.running=!0,v.add(this))},start:function(t){if(e.fire((t.b?"intro":"outro")+".start",{node:i}),t.a=this.t,t.delta=t.b-t.a,t.duration=a*Math.abs(t.b-t.a),t.end=t.start+t.duration,u.css){u.delay&&(i.style.cssText=l);var n=function(t,e,n){for(var i=t.a,o=t.b,r=t.delta,s=16.666/t.duration,a="{\n",c=0;c<=1;c+=s){var l=i+r*e(c);a+=100*c+"%{"+n(l,1-l)+"}\n"}return a+"100% {"+n(o,1-o)+"}\n}"}(t,c,u.css);v.addRule(n,t.name="__svelte_"+function(t){for(var e=5381,n=t.length;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(n)),i.style.animation=(i.style.animation||"").split(", ").filter((function(e){return e&&(t.delta<0||!/__svelte/.test(e))})).concat(t.name+" "+t.duration+"ms linear 1 forwards").join(", ")}this.program=t,this.pending=null},update:function(t){var e=this.program;if(e){var n=t-e.start;this.t=e.a+e.delta*c(n/e.duration),u.tick&&u.tick(this.t,1-this.t)}},done:function(){var t=this.program;this.t=t.b,u.tick&&u.tick(this.t,1-this.t),e.fire((t.b?"intro":"outro")+".end",{node:i}),t.b||t.invalidated?u.css&&v.deleteRule(i,t.name):(t.group.callbacks.push((function(){t.callback(),u.css&&v.deleteRule(i,t.name)})),0==--t.group.remaining&&t.group.callbacks.forEach(n)),this.running=!!this.pending},abort:function(t){this.program&&(t&&u.tick&&u.tick(1,0),u.css&&v.deleteRule(i,this.program.name),this.program=this.pending=null,this.running=!1)},invalidate:function(){this.program&&(this.program.invalidated=!0)}}}var p={};function m(){p.current={remaining:0,callbacks:[]}}var v={running:!1,transitions:[],bound:null,stylesheet:null,activeRules:{},promise:null,add:function(t){this.transitions.push(t),this.running||(this.running=!0,requestAnimationFrame(this.bound||(this.bound=this.next.bind(this))))},addRule:function(t,e){if(!this.stylesheet){var n=a("style");document.head.appendChild(n),v.stylesheet=n.sheet}this.activeRules[e]||(this.activeRules[e]=!0,this.stylesheet.insertRule("@keyframes "+e+" "+t,this.stylesheet.cssRules.length))},next:function(){this.running=!1;for(var t=window.performance.now(),e=this.transitions.length;e--;){var n=this.transitions[e];n.program&&t>=n.program.end&&n.done(),n.pending&&t>=n.pending.start&&n.start(n.pending),n.running?(n.update(t),this.running=!0):n.pending||this.transitions.splice(e,1)}if(this.running)requestAnimationFrame(this.bound);else if(this.stylesheet){for(var i=this.stylesheet.cssRules.length;i--;)this.stylesheet.deleteRule(i);this.activeRules={}}},deleteRule:function(t,e){t.style.animation=t.style.animation.split(", ").filter((function(t){return t&&-1===t.indexOf(e)})).join(", ")},wait:function(){return v.promise||(v.promise=Promise.resolve(),v.promise.then((function(){v.promise=null}))),v.promise}};function g(){return Object.create(null)}function _(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function y(t,e){return t!=t?e==e:t!==e}function b(t,e){var n=t in this._handlers&&this._handlers[t].slice();if(n)for(var i=0;i<n.length;i+=1){var o=n[i];if(!o.__calling)try{o.__calling=!0,o.call(this,e)}finally{o.__calling=!1}}}function N(t){t._lock=!0,x(t._beforecreate),x(t._oncreate),x(t._aftercreate),t._lock=!1}function k(){return this._state}function w(t,e){var n=this._handlers[t]||(this._handlers[t]=[]);return n.push(e),{cancel:function(){var t=n.indexOf(e);~t&&n.splice(t,1)}}}function x(t){for(;t&&t.length;)t.shift()()}var R={destroy:function(e){this.destroy=t,this.fire("destroy"),this.set=t,this._fragment.d(!1!==e),this._fragment=null,this._state={}},get:k,fire:b,on:w,set:function(t){this._set(e({},t)),this.root._lock||N(this.root)},_recompute:t,_set:function(t){var n=this._state,i={},o=!1;for(var r in t=e(this._staged,t),this._staged={},t)this._differs(t[r],n[r])&&(i[r]=o=!0);o&&(this._state=e(e({},n),t),this._recompute(i,this._state),this._bind&&this._bind(i,this._state),this._fragment&&(this.fire("state",{changed:i,current:this._state,previous:n}),this._fragment.p(i,this._state),this.fire("update",{changed:i,current:this._state,previous:n})))},_stage:function(t){e(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:_};function L(t,e,n,i,o){var r={method:e,body:i,mode:"cors",credentials:n};return window.fetch(t,r).then((function(t){if(!t.ok)throw new Error(t.statusText);return t.text()})).then((function(t){try{return JSON.parse(t)}catch(e){return console.warn("malformed json input",t),t}})).then((function(t){return o&&o(t),t})).catch((function(t){console.error(t)}))}function C(t){var e=t-1;return e*e*e+1}function T(t,e){var n=e.delay;void 0===n&&(n=0);var i=e.duration;void 0===i&&(i=400);var o=+getComputedStyle(t).opacity;return{delay:n,duration:i,css:function(t){return"opacity: "+t*o}}}function F(t,e){var n=e.delay;void 0===n&&(n=0);var i=e.duration;void 0===i&&(i=400);var o=e.easing;void 0===o&&(o=C);var r=getComputedStyle(t),s=+r.opacity,a=parseFloat(r.height),c=parseFloat(r.paddingTop),l=parseFloat(r.paddingBottom),u=parseFloat(r.marginTop),d=parseFloat(r.marginBottom),f=parseFloat(r.borderTopWidth),h=parseFloat(r.borderBottomWidth);return{delay:n,duration:i,easing:o,css:function(t){return"overflow: hidden;opacity: "+Math.min(20*t,1)*s+";height: "+t*a+"px;padding-top: "+t*c+"px;padding-bottom: "+t*l+"px;margin-top: "+t*u+"px;margin-bottom: "+t*d+"px;border-top-width: "+t*f+"px;border-bottom-width: "+t*h+"px;"}}}var O=function(t,e,n,i){if(n){if("root"===e.type)return null;if(["user","team"].indexOf(e.type)>-1)return{type:"root",id:null}}for(var o=0;o<t.length;o++){if((!t[o].type||t[o].type===e.type)&&t[o].id===e.id)return n?i:t[o];var r=O(t[o].folders,e,n,t[o]);if(r)return r}};function E(t){return{user:"fa fa-user",team:"fa fa-users"}[t]||"im im-folder"}function P(t){return"tables"==t?"fa fa-table":t.indexOf("maps")>-1?"fa fa-map-marker":"fa fa-bar-chart-o"}function I(t){return"root"===t.type?"All":"user"===t.type?"My Charts":t.name}var j={add:function(){var t=this;this.set({creating:!0});var e,n,i=this.get(),o=i.position,r={name:i.folderName};"team"==o.type?r.organizationId=o.id:o.type||(r.parentId=o.id),e=window.location.protocol+"//"+dw.backend.__api_domain+"/v3/folders",n=JSON.stringify(r),L(e,"POST","include",n,(function(e){t.updateFolders((function(n){t.set({position:e,create:!1,creating:!1})}))}))},up:function(){var t=this.get(),e=t.position,n=t.folders;if(t.create)this.set({create:!1});else{var i=O(n,e,!0);this.set({position:i})}},move:function(){var t=this;this.set({moving:!0});var e,n,i=this.get(),o=i.position,r=i.chartId,s={};s="user"==o.type?{organizationId:null,folderId:null}:"team"==o.type?{organizationId:o.id,folderId:null}:{folderId:o.id},e=window.location.protocol+"//"+dw.backend.__api_domain+"/v3/charts/"+r,n=JSON.stringify(s),L(e,"PATCH","include",n,(function(e){t.set({current:o}),t.updateFolders((function(e){t.set({moving:!1,position:O(e,o)})}))}))},updateFolders:function(t){var e=this;!function(t,e,n){2===arguments.length&&(n=e,e="include"),L(t,"GET",e,null,n)}(window.location.protocol+"//"+dw.backend.__api_domain+"/v3/folders","include",(function(n){e.set({folders:n}),"function"==typeof t&&t(n)}))},init:function(){var t=this;this.set({loading:!0}),this.updateFolders((function(e){t.set({loading:!1});var n=t.get().current;t.set({position:O(e,n)})}))}};function A(t,e,n){var i=Object.create(t);return i.element=e[n],i}function S(t){var e=this._svelte,n=e.component,i=e.ctx;n.set({position:i.element})}function M(t,e,n){var i=Object.create(t);return i.element=e[n],i}function B(t,e){var n,i=e.show&&z(t,e);return{c:function(){i&&i.c(),n=document.createComment("")},m:function(t,e){i&&i.m(t,e),o(t,n,e)},p:function(e,o){o.show?i?i.p(e,o):((i=z(t,o)).c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d:function(t){i&&i.d(t),t&&r(n)}}}function z(t,e){var n,i,s,c=[q,J,H],l=[];function u(t){return t.loading?0:t.create?1:2}return i=u(e),s=l[i]=c[i](t,e),{c:function(){n=a("div"),s.c(),n.className="cont svelte-1v2ri2l"},m:function(t,e){o(t,n,e),l[i].i(n,null)},p:function(e,o){var r=i;(i=u(o))===r?l[i].p(e,o):(m(),s.o((function(){l[r].d(1),l[r]=null})),(s=l[i])||(s=l[i]=c[i](t,o)).c(),s.i(n,null))},d:function(t){t&&r(n),l[i].d()}}}function H(t,e){var f,h,p,v,g,_,y,b,N,k,w,x,R,L,C,T,F,O,E,P,j,S=I(e.position);function B(e){t.up()}for(var z=e.folderList,H=[],J=0;J<z.length;J+=1)H[J]=W(t,M(e,z,J));function q(t,e,n){H[t]&&H[t].o((function(){e&&(H[t].d(e),H[t]=null),n&&n()}))}var U=e.chartList,D=[];for(J=0;J<U.length;J+=1)D[J]=$(t,A(e,U,J));function K(t,e,n){D[t]&&D[t].o((function(){e&&(D[t].d(e),D[t]=null),n&&n()}))}var Q=0===e.chartList.length&&0===e.folderList.length&&G();function V(e){t.set({create:!0})}function X(e){t.move()}return{c:function(){f=a("div"),h=a("div"),p=a("i"),g=c("\n\n        "),_=a("div"),y=c(S),b=c("\n    "),N=a("div");for(var t=0;t<H.length;t+=1)H[t].c();k=c(" ");for(t=0;t<D.length;t+=1)D[t].c();w=c(" "),Q&&Q.c(),x=c("\n    "),R=a("div"),L=a("button"),C=a("i"),T=c("\n\n        "),F=a("button"),O=a("i"),P=c("\n            Move Here"),p.className="im im-angle-left svelte-1v2ri2l",l(h,"click",B),h.className="up svelte-1v2ri2l",h.style.cssText=v=e.isRoot?"visibility: hidden":"",_.className="title svelte-1v2ri2l",f.className="header svelte-1v2ri2l",N.className="body svelte-1v2ri2l",C.className="im im-folder-add",l(L,"click",V),L.className="btn",L.disabled=e.isRoot,O.className=E=e.moving?"fa fa-circle-o-notch fa-spin":"im im-check-mark-circle-o",l(F,"click",X),F.className="btn btn-primary",F.disabled=e.isRoot,R.className="footer svelte-1v2ri2l"},m:function(t,e){o(t,f,e),i(f,h),i(h,p),i(f,g),i(f,_),i(_,y),o(t,b,e),o(t,N,e);for(var n=0;n<H.length;n+=1)H[n].i(N,null);i(N,k);for(n=0;n<D.length;n+=1)D[n].i(N,null);i(N,w),Q&&Q.m(N,null),o(t,x,e),o(t,R,e),i(R,L),i(L,C),i(R,T),i(R,F),i(F,O),i(F,P),j=!0},p:function(e,n){if(j&&!e.isRoot||v===(v=n.isRoot?"visibility: hidden":"")||(h.style.cssText=v),j&&!e.position||S===(S=I(n.position))||d(y,S),e.folderList){z=n.folderList;for(var i=0;i<z.length;i+=1){var o=M(n,z,i);H[i]?H[i].p(e,o):(H[i]=W(t,o),H[i].c()),H[i].i(N,k)}for(m();i<H.length;i+=1)q(i,1)}if(e.chartList){U=n.chartList;for(i=0;i<U.length;i+=1){var r=A(n,U,i);D[i]?D[i].p(e,r):(D[i]=$(t,r),D[i].c()),D[i].i(N,w)}for(m();i<D.length;i+=1)K(i,1)}0===n.chartList.length&&0===n.folderList.length?Q||((Q=G()).c(),Q.m(N,null)):Q&&(Q.d(1),Q=null),j&&!e.isRoot||(L.disabled=n.isRoot),j&&!e.moving||E===(E=n.moving?"fa fa-circle-o-notch fa-spin":"im im-check-mark-circle-o")||(O.className=E),j&&!e.isRoot||(F.disabled=n.isRoot)},i:function(t,e){j||this.m(t,e)},o:n,d:function(t){t&&r(f),u(h,"click",B),t&&(r(b),r(N)),s(H,t),s(D,t),Q&&Q.d(),t&&(r(x),r(R)),u(L,"click",V),u(F,"click",X)}}}function J(t,e){var s,f,p,m,v,g,_,y,b,N,k,w,x,R,L,C,F,O,E,P,j=!1,A=I(e.position);function S(e){t.up()}function M(){j=!0,t.set({folderName:g.value}),j=!1}function B(e){t.add()}return{c:function(){var t,n,i;s=a("div"),f=a("div"),p=a("i"),v=c("\n\n        "),g=a("input"),_=c("\n\n        "),y=a("button"),b=a("i"),w=c("\n    "),x=a("div"),R=a("div"),L=c("Create a new folder in "),C=c(A),F=c("."),O=c("\n    "),E=a("div"),p.className="im im-angle-left svelte-1v2ri2l",l(f,"click",S),f.className="up svelte-1v2ri2l",f.style.cssText=m=e.isRoot?"visibility: hidden":"",l(g,"input",M),g.autofocus=!0,g.placeholder="Untitled folder",t=g,n="type",null==(i="text")?t.removeAttribute(n):t.setAttribute(n,i),g.className="svelte-1v2ri2l",b.className=N=(e.creating?"fa fa-circle-o-notch fa-spin":"im im-plus-circle")+" svelte-1v2ri2l",l(y,"click",B),y.disabled=k=0==e.folderName.length,y.className="btn btn-primary svelte-1v2ri2l",s.className="header svelte-1v2ri2l",R.className="empty svelte-1v2ri2l",x.className="body svelte-1v2ri2l",E.className="footer svelte-1v2ri2l"},m:function(t,n){o(t,s,n),i(s,f),i(f,p),i(s,v),i(s,g),g.value=e.folderName,i(s,_),i(s,y),i(y,b),o(t,w,n),o(t,x,n),i(x,R),i(R,L),i(R,C),i(R,F),o(t,O,n),o(t,E,n),P=!0,g.focus()},p:function(t,e){t.isRoot&&m!==(m=e.isRoot?"visibility: hidden":"")&&(f.style.cssText=m),!j&&t.folderName&&(g.value=e.folderName),t.creating&&N!==(N=(e.creating?"fa fa-circle-o-notch fa-spin":"im im-plus-circle")+" svelte-1v2ri2l")&&(b.className=N),t.folderName&&k!==(k=0==e.folderName.length)&&(y.disabled=k),t.position&&A!==(A=I(e.position))&&d(C,A)},i:function(e,n){P||(t.root._intro&&t.root._aftercreate.push((function(){h(t,x,T,{duration:200},!0).run(1)})),this.m(e,n))},o:n,d:function(t){t&&r(s),u(f,"click",S),u(g,"input",M),u(y,"click",B),t&&(r(w),r(x),r(O),r(E))}}}function q(e,i){var s,c;return{c:function(){var t,e;(s=a("div")).innerHTML='<i style="margin: 0px 6px 0px 10px" class="fa fa-circle-o-notch fa-spin svelte-1v2ri2l"></i>   Loading folders…\n\t\t\t    ',s.className="header svelte-1v2ri2l",t="border-bottom",e="none",s.style.setProperty(t,e)},m:function(t,e){o(t,s,e),c=!0},p:t,i:function(t,e){c||this.m(t,e)},o:n,d:function(t){t&&r(s)}}}function W(t,e){var n,s,f,p,m,v,g,_,y,b,N=I(e.element);return{c:function(){n=a("div"),s=a("i"),p=c("  \n            "),m=a("div"),v=c(N),g=c("\n            "),_=a("i"),s.className=f=E(e.element.type)+" svelte-1v2ri2l",m.className="svelte-1v2ri2l",_.className="im im-angle-right svelte-1v2ri2l",n._svelte={component:t,ctx:e},l(n,"click",S),n.className="li folder svelte-1v2ri2l"},m:function(t,e){o(t,n,e),i(n,s),i(n,p),i(n,m),i(m,v),i(n,g),i(n,_),b=!0},p:function(t,i){e=i,b&&!t.folderList||f===(f=E(e.element.type)+" svelte-1v2ri2l")||(s.className=f),b&&!t.folderList||N===(N=I(e.element))||d(v,N),n._svelte.ctx=e},i:function(e,i){b||(t.root._intro&&(y&&y.invalidate(),t.root._aftercreate.push((function(){y||(y=h(t,n,F,{duration:200},!0)),y.run(1)}))),this.m(e,i))},o:function(e){b&&(y||(y=h(t,n,F,{duration:200},!1)),y.run(0,(function(){e(),y=null})),b=!1)},d:function(t){t&&r(n),u(n,"click",S),t&&y&&y.abort()}}}function $(t,e){var n,s,l,u,f,p,m,v,g=e.element.title;return{c:function(){n=a("div"),s=a("i"),u=c("  \n            "),f=a("div"),p=c(g),s.className=l="fa "+P(e.element.type)+"  svelte-1v2ri2l",f.className="svelte-1v2ri2l",n.className="li chart svelte-1v2ri2l"},m:function(t,e){o(t,n,e),i(n,s),i(n,u),i(n,f),i(f,p),v=!0},p:function(t,e){v&&!t.chartList||l===(l="fa "+P(e.element.type)+"  svelte-1v2ri2l")||(s.className=l),v&&!t.chartList||g===(g=e.element.title)||d(p,g)},i:function(e,i){v||(t.root._intro&&(m&&m.invalidate(),t.root._aftercreate.push((function(){m||(m=h(t,n,T,{duration:200},!0)),m.run(1)}))),this.m(e,i))},o:function(e){v&&(m||(m=h(t,n,T,{duration:200},!1)),m.run(0,(function(){e(),m=null})),v=!1)},d:function(t){t&&(r(n),m&&m.abort())}}}function G(t,e){var n;return{c:function(){(n=a("div")).textContent="This folder is empty.",n.className="empty svelte-1v2ri2l"},m:function(t,e){o(t,n,e)},d:function(t){t&&r(n)}}}function U(t){!function(t,e){t._handlers=g(),t._slots=g(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}(this,t),this._state=e({chartId:null,position:{type:"root",id:null},folderName:""},t.data),this._recompute({position:1,folders:1},this._state),this._intro=!0,this._fragment=B(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),N(this))}function D(t,n){this._handlers={},this._dependents=[],this._computed=g(),this._sortedComputedProperties=[],this._state=e({},t),this._differs=n&&n.immutable?y:_}e(U.prototype,R),e(U.prototype,j),U.prototype._recompute=function(t,e){t.position&&this._differs(e.isRoot,e.isRoot="root"===e.position.type)&&(t.isRoot=!0),(t.position||t.folders)&&(this._differs(e.folderList,e.folderList=function(t){var e=t.position,n=t.folders;return n&&n.length?"root"===e.type?n:O(n,e).folders:[]}(e))&&(t.folderList=!0),this._differs(e.chartList,e.chartList=function(t){var e=t.position,n=t.folders;return n&&n.length?"root"===e.type?[]:O(n,e).charts:[]}(e))&&(t.chartList=!0))},e(D.prototype,{_add:function(t,e){this._dependents.push({component:t,props:e})},_init:function(t){for(var e={},n=0;n<t.length;n+=1){var i=t[n];e["$"+i]=this._state[i]}return e},_remove:function(t){for(var e=this._dependents.length;e--;)if(this._dependents[e].component===t)return void this._dependents.splice(e,1)},_set:function(t,n){var i=this,o=this._state;this._state=e(e({},o),t);for(var r=0;r<this._sortedComputedProperties.length;r+=1)this._sortedComputedProperties[r].update(this._state,n);this.fire("state",{changed:n,previous:o,current:this._state}),this._dependents.filter((function(t){for(var e={},o=!1,r=0;r<t.props.length;r+=1){var s=t.props[r];s in n&&(e["$"+s]=i._state[s],o=!0)}if(o)return t.component._stage(e),!0})).forEach((function(t){t.component.set({})})),this.fire("update",{changed:n,previous:o,current:this._state})},_sortComputedProperties:function(){var t,e=this._computed,n=this._sortedComputedProperties=[],i=g();function o(r){var s=e[r];s&&(s.deps.forEach((function(e){if(e===t)throw new Error("Cyclical dependency detected between "+e+" <-> "+r);o(e)})),i[r]||(i[r]=!0,n.push(s)))}for(var r in this._computed)o(t=r)},compute:function(t,n,i){var o,r=this,s={deps:n,update:function(e,s,a){var c=n.map((function(t){return t in s&&(a=!0),e[t]}));if(a){var l=i.apply(null,c);r._differs(l,o)&&(o=l,s[t]=!0,e[t]=o)}}};this._computed[t]=s,this._sortComputedProperties();var a=e({},this._state),c={};s.update(a,c,!0),this._set(a,c)},fire:b,get:k,on:w,set:function(t){var e=this._state,n=this._changed={},i=!1;for(var o in t){if(this._computed[o])throw new Error("'"+o+"' is a read-only computed property");this._differs(t[o],e[o])&&(n[o]=i=!0)}i&&this._set(t,n)}});return{App:U,data:{chart:{id:""}},store:new D({})}}));

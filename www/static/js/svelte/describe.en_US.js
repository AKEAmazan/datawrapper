!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("cm/lib/codemirror"),require("cm/mode/javascript/javascript"),require("cm/addon/mode/simple"),require("cm/addon/hint/show-hint"),require("cm/addon/edit/matchbrackets"),require("cm/addon/display/placeholder"),require("Handsontable")):"function"==typeof define&&define.amd?define("svelte/describe",["cm/lib/codemirror","cm/mode/javascript/javascript","cm/addon/mode/simple","cm/addon/hint/show-hint","cm/addon/edit/matchbrackets","cm/addon/display/placeholder","Handsontable"],t):e.describe=t(e.CodeMirror,null,null,null,null,null,e.HOT)}(this,function(e,t,n,o,a,r,s){"use strict";function i(){}function l(e){for(var t,n,o=arguments,a=1,r=arguments.length;a<r;a++)for(t in n=o[a])e[t]=n[t];return e}function u(e,t){t.appendChild(e)}function c(e,t,n){t.insertBefore(e,n)}function m(e){e.parentNode.removeChild(e)}function d(e){for(;e.previousSibling;)e.parentNode.removeChild(e.previousSibling)}function h(e){for(var t=0;t<e.length;t+=1)e[t]&&e[t].d()}function f(e){return document.createElement(e)}function p(e){return document.createTextNode(e)}function v(){return document.createComment("")}function g(e,t,n){e.addEventListener(t,n,!1)}function _(e,t,n){e.removeEventListener(t,n,!1)}function b(e,t,n){e.setAttribute(t,n)}function y(e,t,n){e.style.setProperty(t,n)}function w(e,t){for(var n=0;n<e.options.length;n+=1){var o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function x(e){var t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function C(){return Object.create(null)}function k(e){this.destroy=i,this.fire("destroy"),this.set=this.get=i,!1!==e&&this._fragment.u(),this._fragment.d(),this._fragment=this._state=null}function N(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function R(e,t){return e!=e?t==t:e!==t}function F(e,t,n,o,a){for(var r in t)if(n[r]){var s=o[r],i=a[r],l=t[r];if(l)for(var u=0;u<l.length;u+=1){var c=l[u];c.__calling||(c.__calling=!0,c.call(e,s,i),c.__calling=!1)}}}function S(e){return e?this._state[e]:this._state}function I(e,t){e._observers={pre:C(),post:C()},e._handlers=C(),e._bind=t._bind,e.options=t,e.root=t.root||e,e.store=e.root.store||t.store}function T(e,t,n){var o=n&&n.defer?this._observers.post:this._observers.pre;return(o[e]||(o[e]=[])).push(t),n&&!1===n.init||(t.__calling=!0,t.call(this,this._state[e]),t.__calling=!1),{cancel:function(){var n=o[e].indexOf(t);~n&&o[e].splice(n,1)}}}function H(e){for(;e&&e.length;)e.shift()()}e=e&&e.hasOwnProperty("default")?e.default:e,s=s&&s.hasOwnProperty("default")?s.default:s;var L={destroy:k,get:S,fire:function(e,t){var n=e in this._handlers&&this._handlers[e].slice();if(n)for(var o=0;o<n.length;o+=1)n[o].call(this,t)},observe:T,on:function(e,t){if("teardown"===e)return this.on("destroy",t);var n=this._handlers[e]||(this._handlers[e]=[]);return n.push(t),{cancel:function(){var e=n.indexOf(t);~e&&n.splice(e,1)}}},set:function(e){this._set(l({},e)),this.root._lock||(this.root._lock=!0,H(this.root._beforecreate),H(this.root._oncreate),H(this.root._aftercreate),this.root._lock=!1)},teardown:k,_recompute:i,_set:function(e){var t=this._state,n={},o=!1;for(var a in e)this._differs(e[a],t[a])&&(n[a]=o=!0);o&&(this._state=l({},t,e),this._recompute(n,this._state),this._bind&&this._bind(n,this._state),this._fragment&&(F(this,this._observers.pre,n,this._state,t),this._fragment.p(n,this._state),F(this,this._observers.post,n,this._state,t)))},_mount:function(e,t){this._fragment[this._fragment.i?"i":"m"](e,t||null)},_unmount:function(){this._fragment&&this._fragment.u()},_differs:N};function D(e){var t=typeof e;return"function"===t||"object"===t&&!!e}var E,O=Array.prototype,M=Object.prototype,P=O.slice,A=M.toString,j=M.hasOwnProperty,B=Array.isArray,q=Object.keys;function $(e,t){return null!=e&&j.call(e,t)}function z(e){if(!D(e))return[];if(q)return q(e);var t=[];for(var n in e)$(e,n)&&t.push(n);return le&&function(e,t){var n=ue.length,o=e.constructor,a=Y(o)&&o.prototype||M,r="constructor";$(e,r)&&!G(t,r)&&t.push(r);for(;n--;)(r=ue[n])in e&&e[r]!==a[r]&&!G(t,r)&&t.push(r)}(e,t),t}var V=function(e,t,n){return function(o,a,r){var s=0,i=se(o);if("number"==typeof r)e>0?s=r>=0?r:Math.max(r+i,s):i=r>=0?Math.min(r+1,i):r+i+1;else if(n&&r&&i)return r=n(o,a),o[r]===a?r:-1;if(a!=a)return(r=t(P.call(o,s,i),K))>=0?r+s:-1;for(r=e>0?s:i-1;r>=0&&r<i;r+=e)if(o[r]===a)return r;return-1}}(1,(E=1,function(e,t,n){t=ne(t,n);for(var o=se(e),a=E>0?0:o-1;a>=0&&a<o;a+=E)if(t(e[a],a,e))return a;return-1}),function(e,t,n,o){for(var a=(n=ne(n,o,1))(t),r=0,s=se(e);r<s;){var i=Math.floor((r+s)/2);n(e[i])<a?r=i+1:s=i}return r});function G(e,t,n,o){return ie(e)||(e=function(e){for(var t=z(e),n=t.length,o=Array(n),a=0;a<n;a++)o[a]=e[t[a]];return o}(e)),("number"!=typeof n||o)&&(n=0),V(e,t,n)>=0}var J=B||function(e){return"[object Array]"===A.call(e)};var Y=("function"!=typeof/./&&"object"!=typeof Int8Array&&"undefined"!=typeof document&&"function"!=typeof document.childNodes?function(e){return"function"==typeof e||!1}:null)||function(e){return"[object Function]"===A.call(e)};!function(){A.call(arguments)}();function K(e){return function(e){return"[object Number]"===A.call(e)}(e)&&isNaN(e)}var U=te;function W(e){return e}var Q,X,Z=(Q=z,function(e){var t=arguments,n=arguments.length;if(X&&(e=Object(e)),n<2||null==e)return e;for(var o=1;o<n;o++)for(var a=t[o],r=Q(a),s=r.length,i=0;i<s;i++){var l=r[i];!D(e)||X&&void 0!==e[l]||(e[l]=a[l])}return e});function ee(e){return e=Z({},e),function(t){return function(e,t){var n=z(t),o=n.length;if(null==e)return!o;for(var a=Object(e),r=0;r<o;r++){var s=n[r];if(t[s]!==a[s]||!(s in a))return!1}return!0}(t,e)}}function te(e,t){return ne(e,t,1/0)}function ne(e,t,n){return U!==te?U(e,t):null==e?W:Y(e)?function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,o,a){return e.call(t,n,o,a)};case 4:return function(n,o,a,r){return e.call(t,n,o,a,r)}}return function(){return e.apply(t,arguments)}}(e,t,n):D(e)?ee(e):ae(e)}function oe(e,t){return t=null==t?e.length-1:+t,function(){for(var n=arguments,o=Math.max(arguments.length-t,0),a=Array(o),r=0;r<o;r++)a[r]=n[r+t];switch(t){case 0:return e.call(this,a);case 1:return e.call(this,arguments[0],a);case 2:return e.call(this,arguments[0],arguments[1],a)}var s=Array(t+1);for(r=0;r<t;r++)s[r]=n[r];return s[t]=a,e.apply(this,s)}}function ae(e){return function(t){return null==t?void 0:t[e]}}var re=Math.pow(2,53)-1,se=ae("length"),ie=function(e){var t=se(e);return"number"==typeof t&&t>=0&&t<=re};var le=!{toString:null}.propertyIsEnumerable("toString"),ue=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];!function(e){for(var t={},n=z(e),o=0,a=n.length;o<a;o++)t[e[n[o]]]=n[o]}({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"});var ce=oe(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)});function me(e){if(!e||"object"!=typeof e)return e;try{return JSON.parse(JSON.stringify(e))}catch(t){return e}}var de={insert:function(e){var t=this.get().cm;t.replaceSelection(e.key),t.focus()},removeColumn:function(){var e=this.get().column,t=this.store.get("dw_chart"),n=t.dataset(),o=me(t.get("metadata.describe.computed-columns",{}));delete o[e.name()];var a=n.columnOrder()[n.indexOf(e.name())],r=[];t.get("metadata.data.changes",[]).forEach(function(e){e.column!=a&&(e.column>a&&e.column--,r.push(e))}),t.set("metadata.describe.computed-columns",o),t.set("metadata.data.changes",r),t.saveSoon(),this.fire("updateTable"),this.fire("unselect")}};function he(){var t=this,n=this.get().column,o=this.store.get("dw_chart"),a=o.get("metadata.describe.computed-columns",{});this.set({formula:a[n.name()]||"",name:n.title()}),this.observe("column",function(e){e&&t.set({formula:a[e.name()]||"",name:e.title()})});var r=this;var s=e.fromTextArea(this.refs.code,{value:this.get("formula")||"",mode:"simple",indentUnit:2,tabSize:2,lineWrapping:!0,matchBrackets:!0,placeholder:"// enter formula here",continueComments:"Enter",extraKeys:{Tab:"autocomplete"},hintOptions:{hint:function(t){var n=t.getCursor(),o=t.getTokenAt(n),a=[],s=r.get("keywords");return"variable"==o.type&&(a=s.filter(function(e){return 0===e.toLowerCase().indexOf(o.string.toLowerCase())})),{list:a,from:e.Pos(n.line,o.start),to:e.Pos(n.line,o.end)}}}});window.CodeMirror=e,this.set({cm:s});var i,l,u,c,m,d,h,f=(i=function(){return t.fire("updateTable")},l=1500,d=function(e,t){c=null,t&&(m=i.apply(e,t))},(h=oe(function(e){if(c&&clearTimeout(c),u){var t=!c;c=setTimeout(d,l),t&&(m=i.apply(this,e))}else c=ce(d,l,this,e);return m})).cancel=function(){clearTimeout(c),c=null},h);this.observe("formula",function(e){e!=s.getValue()&&s.setValue(e);var n=t.get().column,a=o.get("metadata.describe.computed-columns",{});a[n.name()]!=e&&(a[n.name()]=e,o.set("metadata.describe.computed-columns",a),o.saveSoon&&o.saveSoon(),f())}),this.observe("name",function(e){var n=t.get().column,a=o.get("metadata.data.changes",[]),r=o.dataset(),s=r.columnOrder()[r.indexOf(n.name())],i=-1;a.forEach(function(e,t){e.column==s&&0===e.row&&(i=t)}),i>-1?(a[i].value=e,a[i].time=(new Date).getTime()):a.push({column:s,row:0,value:e,time:(new Date).getTime()}),o.set("metadata.data.changes",a),o.saveSoon&&o.saveSoon(),f()}),s.on("change",function(e){t.set({formula:e.getValue()})}),this.observe("metaColumns",function(n){var o=new RegExp("(?:"+t.get("keywords").join("|")+")");e.defineSimpleMode("simplemode",{start:[{regex:/"(?:[^\\]|\\.)*?(?:"|$)/,token:"string"},{regex:/(function)(\s+)([a-z$][\w$]*)/,token:["keyword",null,"keyword"]},{regex:/(?:function|var|return|if|for|while|else|do|this)\b/,token:"keyword"},{regex:/true|false|null|undefined/,token:"atom"},{regex:/0x[a-f\d]+|[-+]?(?:\.\d+|\d+\.?\d*)(?:e[-+]?\d+)?/i,token:"number"},{regex:/\/\/.*/,token:"comment"},{regex:/\/(?:[^\\]|\\.)*?\//,token:"variable-3"},{regex:/\/\*/,token:"comment",next:"comment"},{regex:/[-+\/*=<>!]+/,token:"operator"},{regex:/[\{\[\(]/,indent:!0},{regex:/[\}\]\)]/,dedent:!0},{regex:o,token:"variable-2"},{regex:/[a-z$][\w$]*/,token:"variable"},{regex:/<</,token:"meta",mode:{spec:"xml",end:/>>/}}],comment:[{regex:/.*?\*\//,token:"comment",next:"start"},{regex:/.*/,token:"comment"}],meta:{dontIndentStates:["comment"],lineComment:"//"}}),s.setOption("mode","simplemode")})}function fe(e,t){var n,o,a=t.col,r=(t.col_index,a.key);return{c:function(){n=f("li"),o=p(r),this.h()},h:function(){n.className="svelte-du6ec3",g(n,"click",pe),n._svelte={component:e,metaColumns:t.metaColumns,col_index:t.col_index}},m:function(e,t){c(n,e,t),u(o,n)},p:function(e,t){a=t.col,t.col_index,e.metaColumns&&r!==(r=a.key)&&(o.data=r),n._svelte.metaColumns=t.metaColumns,n._svelte.col_index=t.col_index},u:function(){m(n)},d:function(){_(n,"click",pe)}}}function pe(e){var t=this._svelte.component,n=this._svelte.metaColumns[this._svelte.col_index];t.insert(n)}function ve(e){I(this,e),this.refs={},this._state=l({name:"",formula:""},e.data),this._recompute({column:1,columns:1,metaColumns:1},this._state);var t=he.bind(this);e.root||(this._oncreate=[]),this._fragment=function(e,t){var n,o,a,r,s,i,d,v,b,w,x,C,k,N,R,F,S,I,T,H,L,D,E,O,M,P,A,j=!1;function B(){j=!0,e.set({name:x.value}),j=!1}for(var q=t.metaColumns,$=[],z=0;z<q.length;z+=1)$[z]=fe(e,l({},t,{metaColumns:q,col:q[z],col_index:z}));function V(t){e.removeColumn()}return{c:function(){n=f("div"),o=f("h3"),a=p(t.title),r=p("\n    "),s=f("p"),i=p("The values for columns can be calculated using a formula, similar to Excel."),d=p("\n\n    "),v=f("label"),b=p("Column name"),w=p("\n    "),x=f("input"),C=p("\n\n    "),k=f("label"),N=p("Formula (JavaScript)"),R=p("\n    "),F=f("textarea"),S=p("\n\n    "),I=f("p"),T=p("Available columns (click to add them to the formula)"),H=p(":"),L=p("\n\n    "),D=f("ul");for(var e=0;e<$.length;e+=1)$[e].c();E=p("\n\n"),O=f("button"),M=f("i"),P=p(" "),A=p("Remove this column"),this.h()},h:function(){o.className="first",v.className="svelte-du6ec3",g(x,"input",B),x.type="text",k.className="svelte-du6ec3",F.className="code",y(I,"margin-top","1em"),D.className="col-select svelte-du6ec3",y(n,"margin-bottom","15px"),M.className="fa fa-trash",O.className="btn btn-danger",g(O,"click",V)},m:function(l,m){c(n,l,m),u(o,n),u(a,o),u(r,n),u(s,n),u(i,s),u(d,n),u(v,n),u(b,v),u(w,n),u(x,n),x.value=t.name,u(C,n),u(k,n),u(N,k),u(R,n),u(F,n),e.refs.code=F,u(S,n),u(I,n),u(T,I),u(H,I),u(L,n),u(D,n);for(var h=0;h<$.length;h+=1)$[h].m(D,null);c(E,l,m),c(O,l,m),u(M,O),u(P,O),u(A,O)},p:function(t,n){t.title&&(a.data=n.title),j||(x.value=n.name);var o=n.metaColumns;if(t.metaColumns){for(var r=0;r<o.length;r+=1){var s=l({},n,{metaColumns:o,col:o[r],col_index:r});$[r]?$[r].p(t,s):($[r]=fe(e,s),$[r].c(),$[r].m(D,null))}for(;r<$.length;r+=1)$[r].u(),$[r].d();$.length=o.length}},u:function(){m(n);for(var e=0;e<$.length;e+=1)$[e].u();m(E),m(O)},d:function(){_(x,"input",B),e.refs.code===F&&(e.refs.code=null),h($),_(O,"click",V)}}}(this,this._state),this.root._oncreate.push(t),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),H(this._oncreate))}function ge(e){I(this,e),this._state=l({disabled:!1},e.data),this._fragment=function(e,t){var n,o,a,r,s,i;function l(){e.set({value:a.checked})}return{c:function(){n=f("div"),o=f("label"),a=f("input"),r=p(" "),s=p(t.label),this.h()},h:function(){g(a,"change",l),a.type="checkbox",a.disabled=t.disabled,a.className="svelte-llolt7",o.className=i="checkbox "+(t.disabled?"disabled":"")+" svelte-llolt7",n.className="control-group vis-option-group vis-option-type-checkbox"},m:function(e,i){c(n,e,i),u(o,n),u(a,o),a.checked=t.value,u(r,o),u(s,o)},p:function(e,t){a.checked=t.value,e.disabled&&(a.disabled=t.disabled),e.label&&(s.data=t.label),e.disabled&&i!==(i="checkbox "+(t.disabled?"disabled":"")+" svelte-llolt7")&&(o.className=i)},u:function(){m(n)},d:function(){_(a,"change",l)}}}(this,this._state),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor))}function _e(e,t){var n,o,a,r=t.opt,s=(t.opt_index,r.label);return{c:function(){n=f("option"),o=p(s),this.h()},h:function(){n.__value=a=r.value,n.value=n.__value},m:function(e,t){c(n,e,t),u(o,n)},p:function(e,t){r=t.opt,t.opt_index,e.options&&s!==(s=r.label)&&(o.data=s),e.options&&a!==(a=r.value)&&(n.__value=a),n.value=n.__value},u:function(){m(n)},d:i}}function be(e,t){for(var n,o=t.options,a=[],r=0;r<o.length;r+=1)a[r]=_e(0,l({},t,{options:o,opt:o[r],opt_index:r}));return{c:function(){for(var e=0;e<a.length;e+=1)a[e].c();n=v()},m:function(e,t){for(var o=0;o<a.length;o+=1)a[o].m(e,t);c(n,e,t)},p:function(e,t){var o=t.options;if(e.options){for(var r=0;r<o.length;r+=1){var s=l({},t,{options:o,opt:o[r],opt_index:r});a[r]?a[r].p(e,s):(a[r]=_e(0,s),a[r].c(),a[r].m(n.parentNode,n))}for(;r<a.length;r+=1)a[r].u(),a[r].d();a.length=o.length}},u:function(){for(var e=0;e<a.length;e+=1)a[e].u();m(n)},d:function(){h(a)}}}function ye(e,t){for(var n,o,a=t.optgroup,r=(t.optgroup_index,a.options),s=[],i=0;i<r.length;i+=1)s[i]=we(e,l({},t,{options:r,opt:r[i],opt_index:i}));return{c:function(){n=f("optgroup");for(var e=0;e<s.length;e+=1)s[e].c();this.h()},h:function(){b(n,"label",o=a.label)},m:function(e,t){c(n,e,t);for(var o=0;o<s.length;o+=1)s[o].m(n,null)},p:function(t,r){a=r.optgroup,r.optgroup_index;var i=a.options;if(t.optgroups){for(var u=0;u<i.length;u+=1){var c=l({},r,{options:i,opt:i[u],opt_index:u});s[u]?s[u].p(t,c):(s[u]=we(e,c),s[u].c(),s[u].m(n,null))}for(;u<s.length;u+=1)s[u].u(),s[u].d();s.length=i.length}t.optgroups&&o!==(o=a.label)&&b(n,"label",o)},u:function(){m(n);for(var e=0;e<s.length;e+=1)s[e].u()},d:function(){h(s)}}}function we(e,t){t.optgroup;var n,o,a,r=t.opt,s=(t.optgroup_index,t.opt_index,r.label);return{c:function(){n=f("option"),o=p(s),this.h()},h:function(){n.__value=a=r.value,n.value=n.__value},m:function(e,t){c(n,e,t),u(o,n)},p:function(e,t){t.optgroup,r=t.opt,t.optgroup_index,t.opt_index,e.optgroups&&s!==(s=r.label)&&(o.data=s),e.optgroups&&a!==(a=r.value)&&(n.__value=a),n.value=n.__value},u:function(){m(n)},d:i}}function xe(e,t){for(var n,o=t.optgroups,a=[],r=0;r<o.length;r+=1)a[r]=ye(e,l({},t,{optgroups:o,optgroup:o[r],optgroup_index:r}));return{c:function(){for(var e=0;e<a.length;e+=1)a[e].c();n=v()},m:function(e,t){for(var o=0;o<a.length;o+=1)a[o].m(e,t);c(n,e,t)},p:function(t,o){var r=o.optgroups;if(t.optgroups){for(var s=0;s<r.length;s+=1){var i=l({},o,{optgroups:r,optgroup:r[s],optgroup_index:s});a[s]?a[s].p(t,i):(a[s]=ye(e,i),a[s].c(),a[s].m(n.parentNode,n))}for(;s<a.length;s+=1)a[s].u(),a[s].d();a.length=r.length}},u:function(){for(var e=0;e<a.length;e+=1)a[e].u();m(n)},d:function(){h(a)}}}function Ce(e){I(this,e),this._state=l({disabled:!1,width:"auto",options:[],optgroups:[]},e.data),e.root||(this._oncreate=[],this._beforecreate=[]),this._fragment=function(e,t){var n,o,a,r,s,i,l,d=!1,h=t.options.length&&be(0,t),b=t.optgroups.length&&xe(e,t);function C(){d=!0,e.set({value:x(s)}),d=!1}return{c:function(){n=f("div"),o=f("label"),a=p("\n\n    "),r=f("div"),s=f("select"),h&&h.c(),i=v(),b&&b.c(),this.h()},h:function(){o.className="control-label",g(s,"change",C),"value"in t||e.root._beforecreate.push(C),s.disabled=t.disabled,y(s,"width",t.width),r.className=l="controls form-inline "+(t.disabled?"disabled":""),n.className="control-group vis-option-type-select"},m:function(e,l){c(n,e,l),u(o,n),o.innerHTML=t.label,u(a,n),u(r,n),u(s,r),h&&h.m(s,null),u(i,s),b&&b.m(s,null),w(s,t.value)},p:function(t,n){t.label&&(o.innerHTML=n.label),n.options.length?h?h.p(t,n):((h=be(0,n)).c(),h.m(s,i)):h&&(h.u(),h.d(),h=null),n.optgroups.length?b?b.p(t,n):((b=xe(e,n)).c(),b.m(s,null)):b&&(b.u(),b.d(),b=null),d||w(s,n.value),t.disabled&&(s.disabled=n.disabled),t.width&&y(s,"width",n.width),t.disabled&&l!==(l="controls form-inline "+(n.disabled?"disabled":""))&&(r.className=l)},u:function(){o.innerHTML="",m(n),h&&h.u(),b&&b.u()},d:function(){h&&h.d(),b&&b.d(),_(s,"change",C)}}}(this,this._state),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),H(this._beforecreate))}l(ve.prototype,de,L),ve.prototype._recompute=function(e,t){var n,o;e.column&&this._differs(t.title,t.title=(n=t.column,"Edit column %s".replace("%s",'"'+(n?n.title()||n.name():"--")+'"')))&&(e.title=!0),e.columns&&this._differs(t.metaColumns,t.metaColumns=(o=t.columns)?o.map(function(e){return{key:(t=e.name(),t.toString().toLowerCase().replace(/\s+/g,"_").replace(/[^\w-]+/g,"").replace(/-/g,"_").replace(/__+/g,"_").replace(/^_+/,"").replace(/_+$/,"").replace(/^(\d)/,"_$1").replace(/^(abstract|arguments|await|boolean|break|byte|case|catch|char|class|const|continue|debugger|default|delete|do|double|else|enum|eval|export|extends|false|final|finally|float|for|function|goto|if|implements|import|in|instanceof|int|interface|let|long|native|new|null|package|private|protected|public|return|short|static|super|switch|synchronized|this|throw|throws|transient|true|try|typeof|var|void|volatile|while|window|with|yield)$/,"$1_")),title:e.title(),type:e.type()};var t}):[])&&(e.metaColumns=!0),e.metaColumns&&this._differs(t.keywords,t.keywords=function(e){var t=["sum","round","min","max","median","mean"];return e.forEach(function(e){t.push(e.key),"number"==e.type&&(t.push(e.key+"__sum"),t.push(e.key+"__min"),t.push(e.key+"__max"),t.push(e.key+"__mean"),t.push(e.key+"__median"))}),t}(t.metaColumns))&&(e.keywords=!0)},l(ge.prototype,L),l(Ce.prototype,L);var ke=Date.now||function(){return(new Date).getTime()};function Ne(e,t,n){var o,a,r,s,i=0;n||(n={});var l=function(){i=!1===n.leading?0:ke(),o=null,s=e.apply(a,r),o||(a=r=null)},u=function(){var u=ke();i||!1!==n.leading||(i=u);var c=t-(u-i);return a=this,r=arguments,c<=0||c>t?(o&&(clearTimeout(o),o=null),i=u,s=e.apply(a,r),o||(a=r=null)):o||!1===n.trailing||(o=setTimeout(l,c)),s};return u.cancel=function(){clearTimeout(o),i=0,o=a=r=null},u}function Re(e){if(J(e)){var t={};return Object.keys(e).forEach(function(n){return t[n]=e[n]}),t}return e}var Fe={autoDivisor:function(){var e=this.store.get("dw_chart"),t=this.get().column,n=dw.utils.metricSuffix(e.locale()),o=t.values(),a=dw.utils.significantDimension(o),r=a<-2?3*Math.round(-1*a/3):a>4?-1*a:0,s=o.map(function(e){return e/Math.pow(10,r)}),i=dw.utils.significantDimension(s);i<=0&&(i=s.reduce(function(e,t){return Math.max(e,Math.min(3,dw.utils.tailLength(t)))},0)),i==r&&(r=0,i=0),r>15&&(r=0,i=0),this.set({columnFormat:{"number-divisor":r,"number-format":"n"+Math.max(0,i),"number-prepend":"","number-append":r?n[r]||" × 10<sup>"+r+"</sup>":""}})},getColumnFormat:function(e){var t=me(Re(this.store.get("dw_chart").get("metadata.data.column-format",{}))[e.name()]);return t&&"auto"!=t&&void 0===t.length||(t={type:"auto",ignore:!1,"number-prepend":"","number-append":"","number-format":"auto"}),t}};function Se(e,t){var n,o,a,r,s,i,l,d,h,v,b={},w={},x=!1,C=!1,k={label:"Round numbers to",options:[{value:"-",label:"(auto-detect - case by case)"},{value:"auto",label:"(auto-detect - one for all)"}],optgroups:t.numberFormats,width:"180px"};"number-format"in t.columnFormat&&(k.value=t.columnFormat["number-format"],b.value=!0);var N=new Ce({root:e.root,data:k,_bind:function(t,n){var o=e.get(),a={};!b.value&&t.value&&(o.columnFormat["number-format"]=n.value,a.columnFormat=o.columnFormat),e._set(a),b={}}});e.root._beforecreate.push(function(){N._bind({value:1},N.get())});var R={label:"Divide/multiply by",options:t.divisors_opts,optgroups:t.divisors,width:"180px"};"number-divisor"in t.columnFormat&&(R.value=t.columnFormat["number-divisor"],w.value=!0);var F=new Ce({root:e.root,data:R,_bind:function(t,n){var o=e.get(),a={};!w.value&&t.value&&(o.columnFormat["number-divisor"]=n.value,a.columnFormat=o.columnFormat),e._set(a),w={}}});function S(){var t=e.get();x=!0,t.columnFormat["number-prepend"]=d.value,e.set({columnFormat:t.columnFormat}),x=!1}function I(){var t=e.get();C=!0,t.columnFormat["number-append"]=v.value,e.set({columnFormat:t.columnFormat}),C=!1}return e.root._beforecreate.push(function(){F._bind({value:1},F.get())}),{c:function(){N._fragment.c(),n=p("\n        "),F._fragment.c(),o=p("\n\n        "),a=f("div"),r=f("label"),s=p("Prepend/append"),i=p("\n            "),l=f("div"),d=f("input"),h=p("\n                #\n                "),v=f("input"),this.h()},h:function(){r.className="control-label",g(d,"input",S),y(d,"width","6ex"),y(d,"text-align","right"),d.dataset.lpignore="true",d.name="prepend",d.type="text",g(v,"input",I),y(v,"width","6ex"),v.dataset.lpignore="true",v.name="append",v.type="text",l.className="controls form-inline",a.className="control-group vis-option-type-select"},m:function(e,m){N._mount(e,m),c(n,e,m),F._mount(e,m),c(o,e,m),c(a,e,m),u(r,a),u(s,r),u(i,a),u(l,a),u(d,l),d.value=t.columnFormat["number-prepend"],u(h,l),u(v,l),v.value=t.columnFormat["number-append"]},p:function(e,t){var n={label:"Round numbers to",options:[{value:"-",label:"(auto-detect - case by case)"},{value:"auto",label:"(auto-detect - one for all)"}]};e.numberFormats&&(n.optgroups=t.numberFormats),!b.value&&e.columnFormat&&(n.value=t.columnFormat["number-format"],b.value=!0),N._set(n),b={};var o={label:"Divide/multiply by"};e.divisors_opts&&(o.options=t.divisors_opts),e.divisors&&(o.optgroups=t.divisors),!w.value&&e.columnFormat&&(o.value=t.columnFormat["number-divisor"],w.value=!0),F._set(o),w={},x||(d.value=t.columnFormat["number-prepend"]),C||(v.value=t.columnFormat["number-append"])},u:function(){N._unmount(),m(n),F._unmount(),m(o),m(a)},d:function(){N.destroy(!1),F.destroy(!1),_(d,"input",S),_(v,"input",I)}}}function Ie(e){I(this,e),this._state=l({columnFormat:{type:"auto",ignore:!1,"number-divisor":"-","number-format":"auto","number-prepend":"","number-append":""},colTypes:[],divisors_opts:[{value:0,label:"(no change)"},{value:"auto",label:"(auto-detect)"}],divisors:[{label:"divide by",options:[{value:3,label:"1000"},{value:6,label:"1 million"},{value:9,label:"1 billion"}]},{label:"multiply by",options:[{value:-2,label:"100"},{value:-3,label:"1000"},{value:-6,label:"1 million"},{value:-9,label:"1 billion"},{value:-12,label:"1 trillion"}]}],numberFormats:[{label:"Decimal places",options:[{value:"n3",label:"3 (1,234.568)"},{value:"n2",label:"2 (1,234.57)"},{value:"n1",label:"1 (1,234.6)"},{value:"n0",label:"0 (1,235)"}]},{label:"Significant digits",options:[{value:"s6",label:"6 (1,234.57)"},{value:"s5",label:"5 (123.45)"},{value:"s4",label:"4 (12.34)"},{value:"s3",label:"3 (1.23)"},{value:"s2",label:"2 (0.12)"},{value:"s1",label:"1 (0.01)"}]}]},e.data),this._recompute({column:1},this._state);var t=function(){var e=this,t=Ne(function(){e.fire("updateTable")},100,{leading:!1}),n=Ne(function(){e.fire("updateTable")},100,{leading:!1}),o=this.get().column;this.set({colTypes:[{value:"auto",label:"auto ("+o.type()+")"},{value:"text",label:"Text"},{value:"number",label:"Number"},{value:"date",label:"Date"}]}),this.set({columnFormat:this.getColumnFormat(o)}),this.observe("column",function(t){e.set({columnFormat:e.getColumnFormat(t)}),e.get().colTypes[0].label="auto ("+o.type()+")"}),this.observe("columnFormat",function(o){var a=e.store.get("dw_chart"),r=e.get().column,s=Re(a.get("metadata.data.column-format",{})),i=s[r.name()];if(!i||JSON.stringify(i)!=JSON.stringify(o)){if("auto"==o["number-divisor"])return void setTimeout(function(){return e.autoDivisor()},100);s[r.name()]=me(o),a.set("metadata.data.column-format",s),a.saveSoon&&a.saveSoon(),i&&i.type==o.type?n():t()}})}.bind(this);e.root||(this._oncreate=[],this._beforecreate=[],this._aftercreate=[]),this._fragment=function(e,t){var n,o,a,r,s,i,l,d,h,v={},g={},_={label:"Column type",options:t.colTypes,width:"180px"};"type"in t.columnFormat&&(_.value=t.columnFormat.type,v.value=!0);var b=new Ce({root:e.root,data:_,_bind:function(t,n){var o=e.get(),a={};!v.value&&t.value&&(o.columnFormat.type=n.value,a.columnFormat=o.columnFormat),e._set(a),v={}}});e.root._beforecreate.push(function(){b._bind({value:1},b.get())});var y={label:"Hide column from visualization"};"ignore"in t.columnFormat&&(y.value=t.columnFormat.ignore,g.value=!0);var w=new ge({root:e.root,data:y,_bind:function(t,n){var o=e.get(),a={};!g.value&&t.value&&(o.columnFormat.ignore=n.value,a.columnFormat=o.columnFormat),e._set(a),g={}}});e.root._beforecreate.push(function(){w._bind({value:1},w.get())});var x=t.column&&"number"==t.column.type()&&Se(e,t);return{c:function(){n=f("div"),o=f("h3"),a=p(t.title),r=p("\n\n    "),s=f("div"),b._fragment.c(),i=p("\n\n        "),w._fragment.c(),l=p("\n\n        "),d=f("hr"),h=p("\n\n        "),x&&x.c(),this.h()},h:function(){o.className="first",s.className="form-horizontal"},m:function(e,t){c(n,e,t),u(o,n),u(a,o),u(r,n),u(s,n),b._mount(s,null),u(i,s),w._mount(s,null),u(l,s),u(d,s),u(h,s),x&&x.m(s,null)},p:function(t,n){t.title&&(a.data=n.title);var o={label:"Column type"};t.colTypes&&(o.options=n.colTypes),!v.value&&t.columnFormat&&(o.value=n.columnFormat.type,v.value=!0),b._set(o),v={};var r={label:"Hide column from visualization"};!g.value&&t.columnFormat&&(r.value=n.columnFormat.ignore,g.value=!0),w._set(r),g={},n.column&&"number"==n.column.type()?x?x.p(t,n):((x=Se(e,n)).c(),x.m(s,null)):x&&(x.u(),x.d(),x=null)},u:function(){m(n),x&&x.u()},d:function(){b.destroy(!1),w.destroy(!1),x&&x.d()}}}(this,this._state),this.root._oncreate.push(t),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),this._lock=!0,H(this._beforecreate),H(this._oncreate),H(this._aftercreate),this._lock=!1)}l(Ie.prototype,Fe,L),Ie.prototype._recompute=function(e,t){var n;e.column&&this._differs(t.title,t.title=(n=t.column,"Edit column %s".replace("%s",'"'+(n?n.title()||n.name():"--")+'"')))&&(e.title=!0)};var Te=null;var He={render:function(){this.get("hot").render()},update:function(){var e=this,t=this.get(),n=t.data,o=t.transpose,a=t.firstRowIsHeader,r=t.skipRows,i=t.hot;if(n){var l=this.store.get("dw_chart"),u=l.dataset(dw.datasource.delimited({csv:n,transpose:o,firstRowIsHeader:a,skipRows:r}).parse()).dataset();this.set({columnOrder:u.columnOrder()});var c=[[]];u.eachColumn(function(e){return c[0].push(e.title())}),u.eachRow(function(e){var t=[];u.eachColumn(function(n){return t.push(n.raw(e))}),c.push(t)}),i.loadData(c);var m=Le(this,u,s);i.updateSettings({cells:function(t,n){return{readOnly:e.get().readonly||u.hasColumn(n)&&u.column(n).isComputed&&0===t,renderer:m}},manualColumnMove:[]}),this.set({ds:u}),this.set({has_changes:l.get("metadata.data.changes",[]).length>0}),s.hooks.once("afterRender",function(){return e.initCustomEvents()}),i.render()}},dataChanged:function(e){var t=this,n=this.get().hot,o=!1;e.forEach(function(e){var a=e[0],r=e[1],s=e[2],i=e[3];if(s!=i){var l=t.store.get("dw_chart"),u=t.get().transpose,c=l.get("metadata.data.changes",[]);if(a=n.toPhysicalRow(a),r=l.dataset().columnOrder()[r],u){var m=a;a=r,r=m}c.push({column:r,row:a,value:i,time:(new Date).getTime()}),l.set("metadata.data.changes",c),o=!0}}),o&&setTimeout(function(){t.update(),chart.save()},100)},columnMoved:function(e,t){var n=this,o=this.get().hot;if(e.length){var a=this.get().columnOrder,r=a.slice(0),i=a[t],l=r.splice(e[0],e.length),u=void 0===i?r.length:i?r.indexOf(i):0;r.splice.apply(r,[u,0].concat(l)),this.store.get("dw_chart").set("metadata.data.column-order",r.slice(0)),this.set({columnOrder:r}),s.hooks.once("afterRender",function(){setTimeout(function(){n.fire("resetSort"),o.selectCell(0,u,o.countRows()-1,u+l.length-1)},10)}),this.update()}},updateHeight:function(){var e=document.querySelector(".ht_master.handsontable .wtHolder .wtHider").getBoundingClientRect().height;this.refs.hot.style.height=Math.min(500,e+10)+"px"},checkRange:function(e,t,n,o){var a=this.get().hot,r=this.get().ds;this.refs;if(t!=o||0!==e||n!=a.countRows()-1)if(t==o||0!==e||n!=a.countRows()-1)this.set({activeColumn:null,multiSelection:!1});else{for(var s=[],i=Math.min(t,o);i<=Math.max(t,o);i++)s.push(+document.querySelector("#data-preview .htCore tbody tr:first-child td:nth-child("+(i+2)+")").dataset.column);this.set({multiSelection:s.map(function(e){return r.column(e)}),activeColumn:null})}},initCustomEvents:function(){var e=this;setTimeout(function(){e.refs.hot.querySelectorAll(".htCore thead th:first-child").forEach(function(e){e.removeEventListener("click",De),e.addEventListener("click",De)}),e.refs.hot.querySelectorAll(".htCore thead th+th").forEach(function(e){e.removeEventListener("click",Ee),e.addEventListener("click",Ee)})},500)},getColumnFormat:function(e){return this.store.get("dw_chart").get("metadata.data.column-format",{})[e]||{type:"auto",ignore:!1}}};function Le(e,t,n){var o={date:"fa fa-clock-o"};return function(a,r,s,i,l,u,c){if(!(t.numColumns()<=i)&&t.hasColumn(i)){var m=t.column(i),d=e.get(),h=d.searchResults,f=d.currentResult,p=d.activeColumn,v=e.getColumnFormat(m.name());if((s=a.toPhysicalRow(s))>0)u=chart.columnFormatter(m)(m.val(s-1),!0);parseInt(u)<0&&r.classList.add("negative"),r.classList.add(m.type()+"Type"),r.dataset.column=i,"text"==m.type()&&u&&u.length>70&&(u=u.substr(0,60)+"…"),0===s?(r.classList.add("firstRow"),o[m.type()]&&(u='<i class="'+o[m.type()]+'"></i> '+u)):r.classList.add(s%2?"oddRow":"evenRow"),v.ignore&&r.classList.add("ignored"),p&&p.name()==m.name()&&r.classList.add("active");var g=a.getPlugin("columnSorting").untranslateRow(s);h.forEach(function(e){e.row==g&&e.col==i&&r.classList.add("htSearchResult")}),f&&f.row==g&&f.col==i&&r.classList.add("htCurrentSearchResult"),s>0&&!m.type(!0).isValid(m.val(s-1))&&r.classList.add("parsingError"),c.readOnly&&r.classList.add("readOnly"),chart.dataCellChanged(i,s)&&r.classList.add("changed"),function(e,t,o,a,r,s,i){var l=dw.utils.purifyHtml(n.helper.stringify(s));t.innerHTML=l}(0,r,0,0,0,u)}}}function De(e){e.preventDefault();var t=Te.get().transpose;Te.set({transpose:!t}),Te.update()}function Ee(e){for(var t=this.parentNode.children.length,n=-1,o=0;o<t;o++)if(this.parentNode.children.item(o)==this){n=o;break}var a=+Te.refs.hot.querySelector(".htCore tbody tr:first-child td:nth-child("+(n+1)+")").dataset.column,r=Te.store.get("dw_chart"),s=Te.get(),i=s.activeColumn,l=s.hot;if(r.dataset().hasColumn(a)){var u=r.dataset().column(+a);i&&i.name()==u.name()?(e.target.parentNode.classList.remove("selected"),Te.set({activeColumn:!1}),l.deselectCell()):(e.target.parentNode.classList.add("selected"),Te.set({activeColumn:u}))}}function Oe(e){I(this,e),this.refs={},this._state=l({data:"",readonly:!1,skipRows:0,firstRowIsHeader:!0,searchIndex:0,sortBy:"-",transpose:!1,activeColumn:null,search:"",searchResults:[]},e.data),this._recompute({searchResults:1,searchIndex:1},this._state);var t,n,o=function(){var e=this;Te=this,s.hooks.once("afterRender",function(){return e.initCustomEvents()}),window.addEventListener("keyup",function(t){var n=e.get(),o=n.activeColumn,a=n.ds;if(o&&("ArrowRight"==t.key||"ArrowLeft"==t.key)){t.preventDefault(),t.stopPropagation();var r=a.indexOf(o.name());"ArrowRight"==t.key?e.set({activeColumn:a.column((r+1)%a.numColumns())}):e.set({activeColumn:a.column((r-1+a.numColumns())%a.numColumns())})}});var t=this.store.get("dw_chart"),n=new s(this.refs.hot,{data:[],rowHeaders:function(e){return n.getPlugin("ColumnSorting").translateRow(e)+1},colHeaders:!0,fixedRowsTop:1,filters:!0,dropdownMenu:!0,startRows:13,startCols:8,fillHandle:!1,stretchH:"all",height:500,manualColumnMove:!0,selectionMode:"range",autoColumnSize:{useHeaders:!0,syncLimit:5},columnSorting:!0,sortIndicator:!0,sortFunction:function(e,o){if(o.col>-1){var a=t.dataset().column(o.col),r=a.type(),s=n.getPlugin("columnSorting");return function(t,n){var i;if(0===t[0])return-1;switch(t[1]=a.val(t[0]-1),n[1]=a.val(n[0]-1),"number"==r&&(isNaN(t[1])&&(t[1]=e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY),isNaN(n[1])&&(n[1]=e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY)),"date"==r&&("string"==typeof t[1]&&(t[1]=new Date(110,0,1)),"string"==typeof n[1]&&(n[1]=new Date(110,0,1))),r){case"date":i=s.dateSort;break;case"number":i=s.numericSort;break;default:i=s.defaultSort}return i(e,o)(t,n)}}return function(e,t){return e[0]-t[0]}},afterGetColHeader:function(t,n){var o=e.get(),a=o.activeColumn,r=o.ds;r&&r.hasColumn(t)&&((0===t||t)&&a&&r.column(t).name()==a.name()&&n.classList.add("selected"),(0===t||t)&&(e.getColumnFormat(r.column(t).name()).ignore?n.classList.add("ignored"):n.classList.remove("ignored")))},search:"search"});window.HT=n,this.set({hot:n}),s.hooks.add("afterSetDataAtCell",function(t){return e.dataChanged(t)}),s.hooks.add("afterColumnMove",function(t,n){return e.columnMoved(t,n)}),s.hooks.add("afterRender",function(){return e.updateHeight()}),s.hooks.add("afterSelection",function(t,n,o,a){return e.checkRange(t,n,o,a)}),this.observe("data",function(){return e.update()}),this.observe("firstRowIsHeader",function(t,n){t!=n&&void 0!==n&&e.update()}),this.observe("search",function(t,o){t!=o&&e.set({searchIndex:0});var a=n.search.query(t);e.set({searchResults:a}),n.render()}),this.observe("currentResult",function(e){e&&n&&(n.render(),n.scrollViewportTo(e.row,e.col),setTimeout(function(){n.scrollViewportTo(e.row,e.col)},100))}),this.observe("activeColumn",function(){setTimeout(function(){return n.render()},10)}),this.observe("sorting",function(e){n.sort(t.dataset().indexOf(e.sortBy),e.sortDir)})}.bind(this);e.root||(this._oncreate=[]),this._fragment=(t=this,this._state,{c:function(){n=f("div"),this.h()},h:function(){n.id="data-preview"},m:function(e,o){c(n,e,o),t.refs.hot=n},p:i,u:function(){m(n)},d:function(){t.refs.hot===n&&(t.refs.hot=null)}}),this.root._oncreate.push(o),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),H(this._oncreate))}l(Oe.prototype,He,L),Oe.prototype._recompute=function(e,t){(e.searchResults||e.searchIndex)&&this._differs(t.currentResult,t.currentResult=function(e,t){if(!e||!e.length)return null;var n=e.length;if(t<0||t>=n){for(;t<0;)t+=n;t>n&&(t%=n)}return e[t]}(t.searchResults,t.searchIndex))&&(e.currentResult=!0)};var Me={nextResult:function(e){var t=this.get(),n=t.searchIndex,o=t.searchResults;(n+=e)<0&&(n+=o.length),n%=o.length,this.set({searchIndex:n})},keyPress:function(e){"F3"!=e.key&&"Enter"!=e.key||this.nextResult(e.shiftKey?-1:1)},toggleTranspose:function(){var e=this;this.set({activeColumn:!1}),this.set({transpose:!this.get("transpose")}),setTimeout(function(){return e.refs.hot.update()},500)},revertChanges:function(){var e=this.store.get("dw_chart");e.set("metadata.data.changes",[]),e.saveSoon(),this.refs.hot.update()},cmFocus:function(){var e=this;setTimeout(function(){e.refs.hot.get("hot").render()},100)},addComputedColumn:function(){for(var e=this.store.get("dw_chart"),t=e.dataset(),n=Re(e.get("metadata.describe.computed-columns",{})),o=1;t.hasColumn("Column "+o);)o++;var a="Column "+o;n[a]="",e.set("metadata.describe.computed-columns",n),e.saveSoon();var r=e.dataset(!0);this.refs.hot.update(),this.set({activeColumn:r.column(a)})},sort:function(e,t,n){e.preventDefault(),e.stopPropagation(),this.set({sortBy:t,sortDir:n}),this.refs.sortDropdownGroup.classList.remove("open")},force:function(e,t){void 0===t&&(t=!0),e.preventDefault(),this.set({forceColumnFormat:t})},hideMultiple:function(e,t){var n=this,o=this.store.get("dw_chart"),a=o.get("metadata.data.column-format",{});e.forEach(function(e){a[e.name()]?a[e.name()].ignore=t:a[e.name()]={type:"auto",ignore:t}}),o.set("metadata.data.column-format",a),o.saveSoon(),setTimeout(function(){n.refs.hot.get("hot").render()},10),this.set({multiSelection:!1})}};function Pe(e,t){var n,o,a,r;function s(t){e.force(t,!1)}return{c:function(){n=f("button"),o=f("i"),a=p(" "),r=p("Return to formula editor"),this.h()},h:function(){o.className="fa  fa-chevron-left",n.className="btn",g(n,"click",s)},m:function(e,t){c(n,e,t),u(o,n),u(a,n),u(r,n)},u:function(){m(n)},d:function(){_(n,"click",s)}}}function Ae(e,t){var n,o,a,r,s,l,d=t.locale,h=(t.locale_index,d.label),v=d.value;return{c:function(){n=f("option"),o=p(h),a=p(" ("),r=p(v),s=p(")"),this.h()},h:function(){n.__value=l=d.value,n.value=n.__value},m:function(e,t){c(n,e,t),u(o,n),u(a,n),u(r,n),u(s,n)},p:function(e,t){d=t.locale,t.locale_index,e.locales&&h!==(h=d.label)&&(o.data=h),e.locales&&v!==(v=d.value)&&(r.data=v),e.locales&&l!==(l=d.value)&&(n.__value=l),n.value=n.__value},u:function(){m(n)},d:i}}function je(e,t){var n,o,a,r={},s={};"customColumn"in t&&(s.column=t.customColumn,r.column=!0),"columns"in t&&(s.columns=t.columns,r.columns=!0);var i=new ve({root:e.root,data:s,_bind:function(t,n){e.get();var o={};!r.column&&t.column&&(o.customColumn=n.column),!r.columns&&t.columns&&(o.columns=n.columns),e._set(o),r={}}});function l(t){e.force(t,!0)}return e.root._beforecreate.push(function(){i._bind({column:1,columns:1},i.get())}),i.on("updateTable",function(t){e.refs.hot.update()}),i.on("renderTable",function(t){e.refs.hot.render()}),i.on("unselect",function(t){e.set({activeColumn:!1})}),{c:function(){i._fragment.c(),n=p("\n\n               "),o=f("button"),a=p("Edit column format"),this.h()},h:function(){o.className="btn",g(o,"click",l)},m:function(e,t){i._mount(e,t),c(n,e,t),c(o,e,t),u(a,o)},p:function(e,t){var n={};!r.column&&e.customColumn&&(n.column=t.customColumn,r.column=!0),!r.columns&&e.columns&&(n.columns=t.columns,r.columns=!0),i._set(n),r={}},u:function(){i._unmount(),m(n),m(o)},d:function(){i.destroy(!1),_(o,"click",l)}}}function Be(e,t){var n,o,a={},r={};"columnFormat"in t&&(r.column=t.columnFormat,a.column=!0),"columns"in t&&(r.columns=t.columns,a.columns=!0);var s=new Ie({root:e.root,data:r,_bind:function(t,n){e.get();var o={};!a.column&&t.column&&(o.columnFormat=n.column),!a.columns&&t.columns&&(o.columns=n.columns),e._set(o),a={}}});e.root._beforecreate.push(function(){s._bind({column:1,columns:1},s.get())}),s.on("updateTable",function(t){e.refs.hot.update()}),s.on("renderTable",function(t){e.refs.hot.render()});var i=t.columnFormat.isComputed&&Pe(e);return{c:function(){s._fragment.c(),n=p("\n\n                "),i&&i.c(),o=v()},m:function(e,t){s._mount(e,t),c(n,e,t),i&&i.m(e,t),c(o,e,t)},p:function(t,n){var r={};!a.column&&t.columnFormat&&(r.column=n.columnFormat,a.column=!0),!a.columns&&t.columns&&(r.columns=n.columns,a.columns=!0),s._set(r),a={},n.columnFormat.isComputed?i||((i=Pe(e)).c(),i.m(o.parentNode,o)):i&&(i.u(),i.d(),i=null)},u:function(){s._unmount(),m(n),i&&i.u(),m(o)},d:function(){s.destroy(!1),i&&i.d()}}}function qe(e,t){var n,o,a,r,s,l,d,h,v,b,w,x,C,k;function N(t){var n=e.get();e.hideMultiple(n.multiSelection,!1)}function R(t){var n=e.get();e.hideMultiple(n.multiSelection,!0)}return{c:function(){n=f("h3"),o=p("Show/hide multiple columns"),a=p("\n\n                "),r=f("ul"),s=f("li"),l=f("button"),d=f("i"),h=p(" "),v=p("Show selected columns"),b=f("li"),w=f("button"),x=f("i"),C=p(" "),k=p("Hide selected columns"),this.h()},h:function(){n.className="first",d.className="fa fa-eye",l.className="btn",g(l,"click",N),y(s,"margin-bottom","5px"),x.className="fa fa-eye-slash",w.className="btn",g(w,"click",R),r.className="unstyled"},m:function(e,t){c(n,e,t),u(o,n),c(a,e,t),c(r,e,t),u(s,r),u(l,s),u(d,l),u(h,l),u(v,l),u(b,r),u(w,b),u(x,w),u(C,w),u(k,w)},p:i,u:function(){m(n),m(a),m(r)},d:function(){_(l,"click",N),_(w,"click",R)}}}function $e(e,t){var n,o,a,r,s,i,d,v,b,y,C,k,N,R,F={},S=!1,I={label:"First row as label"};"firstRowIsHeader"in t&&(I.value=t.firstRowIsHeader,F.value=!0);var T=new ge({root:e.root,data:I,_bind:function(t,n){e.get();var o={};!F.value&&t.value&&(o.firstRowIsHeader=n.value),e._set(o),F={}}});e.root._beforecreate.push(function(){T._bind({value:1},T.get())});for(var H=t.locales,L=[],D=0;D<H.length;D+=1)L[D]=Ae(0,l({},t,{locales:H,locale:H[D],locale_index:D}));function E(){S=!0,e.set({locale:x(R)}),S=!1}return{c:function(){n=f("h3"),o=p("Make sure the data looks right"),a=p("\n\n                "),r=f("p"),s=p("Please make sure that Datawrapper interprets your data correctly. In the table columns should be shown in blue, dates in green and text in black."),i=p("\n\n                "),T._fragment.c(),d=p("\n\n                "),v=f("h4"),b=p("Output locale"),y=p("\n\n                "),C=f("p"),k=p("Defines decimal and thousand separators as well as translation of month and weekday names."),N=p("\n\n                "),R=f("select");for(var e=0;e<L.length;e+=1)L[e].c();this.h()},h:function(){n.className="first",g(R,"change",E),"locale"in t||e.root._beforecreate.push(E)},m:function(e,l){c(n,e,l),u(o,n),c(a,e,l),c(r,e,l),u(s,r),c(i,e,l),T._mount(e,l),c(d,e,l),c(v,e,l),u(b,v),c(y,e,l),c(C,e,l),u(k,C),c(N,e,l),c(R,e,l);for(var m=0;m<L.length;m+=1)L[m].m(R,null);w(R,t.locale)},p:function(e,t){var n={label:"First row as label"};!F.value&&e.firstRowIsHeader&&(n.value=t.firstRowIsHeader,F.value=!0),T._set(n),F={};var o=t.locales;if(e.locales){for(var a=0;a<o.length;a+=1){var r=l({},t,{locales:o,locale:o[a],locale_index:a});L[a]?L[a].p(e,r):(L[a]=Ae(0,r),L[a].c(),L[a].m(R,null))}for(;a<L.length;a+=1)L[a].u(),L[a].d();L.length=o.length}S||w(R,t.locale)},u:function(){m(n),m(a),m(r),m(i),T._unmount(),m(d),m(v),m(y),m(C),m(N),m(R);for(var e=0;e<L.length;e+=1)L[e].u()},d:function(){T.destroy(!1),h(L),_(R,"change",E)}}}function ze(e,t){var n,o,a,r,s,i,l,d,h,v,b,y=t.col,w=(t.col_index,y.title());return{c:function(){n=f("li"),o=f("a"),a=f("i"),s=p("\n                                "),i=f("i"),d=p("   "),h=p(w),this.h()},h:function(){a.className=r="fa fa-sort-"+("text"==y.type()?"alpha":"amount")+"-asc fa-fw svelte-1mhp3v1",g(a,"click",Ke),a._svelte={component:e,columns:t.columns,col_index:t.col_index},i.className=l="fa fa-sort-"+("text"==y.type()?"alpha":"amount")+"-desc fa-fw svelte-1mhp3v1",g(i,"click",Ue),i._svelte={component:e,columns:t.columns,col_index:t.col_index},o.href=v="#/"+y.name(),o.className="svelte-1mhp3v1",g(o,"click",We),o._svelte={component:e,columns:t.columns,col_index:t.col_index},n.className=b=y.name()==t.sortBy?"active":""},m:function(e,t){c(n,e,t),u(o,n),u(a,o),u(s,o),u(i,o),u(d,o),u(h,o)},p:function(e,t){y=t.col,t.col_index,e.columns&&r!==(r="fa fa-sort-"+("text"==y.type()?"alpha":"amount")+"-asc fa-fw svelte-1mhp3v1")&&(a.className=r),a._svelte.columns=t.columns,a._svelte.col_index=t.col_index,e.columns&&l!==(l="fa fa-sort-"+("text"==y.type()?"alpha":"amount")+"-desc fa-fw svelte-1mhp3v1")&&(i.className=l),i._svelte.columns=t.columns,i._svelte.col_index=t.col_index,e.columns&&w!==(w=y.title())&&(h.data=w),e.columns&&v!==(v="#/"+y.name())&&(o.href=v),o._svelte.columns=t.columns,o._svelte.col_index=t.col_index,(e.columns||e.sortBy)&&b!==(b=y.name()==t.sortBy?"active":"")&&(n.className=b)},u:function(){m(n)},d:function(){_(a,"click",Ke),_(i,"click",Ue),_(o,"click",We)}}}function Ve(e,t){var n,o,a,r;function s(t){e.nextResult(-1)}function i(t){e.nextResult(1)}return{c:function(){n=f("div"),(o=f("button")).innerHTML='<i class="fa fa-chevron-up"></i>',a=p("\n                          "),(r=f("button")).innerHTML='<i class="fa fa-chevron-down"></i>',this.h()},h:function(){o.className="btn svelte-1mhp3v1",g(o,"click",s),r.className="btn svelte-1mhp3v1",g(r,"click",i),n.className="btn-group"},m:function(e,t){c(n,e,t),u(o,n),u(a,n),u(r,n)},u:function(){m(n)},d:function(){_(o,"click",s),_(r,"click",i)}}}function Ge(e,t){var n,o,a,r,s,l,u,d=t.searchIndexSafe+1,h=t.searchResults.length;return{c:function(){n=p(d),o=p("\n                            "),a=p("of"),r=p("\n                            "),s=p(h),l=p("\n                            "),u=p("results")},m:function(e,t){c(n,e,t),c(o,e,t),c(a,e,t),c(r,e,t),c(s,e,t),c(l,e,t),c(u,e,t)},p:function(e,t){e.searchIndexSafe&&d!==(d=t.searchIndexSafe+1)&&(n.data=d),e.searchResults&&h!==(h=t.searchResults.length)&&(s.data=h)},u:function(){m(n),m(o),m(a),m(r),m(s),m(l),m(u)},d:i}}function Je(e,t){var n;return{c:function(){n=p("No matches")},m:function(e,t){c(n,e,t)},p:i,u:function(){m(n)},d:i}}function Ye(e,t){var n;function o(e){return e.searchResults.length>0?Ge:e.search?Je:null}var a=o(t),r=a&&a(e,t);return{c:function(){n=f("div"),r&&r.c(),this.h()},h:function(){n.className="results svelte-1mhp3v1"},m:function(e,t){c(n,e,t),r&&r.m(n,null)},p:function(t,s){a===(a=o(s))&&r?r.p(t,s):(r&&(r.u(),r.d()),(r=a&&a(e,s))&&r.c(),r&&r.m(n,null))},u:function(){m(n),r&&r.u()},d:function(){r&&r.d()}}}function Ke(e){var t=this._svelte.component,n=this._svelte.columns[this._svelte.col_index];t.sort(e,n.name(),!0)}function Ue(e){var t=this._svelte.component,n=this._svelte.columns[this._svelte.col_index];t.sort(e,n.name(),!1)}function We(e){var t=this._svelte.component,n=this._svelte.columns[this._svelte.col_index];t.sort(e,n.name(),!0)}function Qe(e){I(this,e),this.refs={},this._state=l({locale:"en-US",search:"",chartData:"",transpose:!1,firstRowIsHeader:!0,searchIndex:0,activeColumn:!1,customColumn:!1,columnFormat:!1,multiSelection:!1,forceColumnFormat:!1,searchResults:[],sortBy:"-",sortDir:!0},e.data),this._recompute({searchIndex:1,searchResults:1,activeColumn:1,forceColumnFormat:1,sortBy:1,sortDir:1},this._state);var t=function(){var e=this;window.addEventListener("keypress",function(t){t.ctrlKey&&"f"==t.key&&(t.preventDefault(),e.refs.search!=window.document.activeElement?e.refs.search.focus():e.nextResult(1))});var t=function(t,n){e.observe(t,function(o){if(e.store.get("dw_chart").set(""+n,o),"locale"==t){if(!o)return;e.store.get("dw_chart").locale(o,function(){e.refs.hot.render()})}})};t("transpose","metadata.data.transpose"),t("firstRowIsHeader","metadata.data.horizontal-header"),t("locale","language"),this.observe("activeColumn",function(t){t||e.set({forceColumnFormat:!1})})}.bind(this);e.root||(this._oncreate=[],this._beforecreate=[],this._aftercreate=[]),this._fragment=function(e,t){var n,o,a,r,s,i,v,b,w,x,C,k,N,R,F,S,I,T,H,L,D,E,O,M,P,A,j,B,q,$,z,V,G,J,Y,K,U,W,Q,X,Z,ee,te,ne,oe,ae,re,se,ie,le,ue,ce,me,de,he,fe,pe,ve,ge,_e,be,ye,we,xe,Ce,ke,Ne,Re,Fe=!1,Se={};function Ie(e){return e.customColumn?je:e.columnFormat?Be:e.multiSelection?qe:$e}var Te=Ie(t),He=Te(e,t);function Le(t){e.sort(t,"-")}for(var De=t.columns,Ee=[],Me=0;Me<De.length;Me+=1)Ee[Me]=ze(e,l({},t,{columns:De,col:De[Me],col_index:Me}));function Pe(){Fe=!0,e.set({search:ne.value}),Fe=!1}function Ae(t){e.keyPress(t)}var Ge=t.searchResults.length>0&&Ve(e),Je=t.search&&Ye(e,t),Ke={};"chartData"in t&&(Ke.data=t.chartData,Se.data=!0),"transpose"in t&&(Ke.transpose=t.transpose,Se.transpose=!0),"firstRowIsHeader"in t&&(Ke.firstRowIsHeader=t.firstRowIsHeader,Se.firstRowIsHeader=!0),"activeColumn"in t&&(Ke.activeColumn=t.activeColumn,Se.activeColumn=!0),"sorting"in t&&(Ke.sorting=t.sorting,Se.sorting=!0),"search"in t&&(Ke.search=t.search,Se.search=!0),"searchResults"in t&&(Ke.searchResults=t.searchResults,Se.searchResults=!0),"searchIndex"in t&&(Ke.searchIndex=t.searchIndex,Se.searchIndex=!0),"multiSelection"in t&&(Ke.multiSelection=t.multiSelection,Se.multiSelection=!0);var Ue=new Oe({root:e.root,data:Ke,_bind:function(t,n){e.get();var o={};!Se.data&&t.data&&(o.chartData=n.data),!Se.transpose&&t.transpose&&(o.transpose=n.transpose),!Se.firstRowIsHeader&&t.firstRowIsHeader&&(o.firstRowIsHeader=n.firstRowIsHeader),!Se.activeColumn&&t.activeColumn&&(o.activeColumn=n.activeColumn),!Se.sorting&&t.sorting&&(o.sorting=n.sorting),!Se.search&&t.search&&(o.search=n.search),!Se.searchResults&&t.searchResults&&(o.searchResults=n.searchResults),!Se.searchIndex&&t.searchIndex&&(o.searchIndex=n.searchIndex),!Se.multiSelection&&t.multiSelection&&(o.multiSelection=n.multiSelection),e._set(o),Se={}}});function We(t){e.toggleTranspose()}function Qe(t){e.addComputedColumn()}function Xe(t){e.revertChanges()}return e.root._beforecreate.push(function(){Ue._bind({data:1,transpose:1,firstRowIsHeader:1,activeColumn:1,sorting:1,search:1,searchResults:1,searchIndex:1,multiSelection:1},Ue.get())}),Ue.on("resetSort",function(t){e.set({sortBy:"-"})}),e.refs.hot=Ue,{c:function(){n=f("div"),o=f("div"),a=f("div"),r=f("div"),He.c(),s=p("\n\n                "),i=f("hr"),v=p("\n\n                "),b=f("div"),w=f("a"),x=f("i"),C=p(" "),k=p("Back"),N=p("\n                    "),R=f("a"),F=p("Proceed"),S=p(" "),I=f("i"),T=p("\n\n                "),H=f("p"),L=p("\n        "),D=f("div"),E=f("div"),O=f("noscript"),M=p(" "),P=f("img"),A=p("\n            "),j=f("div"),B=f("div"),q=f("div"),$=f("button"),z=f("noscript"),V=p("… "),G=f("span"),J=p("\n                        "),Y=f("ul"),K=f("li"),U=f("a");for(var e=0;e<Ee.length;e+=1)Ee[e].c();Q=p("\n\n                "),X=f("div"),Z=f("i"),ee=p("\n                    "),te=f("div"),ne=f("input"),ae=p("\n                        "),Ge&&Ge.c(),se=p("\n\n                    "),Je&&Je.c(),ie=p("\n\n            "),Ue._fragment.c(),le=p("\n\n            "),ue=f("div"),ce=f("button"),me=f("img"),de=p(" "),he=p("Swap rows and columns (transpose)"),fe=p("\n\n                "),pe=f("button"),ve=f("i"),ge=p(" "),_e=p("Add column"),be=p("…"),ye=p("\n\n                "),we=f("button"),xe=f("i"),Ce=p(" "),ke=p("Revert changes"),Ne=p("..."),this.h()},h:function(){x.className="icon-chevron-left",w.className="btn submit",w.href="upload",I.className="icon-chevron-right icon-white",R.href="visualize",R.className="submit btn btn-primary",R.id="describe-proceed",b.className="btn-group",H.className="not-happy",r.className="sidebar",a.className="span4",P.src="/static/img/arrow.svg",E.className="help svelte-1mhp3v1",G.className="caret",$.className="btn dropdown-toggle",$.dataset.toggle="dropdown",U.href="#s",U.className="svelte-1mhp3v1",g(U,"click",Le),K.className=W="-"==t.sortBy?"active":"",Y.className="dropdown-menu sort-menu",q.className="btn-group",B.className="sort-box svelte-1mhp3v1",Z.className="im im-magnifier svelte-1mhp3v1",g(ne,"input",Pe),ne.type="text",ne.placeholder="Search data table",ne.className=oe=(t.searchResults.length>0?"with-results":"")+" search-query svelte-1mhp3v1",g(ne,"keypress",Ae),te.className=re=t.searchResults.length>0?"input-append":"",X.className="search-box form-search svelte-1mhp3v1",j.className="pull-right",y(j,"margin-bottom","10px"),me.src="/static/css/chart-editor/transpose.png",me.className="svelte-1mhp3v1",ce.className="btn transpose svelte-1mhp3v1",g(ce,"click",We),ve.className="fa fa-calculator",pe.className="btn computed-columns",g(pe,"click",Qe),xe.className="fa fa-undo",we.className=Re="btn "+(t.has_changes?"":"disabled")+" svelte-1mhp3v1",we.id="reset-data-changes",g(we,"click",Xe),ue.className="buttons below-table pull-right svelte-1mhp3v1",D.className="span8 svelte-1mhp3v1",o.className="row",n.className="chart-editor"},m:function(l,m){c(n,l,m),u(o,n),u(a,o),u(r,a),He.m(r,null),u(s,r),u(i,r),u(v,r),u(b,r),u(w,b),u(x,w),u(C,w),u(k,w),u(N,b),u(R,b),u(F,R),u(S,R),u(I,R),u(T,r),u(H,r),H.innerHTML="Not happy with the new page? We'd love to <a href='mailto:hello@datawrapper.de?subject=Feedback'>know why!</a><br> You can switch to the old version <a href='?beta=0'>here</a>",u(L,o),u(D,o),u(E,D),u(O,E),O.insertAdjacentHTML("beforebegin","Click on table header<br>to edit column properties"),u(M,E),u(P,E),u(A,D),u(j,D),u(B,j),u(q,B),u($,q),u(z,$),z.insertAdjacentHTML("beforebegin","Sort view by"),u(V,$),u(G,$),u(J,q),u(Y,q),u(K,Y),u(U,K),U.innerHTML="No sorting";for(var d=0;d<Ee.length;d+=1)Ee[d].m(Y,null);e.refs.sortDropdownGroup=q,u(Q,j),u(X,j),u(Z,X),u(ee,X),u(te,X),u(ne,te),e.refs.search=ne,ne.value=t.search,u(ae,te),Ge&&Ge.m(te,null),u(se,X),Je&&Je.m(X,null),u(ie,D),Ue._mount(D,null),u(le,D),u(ue,D),u(ce,ue),u(me,ce),u(de,ce),u(he,ce),u(fe,ue),u(pe,ue),u(ve,pe),u(ge,pe),u(_e,pe),u(be,pe),u(ye,ue),u(we,ue),u(xe,we),u(Ce,we),u(ke,we),u(Ne,we)},p:function(t,n){Te===(Te=Ie(n))&&He?He.p(t,n):(He.u(),He.d(),(He=Te(e,n)).c(),He.m(r,s)),t.sortBy&&W!==(W="-"==n.sortBy?"active":"")&&(K.className=W);var o=n.columns;if(t.columns||t.sortBy){for(var a=0;a<o.length;a+=1){var i=l({},n,{columns:o,col:o[a],col_index:a});Ee[a]?Ee[a].p(t,i):(Ee[a]=ze(e,i),Ee[a].c(),Ee[a].m(Y,null))}for(;a<Ee.length;a+=1)Ee[a].u(),Ee[a].d();Ee.length=o.length}Fe||(ne.value=n.search),t.searchResults&&oe!==(oe=(n.searchResults.length>0?"with-results":"")+" search-query svelte-1mhp3v1")&&(ne.className=oe),n.searchResults.length>0?Ge||((Ge=Ve(e)).c(),Ge.m(te,null)):Ge&&(Ge.u(),Ge.d(),Ge=null),t.searchResults&&re!==(re=n.searchResults.length>0?"input-append":"")&&(te.className=re),n.search?Je?Je.p(t,n):((Je=Ye(e,n)).c(),Je.m(X,null)):Je&&(Je.u(),Je.d(),Je=null);var u={};!Se.data&&t.chartData&&(u.data=n.chartData,Se.data=!0),!Se.transpose&&t.transpose&&(u.transpose=n.transpose,Se.transpose=!0),!Se.firstRowIsHeader&&t.firstRowIsHeader&&(u.firstRowIsHeader=n.firstRowIsHeader,Se.firstRowIsHeader=!0),!Se.activeColumn&&t.activeColumn&&(u.activeColumn=n.activeColumn,Se.activeColumn=!0),!Se.sorting&&t.sorting&&(u.sorting=n.sorting,Se.sorting=!0),!Se.search&&t.search&&(u.search=n.search,Se.search=!0),!Se.searchResults&&t.searchResults&&(u.searchResults=n.searchResults,Se.searchResults=!0),!Se.searchIndex&&t.searchIndex&&(u.searchIndex=n.searchIndex,Se.searchIndex=!0),!Se.multiSelection&&t.multiSelection&&(u.multiSelection=n.multiSelection,Se.multiSelection=!0),Ue._set(u),Se={},t.has_changes&&Re!==(Re="btn "+(n.has_changes?"":"disabled")+" svelte-1mhp3v1")&&(we.className=Re)},u:function(){H.innerHTML="",d(O),d(z),U.innerHTML="",m(n),He.u();for(var e=0;e<Ee.length;e+=1)Ee[e].u();Ge&&Ge.u(),Je&&Je.u()},d:function(){He.d(),_(U,"click",Le),h(Ee),e.refs.sortDropdownGroup===q&&(e.refs.sortDropdownGroup=null),_(ne,"input",Pe),_(ne,"keypress",Ae),e.refs.search===ne&&(e.refs.search=null),Ge&&Ge.d(),Je&&Je.d(),Ue.destroy(!1),e.refs.hot===Ue&&(e.refs.hot=null),_(ce,"click",We),_(pe,"click",Qe),_(we,"click",Xe)}}}(this,this._state),this.root._oncreate.push(t),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),this._lock=!0,H(this._beforecreate),H(this._oncreate),H(this._aftercreate),this._lock=!1)}function Xe(e,t){this._observers={pre:C(),post:C()},this._changeHandlers=[],this._dependents=[],this._computed=C(),this._sortedComputedProperties=[],this._state=l({},e),this._differs=t&&t.immutable?R:N}l(Qe.prototype,Me,L),Qe.prototype._recompute=function(e,t){var n,o,a,r,s,i;(e.searchIndex||e.searchResults)&&this._differs(t.searchIndexSafe,t.searchIndexSafe=(n=t.searchIndex,o=t.searchResults,n<0&&(n+=o.length),n%=o.length))&&(e.searchIndexSafe=!0),(e.activeColumn||e.forceColumnFormat)&&(this._differs(t.customColumn,t.customColumn=(a=t.activeColumn,r=t.forceColumnFormat,!(!a||r||!a.isComputed)&&a))&&(e.customColumn=!0),this._differs(t.columnFormat,t.columnFormat=function(e,t){return!(!e||e.isComputed&&!t)&&e}(t.activeColumn,t.forceColumnFormat))&&(e.columnFormat=!0)),e.activeColumn&&this._differs(t.columns,t.columns=function(e){var t=chart.dataset();if(!e)return t?t.columns():[];try{return t.columns().filter(function(e){return!e.isComputed})}catch(e){return[]}}(t.activeColumn))&&(e.columns=!0),(e.sortBy||e.sortDir)&&this._differs(t.sorting,t.sorting=(s=t.sortBy,i=t.sortDir,{sortBy:s,sortDir:i}))&&(e.sorting=!0)},l(Xe.prototype,{_add:function(e,t){this._dependents.push({component:e,props:t})},_init:function(e){for(var t={},n=0;n<e.length;n+=1){var o=e[n];t["$"+o]=this._state[o]}return t},_remove:function(e){for(var t=this._dependents.length;t--;)if(this._dependents[t].component===e)return void this._dependents.splice(t,1)},_sortComputedProperties:function(){var e,t=this._computed,n=this._sortedComputedProperties=[],o=C();function a(r){if(e[r])throw new Error("Cyclical dependency detected");if(!o[r]){o[r]=!0;var s=t[r];s&&(e[r]=!0,s.deps.forEach(a),n.push(s))}}for(var r in this._computed)e=C(),a(r)},compute:function(e,t,n){var o,a=this,r={deps:t,update:function(r,s,i){var l=t.map(function(e){return e in s&&(i=!0),r[e]});if(i){var u=n.apply(null,l);a._differs(u,o)&&(o=u,s[e]=!0,r[e]=o)}}};r.update(this._state,{},!0),this._computed[e]=r,this._sortComputedProperties()},get:S,observe:T,onchange:function(e){this._changeHandlers.push(e);var t=this;return{cancel:function(){var n=t._changeHandlers.indexOf(e);~n&&t._changeHandlers.splice(n,1)}}},set:function(e){var t=this._state,n=this._changed={},o=!1;for(var a in e){if(this._computed[a])throw new Error("'"+a+"' is a read-only property");this._differs(e[a],t[a])&&(n[a]=o=!0)}if(o){this._state=l({},t,e);for(var r=0;r<this._sortedComputedProperties.length;r+=1)this._sortedComputedProperties[r].update(this._state,n);for(r=0;r<this._changeHandlers.length;r+=1)this._changeHandlers[r](this._state,n);F(this,this._observers.pre,n,this._state,t);var s=this._dependents.slice();for(r=0;r<s.length;r+=1){var i=s[r],u={};o=!1;for(var c=0;c<i.props.length;c+=1){var m=i.props[c];m in n&&(u["$"+m]=this._state[m],o=!0)}o&&i.component.set(u)}F(this,this._observers.post,n,this._state,t)}}});return{App:Qe,store:new Xe({}),data:{chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0}}});

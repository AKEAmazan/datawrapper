!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("cm/lib/codemirror"),require("cm/mode/javascript/javascript"),require("cm/addon/mode/simple"),require("cm/addon/hint/show-hint"),require("cm/addon/edit/matchbrackets"),require("cm/addon/display/placeholder"),require("Handsontable")):"function"==typeof define&&define.amd?define("svelte/describe",["cm/lib/codemirror","cm/mode/javascript/javascript","cm/addon/mode/simple","cm/addon/hint/show-hint","cm/addon/edit/matchbrackets","cm/addon/display/placeholder","Handsontable"],e):t.describe=e(t.CodeMirror,null,null,null,null,null,t.HOT)}(this,function(t,e,n,r,o,a,i){"use strict";function u(){}function s(t){for(var e,n,r=arguments,o=1,a=arguments.length;o<a;o++)for(e in n=r[o])t[e]=n[e];return t}function l(t,e){e.appendChild(t)}function c(t,e,n){e.insertBefore(t,n)}function f(t){t.parentNode.removeChild(t)}function h(t){for(;t.previousSibling;)t.parentNode.removeChild(t.previousSibling)}function m(t){for(var e=0;e<t.length;e+=1)t[e]&&t[e].d()}function d(t){return document.createElement(t)}function p(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function v(t){return document.createTextNode(t)}function g(){return document.createComment("")}function b(t,e,n){t.addEventListener(e,n,!1)}function _(t,e,n){t.removeEventListener(e,n,!1)}function y(t,e,n){t.setAttribute(e,n)}function w(t,e,n){t.style.setProperty(e,n)}function x(t,e){for(var n=0;n<t.options.length;n+=1){var r=t.options[n];if(r.__value===e)return void(r.selected=!0)}}function C(t){var e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function M(){return Object.create(null)}function k(t){this.destroy=u,this.fire("destroy"),this.set=this.get=u,!1!==t&&this._fragment.u(),this._fragment.d(),this._fragment=this._state=null}function N(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function S(t,e){return t!=t?e==e:t!==e}function T(t,e,n,r,o){for(var a in e)if(n[a]){var i=r[a],u=o[a],s=e[a];if(s)for(var l=0;l<s.length;l+=1){var c=s[l];c.__calling||(c.__calling=!0,c.call(t,i,u),c.__calling=!1)}}}function F(t){return t?this._state[t]:this._state}function R(t,e){t._observers={pre:M(),post:M()},t._handlers=M(),t._bind=e._bind,t.options=e,t.root=e.root||t,t.store=t.root.store||e.store}function D(t,e,n){var r=n&&n.defer?this._observers.post:this._observers.pre;return(r[t]||(r[t]=[])).push(e),n&&!1===n.init||(e.__calling=!0,e.call(this,this._state[t]),e.__calling=!1),{cancel:function(){var n=r[t].indexOf(e);~n&&r[t].splice(n,1)}}}function H(t){for(;t&&t.length;)t.shift()()}function I(){this.store._remove(this)}t=t&&t.hasOwnProperty("default")?t.default:t,i=i&&i.hasOwnProperty("default")?i.default:i;var A={destroy:k,get:F,fire:function(t,e){var n=t in this._handlers&&this._handlers[t].slice();if(n)for(var r=0;r<n.length;r+=1)n[r].call(this,e)},observe:D,on:function(t,e){if("teardown"===t)return this.on("destroy",e);var n=this._handlers[t]||(this._handlers[t]=[]);return n.push(e),{cancel:function(){var t=n.indexOf(e);~t&&n.splice(t,1)}}},set:function(t){this._set(s({},t)),this.root._lock||(this.root._lock=!0,H(this.root._beforecreate),H(this.root._oncreate),H(this.root._aftercreate),this.root._lock=!1)},teardown:k,_recompute:u,_set:function(t){var e=this._state,n={},r=!1;for(var o in t)this._differs(t[o],e[o])&&(n[o]=r=!0);r&&(this._state=s({},e,t),this._recompute(n,this._state),this._bind&&this._bind(n,this._state),this._fragment&&(T(this,this._observers.pre,n,this._state,e),this._fragment.p(n,this._state),T(this,this._observers.post,n,this._state,e)))},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_unmount:function(){this._fragment&&this._fragment.u()},_differs:N};function U(t){var e=typeof t;return"function"===e||"object"===e&&!!t}var L,E=Array.prototype,$=Object.prototype,O=E.slice,j=$.toString,V=$.hasOwnProperty,Y=Array.isArray,z=Object.keys;function P(t,e){return null!=t&&V.call(t,e)}function q(t){if(!U(t))return[];if(z)return z(t);var e=[];for(var n in t)P(t,n)&&e.push(n);return ct&&function(t,e){var n=ft.length,r=t.constructor,o=J(r)&&r.prototype||$,a="constructor";P(t,a)&&!W(e,a)&&e.push(a);for(;n--;)(a=ft[n])in t&&t[a]!==o[a]&&!W(e,a)&&e.push(a)}(t,e),e}var B=function(t,e,n){return function(r,o,a){var i=0,u=st(r);if("number"==typeof a)t>0?i=a>=0?a:Math.max(a+u,i):u=a>=0?Math.min(a+1,u):a+u+1;else if(n&&a&&u)return a=n(r,o),r[a]===o?a:-1;if(o!=o)return(a=e(O.call(r,i,u),G))>=0?a+i:-1;for(a=t>0?i:u-1;a>=0&&a<u;a+=t)if(r[a]===o)return a;return-1}}(1,(L=1,function(t,e,n){e=ot(e,n);for(var r=st(t),o=L>0?0:r-1;o>=0&&o<r;o+=L)if(e(t[o],o,t))return o;return-1}),function(t,e,n,r){for(var o=(n=ot(n,r,1))(e),a=0,i=st(t);a<i;){var u=Math.floor((a+i)/2);n(t[u])<o?a=u+1:i=u}return a});function W(t,e,n,r){return lt(t)||(t=function(t){for(var e=q(t),n=e.length,r=Array(n),o=0;o<n;o++)r[o]=t[e[o]];return r}(t)),("number"!=typeof n||r)&&(n=0),B(t,e,n)>=0}var Z=Y||function(t){return"[object Array]"===j.call(t)};var J=("function"!=typeof/./&&"object"!=typeof Int8Array&&"undefined"!=typeof document&&"function"!=typeof document.childNodes?function(t){return"function"==typeof t||!1}:null)||function(t){return"[object Function]"===j.call(t)};!function(){j.call(arguments)}();function G(t){return function(t){return"[object Number]"===j.call(t)}(t)&&isNaN(t)}var Q=rt;function X(t){return t}var K,tt,et=(K=q,function(t){var e=arguments,n=arguments.length;if(tt&&(t=Object(t)),n<2||null==t)return t;for(var r=1;r<n;r++)for(var o=e[r],a=K(o),i=a.length,u=0;u<i;u++){var s=a[u];!U(t)||tt&&void 0!==t[s]||(t[s]=o[s])}return t});function nt(t){return t=et({},t),function(e){return function(t,e){var n=q(e),r=n.length;if(null==t)return!r;for(var o=Object(t),a=0;a<r;a++){var i=n[a];if(e[i]!==o[i]||!(i in o))return!1}return!0}(e,t)}}function rt(t,e){return ot(t,e,1/0)}function ot(t,e,n){return Q!==rt?Q(t,e):null==t?X:J(t)?function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,o){return t.call(e,n,r,o)};case 4:return function(n,r,o,a){return t.call(e,n,r,o,a)}}return function(){return t.apply(e,arguments)}}(t,e,n):U(t)?nt(t):it(t)}function at(t,e){return e=null==e?t.length-1:+e,function(){for(var n=arguments,r=Math.max(arguments.length-e,0),o=Array(r),a=0;a<r;a++)o[a]=n[a+e];switch(e){case 0:return t.call(this,o);case 1:return t.call(this,arguments[0],o);case 2:return t.call(this,arguments[0],arguments[1],o)}var i=Array(e+1);for(a=0;a<e;a++)i[a]=n[a];return i[e]=o,t.apply(this,i)}}function it(t){return function(e){return null==e?void 0:e[t]}}var ut=Math.pow(2,53)-1,st=it("length"),lt=function(t){var e=st(t);return"number"==typeof e&&e>=0&&e<=ut};var ct=!{toString:null}.propertyIsEnumerable("toString"),ft=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];!function(t){for(var e={},n=q(t),r=0,o=n.length;r<o;r++)e[t[n[r]]]=n[r]}({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"});var ht=at(function(t,e,n){return setTimeout(function(){return t.apply(null,n)},e)});function mt(t){if(!t||"object"!=typeof t)return t;try{return JSON.parse(JSON.stringify(t))}catch(e){return t}}var dt={insert:function(t){var e=this.get().cm;e.replaceSelection(t.key),e.focus()},removeColumn:function(){var t=this.get().column,e=this.store.get("dw_chart"),n=e.dataset(),r=mt(e.get("metadata.describe.computed-columns",{}));delete r[t.name()];var o=n.columnOrder()[n.indexOf(t.name())],a=[];e.get("metadata.data.changes",[]).forEach(function(t){t.column!=o&&(t.column>o&&t.column--,a.push(t))}),e.set("metadata.describe.computed-columns",r),e.set("metadata.data.changes",a),e.saveSoon(),this.fire("updateTable"),this.fire("unselect")}};function pt(){var e=this,n=this.get().column,r=this.store.get("dw_chart"),o=r.get("metadata.describe.computed-columns",{});this.set({formula:o[n.name()]||"",name:n.title()}),this.observe("column",function(t){t&&e.set({formula:o[t.name()]||"",name:t.title()})});var a=this;var i=t.fromTextArea(this.refs.code,{value:this.get("formula")||"",mode:"simple",indentUnit:2,tabSize:2,lineWrapping:!0,matchBrackets:!0,placeholder:"// enter formula here",continueComments:"Enter",extraKeys:{Tab:"autocomplete"},hintOptions:{hint:function(e){var n=e.getCursor(),r=e.getTokenAt(n),o=[],i=a.get("keywords");return"variable"==r.type&&(o=i.filter(function(t){return 0===t.toLowerCase().indexOf(r.string.toLowerCase())})),{list:o,from:t.Pos(n.line,r.start),to:t.Pos(n.line,r.end)}}}});window.CodeMirror=t,this.set({cm:i});var u,s,l,c,f,h,m,d=(u=function(){return e.fire("updateTable")},s=1500,h=function(t,e){c=null,e&&(f=u.apply(t,e))},(m=at(function(t){if(c&&clearTimeout(c),l){var e=!c;c=setTimeout(h,s),e&&(f=u.apply(this,t))}else c=ht(h,s,this,t);return f})).cancel=function(){clearTimeout(c),c=null},m);this.observe("formula",function(t){t!=i.getValue()&&i.setValue(t);var n=e.get().column,o=r.get("metadata.describe.computed-columns",{});o[n.name()]!=t&&(o[n.name()]=t,r.set("metadata.describe.computed-columns",o),r.saveSoon&&r.saveSoon(),d())}),this.observe("name",function(t){var n=e.get().column,o=r.get("metadata.data.changes",[]),a=r.dataset(),i=a.columnOrder()[a.indexOf(n.name())],u=-1;o.forEach(function(t,e){t.column==i&&0===t.row&&(u=e)}),u>-1?(o[u].value=t,o[u].time=(new Date).getTime()):o.push({column:i,row:0,value:t,time:(new Date).getTime()}),r.set("metadata.data.changes",o),r.saveSoon&&r.saveSoon(),d()}),i.on("change",function(t){e.set({formula:t.getValue()})}),this.observe("metaColumns",function(n){var r=new RegExp("(?:"+e.get("keywords").join("|")+")");t.defineSimpleMode("simplemode",{start:[{regex:/"(?:[^\\]|\\.)*?(?:"|$)/,token:"string"},{regex:/(function)(\s+)([a-z$][\w$]*)/,token:["keyword",null,"keyword"]},{regex:/(?:function|var|return|if|for|while|else|do|this)\b/,token:"keyword"},{regex:/true|false|null|undefined/,token:"atom"},{regex:/0x[a-f\d]+|[-+]?(?:\.\d+|\d+\.?\d*)(?:e[-+]?\d+)?/i,token:"number"},{regex:/\/\/.*/,token:"comment"},{regex:/\/(?:[^\\]|\\.)*?\//,token:"variable-3"},{regex:/\/\*/,token:"comment",next:"comment"},{regex:/[-+\/*=<>!]+/,token:"operator"},{regex:/[\{\[\(]/,indent:!0},{regex:/[\}\]\)]/,dedent:!0},{regex:r,token:"variable-2"},{regex:/[a-z$][\w$]*/,token:"variable"},{regex:/<</,token:"meta",mode:{spec:"xml",end:/>>/}}],comment:[{regex:/.*?\*\//,token:"comment",next:"start"},{regex:/.*/,token:"comment"}],meta:{dontIndentStates:["comment"],lineComment:"//"}}),i.setOption("mode","simplemode")})}function vt(t,e){var n,r,o=e.col,a=(e.col_index,o.key);return{c:function(){n=d("li"),r=v(a),this.h()},h:function(){n.className="svelte-du6ec3",b(n,"click",gt),n._svelte={component:t,metaColumns:e.metaColumns,col_index:e.col_index}},m:function(t,e){c(n,t,e),l(r,n)},p:function(t,e){o=e.col,e.col_index,t.metaColumns&&a!==(a=o.key)&&(r.data=a),n._svelte.metaColumns=e.metaColumns,n._svelte.col_index=e.col_index},u:function(){f(n)},d:function(){_(n,"click",gt)}}}function gt(t){var e=this._svelte.component,n=this._svelte.metaColumns[this._svelte.col_index];e.insert(n)}function bt(t){R(this,t),this.refs={},this._state=s({name:"",formula:""},t.data),this._recompute({column:1,columns:1,metaColumns:1},this._state);var e=pt.bind(this);t.root||(this._oncreate=[]),this._fragment=function(t,e){var n,r,o,a,i,u,h,p,g,y,x,C,M,k,N,S,T,F,R,D,H,I,A,U,L,E,$,O=!1;function j(){O=!0,t.set({name:x.value}),O=!1}for(var V=e.metaColumns,Y=[],z=0;z<V.length;z+=1)Y[z]=vt(t,s({},e,{metaColumns:V,col:V[z],col_index:z}));function P(e){t.removeColumn()}return{c:function(){n=d("div"),r=d("h3"),o=v(e.title),a=v("\n    "),i=d("p"),u=v("Die Werte in den Spalten können nach einer Formel berechnet werden, wie in Excel."),h=v("\n\n    "),p=d("label"),g=v("Spaltenname"),y=v("\n    "),x=d("input"),C=v("\n\n    "),M=d("label"),k=v("Formel (JavaScript)"),N=v("\n    "),S=d("textarea"),T=v("\n\n    "),F=d("p"),R=v("Verfügbare Spalten (lassen sich per Klick hinzufügen)"),D=v(":"),H=v("\n\n    "),I=d("ul");for(var t=0;t<Y.length;t+=1)Y[t].c();A=v("\n\n"),U=d("button"),L=d("i"),E=v(" "),$=v("Diese Spalte entfernen"),this.h()},h:function(){r.className="first",p.className="svelte-du6ec3",b(x,"input",j),x.type="text",M.className="svelte-du6ec3",S.className="code",w(F,"margin-top","1em"),I.className="col-select svelte-du6ec3",w(n,"margin-bottom","15px"),L.className="fa fa-trash",U.className="btn btn-danger",b(U,"click",P)},m:function(s,f){c(n,s,f),l(r,n),l(o,r),l(a,n),l(i,n),l(u,i),l(h,n),l(p,n),l(g,p),l(y,n),l(x,n),x.value=e.name,l(C,n),l(M,n),l(k,M),l(N,n),l(S,n),t.refs.code=S,l(T,n),l(F,n),l(R,F),l(D,F),l(H,n),l(I,n);for(var m=0;m<Y.length;m+=1)Y[m].m(I,null);c(A,s,f),c(U,s,f),l(L,U),l(E,U),l($,U)},p:function(e,n){e.title&&(o.data=n.title),O||(x.value=n.name);var r=n.metaColumns;if(e.metaColumns){for(var a=0;a<r.length;a+=1){var i=s({},n,{metaColumns:r,col:r[a],col_index:a});Y[a]?Y[a].p(e,i):(Y[a]=vt(t,i),Y[a].c(),Y[a].m(I,null))}for(;a<Y.length;a+=1)Y[a].u(),Y[a].d();Y.length=r.length}},u:function(){f(n);for(var t=0;t<Y.length;t+=1)Y[t].u();f(A),f(U)},d:function(){_(x,"input",j),t.refs.code===S&&(t.refs.code=null),m(Y),_(U,"click",P)}}}(this,this._state),this.root._oncreate.push(e),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),H(this._oncreate))}function _t(t){R(this,t),this._state=s({disabled:!1},t.data),this._fragment=function(t,e){var n,r,o,a,i,u;function s(){t.set({value:o.checked})}return{c:function(){n=d("div"),r=d("label"),o=d("input"),a=v(" "),i=v(e.label),this.h()},h:function(){b(o,"change",s),o.type="checkbox",o.disabled=e.disabled,o.className="svelte-llolt7",r.className=u="checkbox "+(e.disabled?"disabled":"")+" svelte-llolt7",n.className="control-group vis-option-group vis-option-type-checkbox"},m:function(t,u){c(n,t,u),l(r,n),l(o,r),o.checked=e.value,l(a,r),l(i,r)},p:function(t,e){o.checked=e.value,t.disabled&&(o.disabled=e.disabled),t.label&&(i.data=e.label),t.disabled&&u!==(u="checkbox "+(e.disabled?"disabled":"")+" svelte-llolt7")&&(r.className=u)},u:function(){f(n)},d:function(){_(o,"change",s)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor))}function yt(t,e){var n,r,o,a=e.opt,i=(e.opt_index,a.label);return{c:function(){n=d("option"),r=v(i),this.h()},h:function(){n.__value=o=a.value,n.value=n.__value},m:function(t,e){c(n,t,e),l(r,n)},p:function(t,e){a=e.opt,e.opt_index,t.options&&i!==(i=a.label)&&(r.data=i),t.options&&o!==(o=a.value)&&(n.__value=o),n.value=n.__value},u:function(){f(n)},d:u}}function wt(t,e){for(var n,r=e.options,o=[],a=0;a<r.length;a+=1)o[a]=yt(0,s({},e,{options:r,opt:r[a],opt_index:a}));return{c:function(){for(var t=0;t<o.length;t+=1)o[t].c();n=g()},m:function(t,e){for(var r=0;r<o.length;r+=1)o[r].m(t,e);c(n,t,e)},p:function(t,e){var r=e.options;if(t.options){for(var a=0;a<r.length;a+=1){var i=s({},e,{options:r,opt:r[a],opt_index:a});o[a]?o[a].p(t,i):(o[a]=yt(0,i),o[a].c(),o[a].m(n.parentNode,n))}for(;a<o.length;a+=1)o[a].u(),o[a].d();o.length=r.length}},u:function(){for(var t=0;t<o.length;t+=1)o[t].u();f(n)},d:function(){m(o)}}}function xt(t,e){for(var n,r,o=e.optgroup,a=(e.optgroup_index,o.options),i=[],u=0;u<a.length;u+=1)i[u]=Ct(t,s({},e,{options:a,opt:a[u],opt_index:u}));return{c:function(){n=d("optgroup");for(var t=0;t<i.length;t+=1)i[t].c();this.h()},h:function(){y(n,"label",r=o.label)},m:function(t,e){c(n,t,e);for(var r=0;r<i.length;r+=1)i[r].m(n,null)},p:function(e,a){o=a.optgroup,a.optgroup_index;var u=o.options;if(e.optgroups){for(var l=0;l<u.length;l+=1){var c=s({},a,{options:u,opt:u[l],opt_index:l});i[l]?i[l].p(e,c):(i[l]=Ct(t,c),i[l].c(),i[l].m(n,null))}for(;l<i.length;l+=1)i[l].u(),i[l].d();i.length=u.length}e.optgroups&&r!==(r=o.label)&&y(n,"label",r)},u:function(){f(n);for(var t=0;t<i.length;t+=1)i[t].u()},d:function(){m(i)}}}function Ct(t,e){e.optgroup;var n,r,o,a=e.opt,i=(e.optgroup_index,e.opt_index,a.label);return{c:function(){n=d("option"),r=v(i),this.h()},h:function(){n.__value=o=a.value,n.value=n.__value},m:function(t,e){c(n,t,e),l(r,n)},p:function(t,e){e.optgroup,a=e.opt,e.optgroup_index,e.opt_index,t.optgroups&&i!==(i=a.label)&&(r.data=i),t.optgroups&&o!==(o=a.value)&&(n.__value=o),n.value=n.__value},u:function(){f(n)},d:u}}function Mt(t,e){for(var n,r=e.optgroups,o=[],a=0;a<r.length;a+=1)o[a]=xt(t,s({},e,{optgroups:r,optgroup:r[a],optgroup_index:a}));return{c:function(){for(var t=0;t<o.length;t+=1)o[t].c();n=g()},m:function(t,e){for(var r=0;r<o.length;r+=1)o[r].m(t,e);c(n,t,e)},p:function(e,r){var a=r.optgroups;if(e.optgroups){for(var i=0;i<a.length;i+=1){var u=s({},r,{optgroups:a,optgroup:a[i],optgroup_index:i});o[i]?o[i].p(e,u):(o[i]=xt(t,u),o[i].c(),o[i].m(n.parentNode,n))}for(;i<o.length;i+=1)o[i].u(),o[i].d();o.length=a.length}},u:function(){for(var t=0;t<o.length;t+=1)o[t].u();f(n)},d:function(){m(o)}}}function kt(t){R(this,t),this._state=s({disabled:!1,width:"auto",options:[],optgroups:[]},t.data),t.root||(this._oncreate=[],this._beforecreate=[]),this._fragment=function(t,e){var n,r,o,a,i,u,s,h=!1,m=e.options.length&&wt(0,e),p=e.optgroups.length&&Mt(t,e);function y(){h=!0,t.set({value:C(i)}),h=!1}return{c:function(){n=d("div"),r=d("label"),o=v("\n\n    "),a=d("div"),i=d("select"),m&&m.c(),u=g(),p&&p.c(),this.h()},h:function(){r.className="control-label",b(i,"change",y),"value"in e||t.root._beforecreate.push(y),i.disabled=e.disabled,w(i,"width",e.width),a.className=s="controls form-inline "+(e.disabled?"disabled":""),n.className="control-group vis-option-type-select"},m:function(t,s){c(n,t,s),l(r,n),r.innerHTML=e.label,l(o,n),l(a,n),l(i,a),m&&m.m(i,null),l(u,i),p&&p.m(i,null),x(i,e.value)},p:function(e,n){e.label&&(r.innerHTML=n.label),n.options.length?m?m.p(e,n):((m=wt(0,n)).c(),m.m(i,u)):m&&(m.u(),m.d(),m=null),n.optgroups.length?p?p.p(e,n):((p=Mt(t,n)).c(),p.m(i,null)):p&&(p.u(),p.d(),p=null),h||x(i,n.value),e.disabled&&(i.disabled=n.disabled),e.width&&w(i,"width",n.width),e.disabled&&s!==(s="controls form-inline "+(n.disabled?"disabled":""))&&(a.className=s)},u:function(){r.innerHTML="",f(n),m&&m.u(),p&&p.u()},d:function(){m&&m.d(),p&&p.d(),_(i,"change",y)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),H(this._beforecreate))}s(bt.prototype,dt,A),bt.prototype._recompute=function(t,e){var n,r;t.column&&this._differs(e.title,e.title=(n=e.column,"Spalte %s bearbeiten".replace("%s",'"'+(n?n.title()||n.name():"--")+'"')))&&(t.title=!0),t.columns&&this._differs(e.metaColumns,e.metaColumns=(r=e.columns)?r.map(function(t){return{key:(e=t.name(),e.toString().toLowerCase().replace(/\s+/g,"_").replace(/[^\w-]+/g,"").replace(/-/g,"_").replace(/__+/g,"_").replace(/^_+/,"").replace(/_+$/,"").replace(/^(\d)/,"_$1").replace(/^(abstract|arguments|await|boolean|break|byte|case|catch|char|class|const|continue|debugger|default|delete|do|double|else|enum|eval|export|extends|false|final|finally|float|for|function|goto|if|implements|import|in|instanceof|int|interface|let|long|native|new|null|package|private|protected|public|return|short|static|super|switch|synchronized|this|throw|throws|transient|true|try|typeof|var|void|volatile|while|window|with|yield)$/,"$1_")),title:t.title(),type:t.type()};var e}):[])&&(t.metaColumns=!0),t.metaColumns&&this._differs(e.keywords,e.keywords=function(t){var e=["sum","round","min","max","median","mean"];return t.forEach(function(t){e.push(t.key),"number"==t.type&&(e.push(t.key+"__sum"),e.push(t.key+"__min"),e.push(t.key+"__max"),e.push(t.key+"__mean"),e.push(t.key+"__median"))}),e}(e.metaColumns))&&(t.keywords=!0)},s(_t.prototype,A),s(kt.prototype,A);var Nt=Date.now||function(){return(new Date).getTime()};function St(t,e,n){var r,o,a,i,u=0;n||(n={});var s=function(){u=!1===n.leading?0:Nt(),r=null,i=t.apply(o,a),r||(o=a=null)},l=function(){var l=Nt();u||!1!==n.leading||(u=l);var c=e-(l-u);return o=this,a=arguments,c<=0||c>e?(r&&(clearTimeout(r),r=null),u=l,i=t.apply(o,a),r||(o=a=null)):r||!1===n.trailing||(r=setTimeout(s,c)),i};return l.cancel=function(){clearTimeout(r),u=0,r=o=a=null},l}function Tt(t){if(Z(t)){var e={};return Object.keys(t).forEach(function(n){return e[n]=t[n]}),e}return t}var Ft={autoDivisor:function(){var t=this.store.get("dw_chart"),e=this.get().column,n=dw.utils.metricSuffix(t.locale()),r=e.values(),o=dw.utils.significantDimension(r),a=o<-2?3*Math.round(-1*o/3):o>4?-1*o:0,i=r.map(function(t){return t/Math.pow(10,a)}),u=dw.utils.significantDimension(i);u<=0&&(u=i.reduce(function(t,e){return Math.max(t,Math.min(3,dw.utils.tailLength(e)))},0)),u==a&&(a=0,u=0),a>15&&(a=0,u=0),this.set({columnFormat:{"number-divisor":a,"number-format":"n"+Math.max(0,u),"number-prepend":"","number-append":a?n[a]||" × 10<sup>"+a+"</sup>":""}})},getColumnFormat:function(t){var e=mt(Tt(this.store.get("dw_chart").get("metadata.data.column-format",{}))[t.name()]);return e&&"auto"!=e&&void 0===e.length||(e={type:"auto",ignore:!1,"number-prepend":"","number-append":"","number-format":"auto"}),e}};function Rt(t,e){var n,r,o,a,i,u,s,h,m,p,g={},y={},x=!1,C=!1,M={label:"Zahlen runden auf",options:[{value:"-",label:"(automatisch - individuell)"},{value:"auto",label:"(automatisch - einheitlich)"}],optgroups:e.numberFormats,width:"180px"};"number-format"in e.columnFormat&&(M.value=e.columnFormat["number-format"],g.value=!0);var k=new kt({root:t.root,data:M,_bind:function(e,n){var r=t.get(),o={};!g.value&&e.value&&(r.columnFormat["number-format"]=n.value,o.columnFormat=r.columnFormat),t._set(o),g={}}});t.root._beforecreate.push(function(){k._bind({value:1},k.get())});var N={label:"Teilen/multiplizieren",options:e.divisors_opts,optgroups:e.divisors,width:"180px"};"number-divisor"in e.columnFormat&&(N.value=e.columnFormat["number-divisor"],y.value=!0);var S=new kt({root:t.root,data:N,_bind:function(e,n){var r=t.get(),o={};!y.value&&e.value&&(r.columnFormat["number-divisor"]=n.value,o.columnFormat=r.columnFormat),t._set(o),y={}}});function T(){var e=t.get();x=!0,e.columnFormat["number-prepend"]=h.value,t.set({columnFormat:e.columnFormat}),x=!1}function F(){var e=t.get();C=!0,e.columnFormat["number-append"]=p.value,t.set({columnFormat:e.columnFormat}),C=!1}return t.root._beforecreate.push(function(){S._bind({value:1},S.get())}),{c:function(){k._fragment.c(),n=v("\n        "),S._fragment.c(),r=v("\n\n        "),o=d("div"),a=d("label"),i=v("Präfix/Suffix"),u=v("\n            "),s=d("div"),h=d("input"),m=v("\n                #\n                "),p=d("input"),this.h()},h:function(){a.className="control-label",b(h,"input",T),w(h,"width","6ex"),w(h,"text-align","right"),h.dataset.lpignore="true",h.name="prepend",h.type="text",b(p,"input",F),w(p,"width","6ex"),p.dataset.lpignore="true",p.name="append",p.type="text",s.className="controls form-inline",o.className="control-group vis-option-type-select"},m:function(t,f){k._mount(t,f),c(n,t,f),S._mount(t,f),c(r,t,f),c(o,t,f),l(a,o),l(i,a),l(u,o),l(s,o),l(h,s),h.value=e.columnFormat["number-prepend"],l(m,s),l(p,s),p.value=e.columnFormat["number-append"]},p:function(t,e){var n={label:"Zahlen runden auf",options:[{value:"-",label:"(automatisch - individuell)"},{value:"auto",label:"(automatisch - einheitlich)"}]};t.numberFormats&&(n.optgroups=e.numberFormats),!g.value&&t.columnFormat&&(n.value=e.columnFormat["number-format"],g.value=!0),k._set(n),g={};var r={label:"Teilen/multiplizieren"};t.divisors_opts&&(r.options=e.divisors_opts),t.divisors&&(r.optgroups=e.divisors),!y.value&&t.columnFormat&&(r.value=e.columnFormat["number-divisor"],y.value=!0),S._set(r),y={},x||(h.value=e.columnFormat["number-prepend"]),C||(p.value=e.columnFormat["number-append"])},u:function(){k._unmount(),f(n),S._unmount(),f(r),f(o)},d:function(){k.destroy(!1),S.destroy(!1),_(h,"input",T),_(p,"input",F)}}}function Dt(t){R(this,t),this._state=s({columnFormat:{type:"auto",ignore:!1,"number-divisor":"-","number-format":"auto","number-prepend":"","number-append":""},colTypes:[],divisors_opts:[{value:0,label:"(keine Änderung)"},{value:"auto",label:"(automatisch erkennen)"}],divisors:[{label:"Teilen durch",options:[{value:3,label:"1000"},{value:6,label:"1 million"},{value:9,label:"1 billion"}]},{label:"Multiplizieren mit",options:[{value:-2,label:"100"},{value:-3,label:"1000"},{value:-6,label:"1 million"},{value:-9,label:"1 billion"},{value:-12,label:"1 trillion"}]}],numberFormats:[{label:"Nachkommastellen",options:[{value:"n3",label:"3 (1,234.568)"},{value:"n2",label:"2 (1,234.57)"},{value:"n1",label:"1 (1,234.6)"},{value:"n0",label:"0 (1,235)"}]},{label:"Relevante Ziffern",options:[{value:"s6",label:"6 (1,234.57)"},{value:"s5",label:"5 (123.45)"},{value:"s4",label:"4 (12.34)"},{value:"s3",label:"3 (1.23)"},{value:"s2",label:"2 (0.12)"},{value:"s1",label:"1 (0.01)"}]}]},t.data),this._recompute({column:1},this._state);var e=function(){var t=this,e=St(function(){t.fire("updateTable")},100,{leading:!1}),n=St(function(){t.fire("updateTable")},100,{leading:!1}),r=this.get().column;this.set({colTypes:[{value:"auto",label:"auto ("+r.type()+")"},{value:"text",label:"Text"},{value:"number",label:"Number"},{value:"date",label:"Date"}]}),this.set({columnFormat:this.getColumnFormat(r)}),this.observe("column",function(e){t.set({columnFormat:t.getColumnFormat(e)}),t.get().colTypes[0].label="auto ("+r.type()+")"}),this.observe("columnFormat",function(r){var o=t.store.get("dw_chart"),a=t.get().column,i=Tt(o.get("metadata.data.column-format",{})),u=i[a.name()];if(!u||JSON.stringify(u)!=JSON.stringify(r)){if("auto"==r["number-divisor"])return void setTimeout(function(){return t.autoDivisor()},100);i[a.name()]=mt(r),o.set("metadata.data.column-format",i),o.saveSoon&&o.saveSoon(),u&&u.type==r.type?n():e()}})}.bind(this);t.root||(this._oncreate=[],this._beforecreate=[],this._aftercreate=[]),this._fragment=function(t,e){var n,r,o,a,i,u,s,h,m,p={},g={},b={label:"Spaltentyp",options:e.colTypes,width:"180px"};"type"in e.columnFormat&&(b.value=e.columnFormat.type,p.value=!0);var _=new kt({root:t.root,data:b,_bind:function(e,n){var r=t.get(),o={};!p.value&&e.value&&(r.columnFormat.type=n.value,o.columnFormat=r.columnFormat),t._set(o),p={}}});t.root._beforecreate.push(function(){_._bind({value:1},_.get())});var y={label:"Spalte in Diagramm ausblenden"};"ignore"in e.columnFormat&&(y.value=e.columnFormat.ignore,g.value=!0);var w=new _t({root:t.root,data:y,_bind:function(e,n){var r=t.get(),o={};!g.value&&e.value&&(r.columnFormat.ignore=n.value,o.columnFormat=r.columnFormat),t._set(o),g={}}});t.root._beforecreate.push(function(){w._bind({value:1},w.get())});var x=e.column&&"number"==e.column.type()&&Rt(t,e);return{c:function(){n=d("div"),r=d("h3"),o=v(e.title),a=v("\n\n    "),i=d("div"),_._fragment.c(),u=v("\n\n        "),w._fragment.c(),s=v("\n\n        "),h=d("hr"),m=v("\n\n        "),x&&x.c(),this.h()},h:function(){r.className="first",i.className="form-horizontal"},m:function(t,e){c(n,t,e),l(r,n),l(o,r),l(a,n),l(i,n),_._mount(i,null),l(u,i),w._mount(i,null),l(s,i),l(h,i),l(m,i),x&&x.m(i,null)},p:function(e,n){e.title&&(o.data=n.title);var r={label:"Spaltentyp"};e.colTypes&&(r.options=n.colTypes),!p.value&&e.columnFormat&&(r.value=n.columnFormat.type,p.value=!0),_._set(r),p={};var a={label:"Spalte in Diagramm ausblenden"};!g.value&&e.columnFormat&&(a.value=n.columnFormat.ignore,g.value=!0),w._set(a),g={},n.column&&"number"==n.column.type()?x?x.p(e,n):((x=Rt(t,n)).c(),x.m(i,null)):x&&(x.u(),x.d(),x=null)},u:function(){f(n),x&&x.u()},d:function(){_.destroy(!1),w.destroy(!1),x&&x.d()}}}(this,this._state),this.root._oncreate.push(e),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),this._lock=!0,H(this._beforecreate),H(this._oncreate),H(this._aftercreate),this._lock=!1)}function Ht(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}s(Dt.prototype,Ft,A),Dt.prototype._recompute=function(t,e){var n;t.column&&this._differs(e.title,e.title=(n=e.column,"Spalte %s bearbeiten".replace("%s",'"'+(n?n.title()||n.name():"--")+'"')))&&(t.title=!0)};var It,At,Ut=(1===(It=Ht).length&&(At=It,It=function(t,e){return Ht(At(t),e)}),{left:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var o=n+r>>>1;It(t[o],e)<0?n=o+1:r=o}return n},right:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var o=n+r>>>1;It(t[o],e)>0?r=o:n=o+1}return n}}).right;function Lt(t){return null===t?NaN:+t}function Et(t,e){var n,r,o,a=t.length,i=-1;if(null==e){for(;++i<a;)if(null!=(n=t[i])&&n>=n)for(r=o=n;++i<a;)null!=(n=t[i])&&(r>n&&(r=n),o<n&&(o=n))}else for(;++i<a;)if(null!=(n=e(t[i],i,t))&&n>=n)for(r=o=n;++i<a;)null!=(n=e(t[i],i,t))&&(r>n&&(r=n),o<n&&(o=n));return[r,o]}var $t=Array.prototype.slice;function Ot(t){return function(){return t}}function jt(t){return t}var Vt=Math.sqrt(50),Yt=Math.sqrt(10),zt=Math.sqrt(2);function Pt(t,e,n){var r=(e-t)/Math.max(0,n),o=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,o);return o>=0?(a>=Vt?10:a>=Yt?5:a>=zt?2:1)*Math.pow(10,o):-Math.pow(10,-o)/(a>=Vt?10:a>=Yt?5:a>=zt?2:1)}function qt(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),o=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/o;return a>=Vt?o*=10:a>=Yt?o*=5:a>=zt&&(o*=2),e<t?-o:o}function Bt(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1}function Wt(){var t=jt,e=Et,n=Bt;function r(r){var o,a,i=r.length,u=new Array(i);for(o=0;o<i;++o)u[o]=t(r[o],o,r);var s=e(u),l=s[0],c=s[1],f=n(u,l,c);Array.isArray(f)||(f=qt(l,c,f),f=function(t,e,n){t=+t,e=+e,n=(o=arguments.length)<2?(e=t,t=0,1):o<3?1:+n;for(var r=-1,o=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(o);++r<o;)a[r]=t+r*n;return a}(Math.ceil(l/f)*f,Math.floor(c/f)*f,f));for(var h=f.length;f[0]<=l;)f.shift(),--h;for(;f[h-1]>c;)f.pop(),--h;var m,d=new Array(h+1);for(o=0;o<=h;++o)(m=d[o]=[]).x0=o>0?f[o-1]:l,m.x1=o<h?f[o]:c;for(o=0;o<i;++o)l<=(a=u[o])&&a<=c&&d[Ut(f,a,0,h)].push(r[o]);return d}return r.value=function(e){return arguments.length?(t="function"==typeof e?e:Ot(e),r):t},r.domain=function(t){return arguments.length?(e="function"==typeof t?t:Ot([t[0],t[1]]),r):e},r.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?Ot($t.call(t)):Ot(t),r):n},r}function Zt(t,e){var n,r,o=t.length,a=-1;if(null==e){for(;++a<o;)if(null!=(n=t[a])&&n>=n)for(r=n;++a<o;)null!=(n=t[a])&&n>r&&(r=n)}else for(;++a<o;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=n;++a<o;)null!=(n=e(t[a],a,t))&&n>r&&(r=n);return r}function Jt(t,e){var n,r=t.length,o=r,a=-1,i=0;if(null==e)for(;++a<r;)isNaN(n=Lt(t[a]))?--o:i+=n;else for(;++a<r;)isNaN(n=Lt(e(t[a],a,t)))?--o:i+=n;if(o)return i/o}function Gt(t,e){var n,r=t.length,o=-1,a=[];if(null==e)for(;++o<r;)isNaN(n=Lt(t[o]))||a.push(n);else for(;++o<r;)isNaN(n=Lt(e(t[o],o,t)))||a.push(n);return function(t,e,n){if(null==n&&(n=Lt),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,o=(r-1)*e,a=Math.floor(o),i=+n(t[a],a,t);return i+(+n(t[a+1],a+1,t)-i)*(o-a)}}(a.sort(Ht),.5)}function Qt(){}function Xt(t,e){var n=new Qt;if(t instanceof Qt)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var r,o=-1,a=t.length;if(null==e)for(;++o<a;)n.set(o,t[o]);else for(;++o<a;)n.set(e(r=t[o],o,t),r)}else if(t)for(var i in t)n.set(i,t[i]);return n}function Kt(){}Qt.prototype=Xt.prototype={constructor:Qt,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var te=Xt.prototype;Kt.prototype=function(t,e){var n=new Kt;if(t instanceof Kt)t.each(function(t){n.add(t)});else if(t){var r=-1,o=t.length;if(null==e)for(;++r<o;)n.add(t[r]);else for(;++r<o;)n.add(e(t[r],r,t))}return n}.prototype={constructor:Kt,has:te.has,add:function(t){return this["$"+(t+="")]=t,this},remove:te.remove,clear:te.clear,values:te.keys,size:te.size,empty:te.empty,each:te.each};var ee=Array.prototype,ne=ee.map,re=ee.slice;function oe(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ae(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ie(){}var ue="\\s*([+-]?\\d+)\\s*",se="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",le="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ce=/^#([0-9a-f]{3})$/,fe=/^#([0-9a-f]{6})$/,he=new RegExp("^rgb\\("+[ue,ue,ue]+"\\)$"),me=new RegExp("^rgb\\("+[le,le,le]+"\\)$"),de=new RegExp("^rgba\\("+[ue,ue,ue,se]+"\\)$"),pe=new RegExp("^rgba\\("+[le,le,le,se]+"\\)$"),ve=new RegExp("^hsl\\("+[se,le,le]+"\\)$"),ge=new RegExp("^hsla\\("+[se,le,le,se]+"\\)$"),be={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function _e(t){var e;return t=(t+"").trim().toLowerCase(),(e=ce.exec(t))?new Me((e=parseInt(e[1],16))>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):(e=fe.exec(t))?ye(parseInt(e[1],16)):(e=he.exec(t))?new Me(e[1],e[2],e[3],1):(e=me.exec(t))?new Me(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=de.exec(t))?we(e[1],e[2],e[3],e[4]):(e=pe.exec(t))?we(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=ve.exec(t))?ke(e[1],e[2]/100,e[3]/100,1):(e=ge.exec(t))?ke(e[1],e[2]/100,e[3]/100,e[4]):be.hasOwnProperty(t)?ye(be[t]):"transparent"===t?new Me(NaN,NaN,NaN,0):null}function ye(t){return new Me(t>>16&255,t>>8&255,255&t,1)}function we(t,e,n,r){return r<=0&&(t=e=n=NaN),new Me(t,e,n,r)}function xe(t){return t instanceof ie||(t=_e(t)),t?new Me((t=t.rgb()).r,t.g,t.b,t.opacity):new Me}function Ce(t,e,n,r){return 1===arguments.length?xe(t):new Me(t,e,n,null==r?1:r)}function Me(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function ke(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ne(t,e,n,r)}function Ne(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Se(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}oe(ie,_e,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),oe(Me,Ce,ae(ie,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Me(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Me(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),oe(Ne,function(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Ne)return new Ne(t.h,t.s,t.l,t.opacity);if(t instanceof ie||(t=_e(t)),!t)return new Ne;if(t instanceof Ne)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),a=Math.max(e,n,r),i=NaN,u=a-o,s=(a+o)/2;return u?(i=e===a?(n-r)/u+6*(n<r):n===a?(r-e)/u+2:(e-n)/u+4,u/=s<.5?a+o:2-a-o,i*=60):u=s>0&&s<1?0:i,new Ne(i,u,s,t.opacity)}(t):new Ne(t,e,n,null==r?1:r)},ae(ie,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Ne(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ne(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,o=2*n-r;return new Me(Se(t>=240?t-240:t+120,o,r),Se(t,o,r),Se(t<120?t+240:t-120,o,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var Te=Math.PI/180,Fe=180/Math.PI,Re=.95047,De=1,He=1.08883,Ie=4/29,Ae=6/29,Ue=3*Ae*Ae,Le=Ae*Ae*Ae;function Ee(t){if(t instanceof $e)return new $e(t.l,t.a,t.b,t.opacity);if(t instanceof ze){var e=t.h*Te;return new $e(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof Me||(t=xe(t));var n=Ye(t.r),r=Ye(t.g),o=Ye(t.b),a=Oe((.4124564*n+.3575761*r+.1804375*o)/Re),i=Oe((.2126729*n+.7151522*r+.072175*o)/De);return new $e(116*i-16,500*(a-i),200*(i-Oe((.0193339*n+.119192*r+.9503041*o)/He)),t.opacity)}function $e(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Oe(t){return t>Le?Math.pow(t,1/3):t/Ue+Ie}function je(t){return t>Ae?t*t*t:Ue*(t-Ie)}function Ve(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Ye(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ze(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}oe($e,function(t,e,n,r){return 1===arguments.length?Ee(t):new $e(t,e,n,null==r?1:r)},ae(ie,{brighter:function(t){return new $e(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new $e(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return t=De*je(t),new Me(Ve(3.2404542*(e=Re*je(e))-1.5371385*t-.4985314*(n=He*je(n))),Ve(-.969266*e+1.8760108*t+.041556*n),Ve(.0556434*e-.2040259*t+1.0572252*n),this.opacity)}})),oe(ze,function(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof ze)return new ze(t.h,t.c,t.l,t.opacity);t instanceof $e||(t=Ee(t));var e=Math.atan2(t.b,t.a)*Fe;return new ze(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}(t):new ze(t,e,n,null==r?1:r)},ae(ie,{brighter:function(t){return new ze(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new ze(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return Ee(this).rgb()}}));var Pe=-.14861,qe=1.78277,Be=-.29227,We=-.90649,Ze=1.97294,Je=Ze*We,Ge=Ze*qe,Qe=qe*Be-We*Pe;function Xe(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Ke(t){return function(){return t}}function tn(t){return 1==(t=+t)?en:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Ke(isNaN(e)?n:e)}}function en(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):Ke(isNaN(t)?e:t)}oe(Xe,function(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Xe)return new Xe(t.h,t.s,t.l,t.opacity);t instanceof Me||(t=xe(t));var e=t.r/255,n=t.g/255,r=t.b/255,o=(Qe*r+Je*e-Ge*n)/(Qe+Je-Ge),a=r-o,i=(Ze*(n-o)-Be*a)/We,u=Math.sqrt(i*i+a*a)/(Ze*o*(1-o)),s=u?Math.atan2(i,a)*Fe-120:NaN;return new Xe(s<0?s+360:s,u,o,t.opacity)}(t):new Xe(t,e,n,null==r?1:r)},ae(ie,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Xe(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Xe(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Te,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),o=Math.sin(t);return new Me(255*(e+n*(Pe*r+qe*o)),255*(e+n*(Be*r+We*o)),255*(e+n*(Ze*r)),this.opacity)}}));var nn=function t(e){var n=tn(e);function r(t,e){var r=n((t=Ce(t)).r,(e=Ce(e)).r),o=n(t.g,e.g),a=n(t.b,e.b),i=en(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=o(e),t.b=a(e),t.opacity=i(e),t+""}}return r.gamma=t,r}(1);function rn(t,e){return e-=t=+t,function(n){return t+e*n}}var on=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,an=new RegExp(on.source,"g");function un(t,e){var n,r=typeof e;return null==e||"boolean"===r?Ke(e):("number"===r?rn:"string"===r?(n=_e(e))?(e=n,nn):function(t,e){var n,r,o,a=on.lastIndex=an.lastIndex=0,i=-1,u=[],s=[];for(t+="",e+="";(n=on.exec(t))&&(r=an.exec(e));)(o=r.index)>a&&(o=e.slice(a,o),u[i]?u[i]+=o:u[++i]=o),(n=n[0])===(r=r[0])?u[i]?u[i]+=r:u[++i]=r:(u[++i]=null,s.push({i:i,x:rn(n,r)})),a=an.lastIndex;return a<e.length&&(o=e.slice(a),u[i]?u[i]+=o:u[++i]=o),u.length<2?s[0]?function(t){return function(e){return t(e)+""}}(s[0].x):function(t){return function(){return t}}(e):(e=s.length,function(t){for(var n,r=0;r<e;++r)u[(n=s[r]).i]=n.x(t);return u.join("")})}:e instanceof _e?nn:e instanceof Date?function(t,e){var n=new Date;return e-=t=+t,function(r){return n.setTime(t+e*r),n}}:Array.isArray(e)?function(t,e){var n,r=e?e.length:0,o=t?Math.min(r,t.length):0,a=new Array(o),i=new Array(r);for(n=0;n<o;++n)a[n]=un(t[n],e[n]);for(;n<r;++n)i[n]=e[n];return function(t){for(n=0;n<o;++n)i[n]=a[n](t);return i}}:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?function(t,e){var n,r={},o={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=un(t[n],e[n]):o[n]=e[n];return function(t){for(n in r)o[n]=r[n](t);return o}}:rn)(t,e)}function sn(t,e){return e-=t=+t,function(n){return Math.round(t+e*n)}}Math.PI,Math.SQRT2;function ln(t){return+t}var cn,fn=[0,1];function hn(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=e,function(){return n});var n}function mn(t,e,n,r){var o=t[0],a=t[1],i=e[0],u=e[1];return a<o?(o=n(a,o),i=r(u,i)):(o=n(o,a),i=r(i,u)),function(t){return i(o(t))}}function dn(t,e,n,r){var o=Math.min(t.length,e.length)-1,a=new Array(o),i=new Array(o),u=-1;for(t[o]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++u<o;)a[u]=n(t[u],t[u+1]),i[u]=r(e[u],e[u+1]);return function(e){var n=Ut(t,e,1,o)-1;return i[n](a[n](e))}}function pn(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function vn(t){return(t=pn(Math.abs(t)))?t[1]:NaN}function gn(t,e){var n=pn(t,e);if(!n)return t+"";var r=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+new Array(o-r.length+2).join("0")}var bn={"":function(t,e){t=t.toPrecision(e);t:for(var n,r=t.length,o=1,a=-1;o<r;++o)switch(t[o]){case".":a=n=o;break;case"0":0===a&&(a=o),n=o;break;case"e":break t;default:a>0&&(a=0)}return a>0?t.slice(0,a)+t.slice(n+1):t},"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return gn(100*t,e)},r:gn,s:function(t,e){var n=pn(t,e);if(!n)return t+"";var r=n[0],o=n[1],a=o-(cn=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,i=r.length;return a===i?r:a>i?r+new Array(a-i+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+pn(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},_n=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;function yn(t){return new wn(t)}function wn(t){if(!(e=_n.exec(t)))throw new Error("invalid format: "+t);var e,n=e[1]||" ",r=e[2]||">",o=e[3]||"-",a=e[4]||"",i=!!e[5],u=e[6]&&+e[6],s=!!e[7],l=e[8]&&+e[8].slice(1),c=e[9]||"";"n"===c?(s=!0,c="g"):bn[c]||(c=""),(i||"0"===n&&"="===r)&&(i=!0,n="0",r="="),this.fill=n,this.align=r,this.sign=o,this.symbol=a,this.zero=i,this.width=u,this.comma=s,this.precision=l,this.type=c}function xn(t){return t}yn.prototype=wn.prototype,wn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var Cn,Mn,kn,Nn=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Sn(t){var e,n,r=t.grouping&&t.thousands?(e=t.grouping,n=t.thousands,function(t,r){for(var o=t.length,a=[],i=0,u=e[0],s=0;o>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),a.push(t.substring(o-=u,o+u)),!((s+=u+1)>r));)u=e[i=(i+1)%e.length];return a.reverse().join(n)}):xn,o=t.currency,a=t.decimal,i=t.numerals?function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(t.numerals):xn,u=t.percent||"%";function s(t){var e=(t=yn(t)).fill,n=t.align,s=t.sign,l=t.symbol,c=t.zero,f=t.width,h=t.comma,m=t.precision,d=t.type,p="$"===l?o[0]:"#"===l&&/[boxX]/.test(d)?"0"+d.toLowerCase():"",v="$"===l?o[1]:/[%p]/.test(d)?u:"",g=bn[d],b=!d||/[defgprs%]/.test(d);function _(t){var o,u,l,_=p,y=v;if("c"===d)y=g(t)+y,t="";else{var w=(t=+t)<0;if(t=g(Math.abs(t),m),w&&0==+t&&(w=!1),_=(w?"("===s?s:"-":"-"===s||"("===s?"":s)+_,y=("s"===d?Nn[8+cn/3]:"")+y+(w&&"("===s?")":""),b)for(o=-1,u=t.length;++o<u;)if(48>(l=t.charCodeAt(o))||l>57){y=(46===l?a+t.slice(o+1):t.slice(o))+y,t=t.slice(0,o);break}}h&&!c&&(t=r(t,1/0));var x=_.length+t.length+y.length,C=x<f?new Array(f-x+1).join(e):"";switch(h&&c&&(t=r(C+t,C.length?f-y.length:1/0),C=""),n){case"<":t=_+t+y+C;break;case"=":t=_+C+t+y;break;case"^":t=C.slice(0,x=C.length>>1)+_+t+y+C.slice(x);break;default:t=C+_+t+y}return i(t)}return m=null==m?d?6:12:/[gprs]/.test(d)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),_.toString=function(){return t+""},_}return{format:s,formatPrefix:function(t,e){var n=s(((t=yn(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(vn(e)/3))),o=Math.pow(10,-r),a=Nn[8+r/3];return function(t){return n(o*t)+a}}}}function Tn(t,e,n){var r,o=t[0],a=t[t.length-1],i=qt(o,a,null==e?10:e);switch((n=yn(null==n?",f":n)).type){case"s":var u=Math.max(Math.abs(o),Math.abs(a));return null!=n.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(vn(e)/3)))-vn(Math.abs(t)))}(i,u))||(n.precision=r),kn(n,u);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,vn(e)-vn(t))+1}(i,Math.max(Math.abs(o),Math.abs(a))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=function(t){return Math.max(0,-vn(Math.abs(t)))}(i))||(n.precision=r-2*("%"===n.type))}return Mn(n)}function Fn(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var r,o,a,i,u=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(o=t,t=e,e=o),0===(i=Pt(t,e,n))||!isFinite(i))return[];if(i>0)for(t=Math.ceil(t/i),e=Math.floor(e/i),a=new Array(o=Math.ceil(e-t+1));++u<o;)a[u]=(t+u)*i;else for(t=Math.floor(t*i),e=Math.ceil(e*i),a=new Array(o=Math.ceil(t-e+1));++u<o;)a[u]=(t-u)/i;return r&&a.reverse(),a}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){return Tn(e(),t,n)},t.nice=function(n){null==n&&(n=10);var r,o=e(),a=0,i=o.length-1,u=o[a],s=o[i];return s<u&&(r=u,u=s,s=r,r=a,a=i,i=r),(r=Pt(u,s,n))>0?r=Pt(u=Math.floor(u/r)*r,s=Math.ceil(s/r)*r,n):r<0&&(r=Pt(u=Math.ceil(u*r)/r,s=Math.floor(s*r)/r,n)),r>0?(o[a]=Math.floor(u/r)*r,o[i]=Math.ceil(s/r)*r,e(o)):r<0&&(o[a]=Math.ceil(u*r)/r,o[i]=Math.floor(s*r)/r,e(o)),t},t}function Rn(){var t=function(t,e){var n,r,o,a=fn,i=fn,u=un,s=!1;function l(){return n=Math.min(a.length,i.length)>2?dn:mn,r=o=null,c}function c(e){return(r||(r=n(a,i,s?function(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=e?0:t>=n?1:r(t)}}}(t):t,u)))(+e)}return c.invert=function(t){return(o||(o=n(i,a,hn,s?function(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=0?e:t>=1?n:r(t)}}}(e):e)))(+t)},c.domain=function(t){return arguments.length?(a=ne.call(t,ln),l()):a.slice()},c.range=function(t){return arguments.length?(i=re.call(t),l()):i.slice()},c.rangeRound=function(t){return i=re.call(t),u=sn,l()},c.clamp=function(t){return arguments.length?(s=!!t,l()):s},c.interpolate=function(t){return arguments.length?(u=t,l()):u},l()}(hn,rn);return t.copy=function(){return e=t,Rn().domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp());var e},Fn(t)}Cn=Sn({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),Mn=Cn.format,kn=Cn.formatPrefix;var Dn=new Date,Hn=new Date;function In(t,e,n,r){function o(e){return t(e=new Date(+e)),e}return o.floor=o,o.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},o.round=function(t){var e=o(t),n=o.ceil(t);return t-e<n-t?e:n},o.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},o.range=function(n,r,a){var i,u=[];if(n=o.ceil(n),a=null==a?1:Math.floor(a),!(n<r&&a>0))return u;do{u.push(i=new Date(+n)),e(n,a),t(n)}while(i<n&&n<r);return u},o.filter=function(n){return In(function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););})},n&&(o.count=function(e,r){return Dn.setTime(+e),Hn.setTime(+r),t(Dn),t(Hn),Math.floor(n(Dn,Hn))},o.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?o.filter(r?function(e){return r(e)%t==0}:function(e){return o.count(0,e)%t==0}):o:null}),o}var An=In(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});An.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?In(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):An:null};var Un=6e4,Ln=6048e5,En=(In(function(t){t.setTime(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3},function(t){return t.getUTCSeconds()}),In(function(t){t.setTime(Math.floor(t/Un)*Un)},function(t,e){t.setTime(+t+e*Un)},function(t,e){return(e-t)/Un},function(t){return t.getMinutes()}),In(function(t){var e=t.getTimezoneOffset()*Un%36e5;e<0&&(e+=36e5),t.setTime(36e5*Math.floor((+t-e)/36e5)+e)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getHours()}),In(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Un)/864e5},function(t){return t.getDate()-1}));function $n(t){return In(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Un)/Ln})}var On=$n(0),jn=$n(1),Vn=($n(2),$n(3),$n(4)),Yn=($n(5),$n(6),In(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()}),In(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()}));Yn.every=function(t){return isFinite(t=Math.floor(t))&&t>0?In(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};In(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*Un)},function(t,e){return(e-t)/Un},function(t){return t.getUTCMinutes()}),In(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getUTCHours()});var zn=In(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5},function(t){return t.getUTCDate()-1});function Pn(t){return In(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/Ln})}var qn=Pn(0),Bn=Pn(1),Wn=(Pn(2),Pn(3),Pn(4)),Zn=(Pn(5),Pn(6),In(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}),In(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()}));function Jn(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Gn(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Qn(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}Zn.every=function(t){return isFinite(t=Math.floor(t))&&t>0?In(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};var Xn,Kn,tr,er={"-":"",_:" ",0:"0"},nr=/^\s*\d+/,rr=/^%/,or=/[\\^$*+?|[\]().{}]/g;function ar(t,e,n){var r=t<0?"-":"",o=(r?-t:t)+"",a=o.length;return r+(a<n?new Array(n-a+1).join(e)+o:o)}function ir(t){return t.replace(or,"\\$&")}function ur(t){return new RegExp("^(?:"+t.map(ir).join("|")+")","i")}function sr(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function lr(t,e,n){var r=nr.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function cr(t,e,n){var r=nr.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function fr(t,e,n){var r=nr.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function hr(t,e,n){var r=nr.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function mr(t,e,n){var r=nr.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function dr(t,e,n){var r=nr.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function pr(t,e,n){var r=nr.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function vr(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function gr(t,e,n){var r=nr.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function br(t,e,n){var r=nr.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function _r(t,e,n){var r=nr.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function yr(t,e,n){var r=nr.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function wr(t,e,n){var r=nr.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function xr(t,e,n){var r=nr.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Cr(t,e,n){var r=nr.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Mr(t,e,n){var r=nr.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function kr(t,e,n){var r=rr.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Nr(t,e,n){var r=nr.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Sr(t,e,n){var r=nr.exec(e.slice(n));return r?(t.Q=1e3*+r[0],n+r[0].length):-1}function Tr(t,e){return ar(t.getDate(),e,2)}function Fr(t,e){return ar(t.getHours(),e,2)}function Rr(t,e){return ar(t.getHours()%12||12,e,2)}function Dr(t,e){return ar(1+En.count(Yn(t),t),e,3)}function Hr(t,e){return ar(t.getMilliseconds(),e,3)}function Ir(t,e){return Hr(t,e)+"000"}function Ar(t,e){return ar(t.getMonth()+1,e,2)}function Ur(t,e){return ar(t.getMinutes(),e,2)}function Lr(t,e){return ar(t.getSeconds(),e,2)}function Er(t){var e=t.getDay();return 0===e?7:e}function $r(t,e){return ar(On.count(Yn(t),t),e,2)}function Or(t,e){var n=t.getDay();return t=n>=4||0===n?Vn(t):Vn.ceil(t),ar(Vn.count(Yn(t),t)+(4===Yn(t).getDay()),e,2)}function jr(t){return t.getDay()}function Vr(t,e){return ar(jn.count(Yn(t),t),e,2)}function Yr(t,e){return ar(t.getFullYear()%100,e,2)}function zr(t,e){return ar(t.getFullYear()%1e4,e,4)}function Pr(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+ar(e/60|0,"0",2)+ar(e%60,"0",2)}function qr(t,e){return ar(t.getUTCDate(),e,2)}function Br(t,e){return ar(t.getUTCHours(),e,2)}function Wr(t,e){return ar(t.getUTCHours()%12||12,e,2)}function Zr(t,e){return ar(1+zn.count(Zn(t),t),e,3)}function Jr(t,e){return ar(t.getUTCMilliseconds(),e,3)}function Gr(t,e){return Jr(t,e)+"000"}function Qr(t,e){return ar(t.getUTCMonth()+1,e,2)}function Xr(t,e){return ar(t.getUTCMinutes(),e,2)}function Kr(t,e){return ar(t.getUTCSeconds(),e,2)}function to(t){var e=t.getUTCDay();return 0===e?7:e}function eo(t,e){return ar(qn.count(Zn(t),t),e,2)}function no(t,e){var n=t.getUTCDay();return t=n>=4||0===n?Wn(t):Wn.ceil(t),ar(Wn.count(Zn(t),t)+(4===Zn(t).getUTCDay()),e,2)}function ro(t){return t.getUTCDay()}function oo(t,e){return ar(Bn.count(Zn(t),t),e,2)}function ao(t,e){return ar(t.getUTCFullYear()%100,e,2)}function io(t,e){return ar(t.getUTCFullYear()%1e4,e,4)}function uo(){return"+0000"}function so(){return"%"}function lo(t){return+t}function co(t){return Math.floor(+t/1e3)}!function(t){Xn=function(t){var e=t.dateTime,n=t.date,r=t.time,o=t.periods,a=t.days,i=t.shortDays,u=t.months,s=t.shortMonths,l=ur(o),c=sr(o),f=ur(a),h=sr(a),m=ur(i),d=sr(i),p=ur(u),v=sr(u),g=ur(s),b=sr(s),_={a:function(t){return i[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return s[t.getMonth()]},B:function(t){return u[t.getMonth()]},c:null,d:Tr,e:Tr,f:Ir,H:Fr,I:Rr,j:Dr,L:Hr,m:Ar,M:Ur,p:function(t){return o[+(t.getHours()>=12)]},Q:lo,s:co,S:Lr,u:Er,U:$r,V:Or,w:jr,W:Vr,x:null,X:null,y:Yr,Y:zr,Z:Pr,"%":so},y={a:function(t){return i[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return s[t.getUTCMonth()]},B:function(t){return u[t.getUTCMonth()]},c:null,d:qr,e:qr,f:Gr,H:Br,I:Wr,j:Zr,L:Jr,m:Qr,M:Xr,p:function(t){return o[+(t.getUTCHours()>=12)]},Q:lo,s:co,S:Kr,u:to,U:eo,V:no,w:ro,W:oo,x:null,X:null,y:ao,Y:io,Z:uo,"%":so},w={a:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.w=d[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=h[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=b[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=p.exec(e.slice(n));return r?(t.m=v[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return M(t,e,n,r)},d:br,e:br,f:Mr,H:yr,I:yr,j:_r,L:Cr,m:gr,M:wr,p:function(t,e,n){var r=l.exec(e.slice(n));return r?(t.p=c[r[0].toLowerCase()],n+r[0].length):-1},Q:Nr,s:Sr,S:xr,u:cr,U:fr,V:hr,w:lr,W:mr,x:function(t,e,r){return M(t,n,e,r)},X:function(t,e,n){return M(t,r,e,n)},y:pr,Y:dr,Z:vr,"%":kr};function x(t,e){return function(n){var r,o,a,i=[],u=-1,s=0,l=t.length;for(n instanceof Date||(n=new Date(+n));++u<l;)37===t.charCodeAt(u)&&(i.push(t.slice(s,u)),null!=(o=er[r=t.charAt(++u)])?r=t.charAt(++u):o="e"===r?" ":"0",(a=e[r])&&(r=a(n,o)),i.push(r),s=u+1);return i.push(t.slice(s,u)),i.join("")}}function C(t,e){return function(n){var r,o,a=Qn(1900);if(M(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("p"in a&&(a.H=a.H%12+12*a.p),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(r=(o=(r=Gn(Qn(a.y))).getUTCDay())>4||0===o?Bn.ceil(r):Bn(r),r=zn.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(r=(o=(r=e(Qn(a.y))).getDay())>4||0===o?jn.ceil(r):jn(r),r=En.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),o="Z"in a?Gn(Qn(a.y)).getUTCDay():e(Qn(a.y)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(o+5)%7:a.w+7*a.U-(o+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,Gn(a)):e(a)}}function M(t,e,n,r){for(var o,a,i=0,u=e.length,s=n.length;i<u;){if(r>=s)return-1;if(37===(o=e.charCodeAt(i++))){if(o=e.charAt(i++),!(a=w[o in er?e.charAt(i++):o])||(r=a(t,n,r))<0)return-1}else if(o!=n.charCodeAt(r++))return-1}return r}return _.x=x(n,_),_.X=x(r,_),_.c=x(e,_),y.x=x(n,y),y.X=x(r,y),y.c=x(e,y),{format:function(t){var e=x(t+="",_);return e.toString=function(){return t},e},parse:function(t){var e=C(t+="",Jn);return e.toString=function(){return t},e},utcFormat:function(t){var e=x(t+="",y);return e.toString=function(){return t},e},utcParse:function(t){var e=C(t,Gn);return e.toString=function(){return t},e}}}(t),Xn.format,Xn.parse,Kn=Xn.utcFormat,tr=Xn.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Date.prototype.toISOString||Kn("%Y-%m-%dT%H:%M:%S.%LZ");+new Date("2000-01-01T00:00:00.000Z")||tr("%Y-%m-%dT%H:%M:%S.%LZ");var fo=Rn(),ho=Rn();function mo(t){return t?t<.01?"<1%":(100*t).toFixed(0)+"%":"0%"}var po={show:function(t){console.log("sss",t),this.set({highlight:t})},resize:function(){var t=this.refs.svg.getBoundingClientRect();this.set({width:t.right-t.left,height:t.bottom-t.top})}};function vo(t,e){var n,r,o,a,i,s=e.tick,h=(e.tick_index,s.label);return{c:function(){n=p("g"),r=p("line"),o=p("text"),a=v(h),this.h()},h:function(){y(r,"y2","3"),y(r,"class","svelte-8c61je"),y(o,"y","5"),y(o,"class","svelte-8c61je"),y(n,"class","tick svelte-8c61je"),y(n,"transform",i="translate("+e.xScale(s.x)+",0)")},m:function(t,e){c(n,t,e),l(r,n),l(o,n),l(a,o)},p:function(t,e){s=e.tick,e.tick_index,t.ticks&&h!==(h=s.label)&&(a.data=h),(t.xScale||t.ticks)&&i!==(i="translate("+e.xScale(s.x)+",0)")&&y(n,"transform",i)},u:function(){f(n)},d:u}}function go(t,e){var n,r;return{c:function(){n=p("polygon"),this.h()},h:function(){y(n,"transform",r="translate("+e.xScale(e.highlight.x)+",0)"),y(n,"points","0,0,4,6,-4,6")},m:function(t,e){c(n,t,e)},p:function(t,e){(t.xScale||t.highlight)&&r!==(r="translate("+e.xScale(e.highlight.x)+",0)")&&y(n,"transform",r)},u:function(){f(n)},d:u}}function bo(t,e){var n,r,o,a,i,s,h,m=e.bin,d=(e.i,"$1 Werte ($2) sind zwischen $3 und $4".replace("$1",m.length).replace("$2",mo(m.length/e.validValues.length)).replace("$3",m.x0).replace("$4",m.x1));return{c:function(){n=p("g"),r=p("title"),o=v(d),a=p("rect"),this.h()},h:function(){y(a,"x","1"),y(a,"width",i=e.xScale(m.x1)-e.xScale(m.x0)-1),y(a,"height",s=e.innerHeight-e.yScale(m.length)),y(a,"class","svelte-8c61je"),y(n,"class","bar"),y(n,"transform",h="translate("+e.xScale(m.x0)+","+e.yScale(m.length)+")")},m:function(t,e){c(n,t,e),l(r,n),l(o,r),l(a,n)},p:function(t,e){m=e.bin,e.i,(t.bins||t.validValues)&&d!==(d="$1 Werte ($2) sind zwischen $3 und $4".replace("$1",m.length).replace("$2",mo(m.length/e.validValues.length)).replace("$3",m.x0).replace("$4",m.x1))&&(o.data=d),(t.xScale||t.bins)&&i!==(i=e.xScale(m.x1)-e.xScale(m.x0)-1)&&y(a,"width",i),(t.innerHeight||t.yScale||t.bins)&&s!==(s=e.innerHeight-e.yScale(m.length))&&y(a,"height",s),(t.xScale||t.bins||t.yScale)&&h!==(h="translate("+e.xScale(m.x0)+","+e.yScale(m.length)+")")&&y(n,"transform",h)},u:function(){f(n)},d:u}}function _o(t,e){var n,r,o,a,i,u=e.s,s=(e.s_index,u.name),h=u.label;return{c:function(){n=d("li"),r=v(s),o=v(": "),a=d("tt"),i=v(h),this.h()},h:function(){a.className="svelte-8c61je",b(a,"mouseleave",yo),b(a,"mouseenter",wo),a._svelte={component:t,stats:e.stats,s_index:e.s_index},n.className="svelte-8c61je"},m:function(t,e){c(n,t,e),l(r,n),l(o,n),l(a,n),l(i,a)},p:function(t,e){u=e.s,e.s_index,t.stats&&s!==(s=u.name)&&(r.data=s),t.stats&&h!==(h=u.label)&&(i.data=h),a._svelte.stats=e.stats,a._svelte.s_index=e.s_index},u:function(){f(n)},d:function(){_(a,"mouseleave",yo),_(a,"mouseenter",wo)}}}function yo(t){this._svelte.component.show(!1)}function wo(t){var e=this._svelte.component,n=this._svelte.stats[this._svelte.s_index];e.show(n)}function xo(t){R(this,t),this.refs={},this._state=s({format:function(t){return t},t:0,padding:{top:10,right:65,bottom:20,left:5},height:200,width:500,values:[],highlight:!1},t.data),this._recompute({values:1,validValues:1,format:1,width:1,padding:1,innerWidth:1,xScale:1,height:1,innerHeight:1,bins:1},this._state);var e=function(){this.resize(),this.observe("highlight",function(t){console.log("hl",t)})}.bind(this);t.root||(this._oncreate=[]),this._fragment=function(t,e){for(var n,r,o,a,i,u,h,b,_,x,C,M,k,N,S,T,F,R,D,H,I=mo(e.NAs/e.values.length),A=e.ticks,U=[],L=0;L<A.length;L+=1)U[L]=vo(0,s({},e,{ticks:A,tick:A[L],tick_index:L}));var E=e.highlight&&go(0,e),$=e.bins,O=[];for(L=0;L<$.length;L+=1)O[L]=bo(0,s({},e,{bins:$,bin:$[L],i:L}));var j=e.stats,V=[];for(L=0;L<j.length;L+=1)V[L]=_o(t,s({},e,{stats:j,s:j[L],s_index:L}));return{c:function(){n=d("h3"),r=v("Werteverteilung (Histogramm)"),o=v("\n"),a=p("svg"),i=p("g"),u=p("g");for(var t=0;t<U.length;t+=1)U[t].c();for(h=g(),E&&E.c(),_=p("g"),t=0;t<O.length;t+=1)O[t].c();for(C=v("\n"),M=d("ul"),t=0;t<V.length;t+=1)V[t].c();k=d("li"),N=v("Ungültig"),S=v(": "),T=d("tt"),F=v(e.NAs),R=v(" ("),D=v(I),H=v(")"),this.h()},h:function(){n.className="svelte-8c61je",y(u,"class","axis x-axis svelte-8c61je"),y(u,"transform",b="translate(0, "+e.innerHeight+")"),y(_,"class","bars svelte-8c61je"),y(i,"transform",x="translate("+[e.padding.left,e.padding.top]+")"),y(a,"class","svelte-8c61je"),w(T,"color","#c71e1d"),T.className="svelte-8c61je",k.className="svelte-8c61je",M.className="svelte-8c61je"},m:function(e,s){c(n,e,s),l(r,n),c(o,e,s),c(a,e,s),l(i,a),l(u,i);for(var f=0;f<U.length;f+=1)U[f].m(u,null);for(l(h,u),E&&E.m(u,null),l(_,i),f=0;f<O.length;f+=1)O[f].m(_,null);for(t.refs.svg=a,c(C,e,s),c(M,e,s),f=0;f<V.length;f+=1)V[f].m(M,null);l(k,M),l(N,k),l(S,k),l(T,k),l(F,T),l(R,k),l(D,k),l(H,k)},p:function(e,n){var r=n.ticks;if(e.xScale||e.ticks){for(var o=0;o<r.length;o+=1){var a=s({},n,{ticks:r,tick:r[o],tick_index:o});U[o]?U[o].p(e,a):(U[o]=vo(0,a),U[o].c(),U[o].m(u,h))}for(;o<U.length;o+=1)U[o].u(),U[o].d();U.length=r.length}n.highlight?E?E.p(e,n):((E=go(0,n)).c(),E.m(u,null)):E&&(E.u(),E.d(),E=null),e.innerHeight&&b!==(b="translate(0, "+n.innerHeight+")")&&y(u,"transform",b);var l=n.bins;if(e.xScale||e.bins||e.yScale||e.validValues||e.innerHeight){for(o=0;o<l.length;o+=1){var c=s({},n,{bins:l,bin:l[o],i:o});O[o]?O[o].p(e,c):(O[o]=bo(0,c),O[o].c(),O[o].m(_,null))}for(;o<O.length;o+=1)O[o].u(),O[o].d();O.length=l.length}e.padding&&x!==(x="translate("+[n.padding.left,n.padding.top]+")")&&y(i,"transform",x);var f=n.stats;if(e.stats){for(o=0;o<f.length;o+=1){var m=s({},n,{stats:f,s:f[o],s_index:o});V[o]?V[o].p(e,m):(V[o]=_o(t,m),V[o].c(),V[o].m(M,k))}for(;o<V.length;o+=1)V[o].u(),V[o].d();V.length=f.length}e.NAs&&(F.data=n.NAs),(e.NAs||e.values)&&I!==(I=mo(n.NAs/n.values.length))&&(D.data=I)},u:function(){f(n),f(o),f(a);for(var t=0;t<U.length;t+=1)U[t].u();for(E&&E.u(),t=0;t<O.length;t+=1)O[t].u();for(f(C),f(M),t=0;t<V.length;t+=1)V[t].u()},d:function(){m(U),E&&E.d(),m(O),t.refs.svg===a&&(t.refs.svg=null),m(V)}}}(this,this._state),this.root._oncreate.push(e),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),H(this._oncreate))}s(xo.prototype,po,A),xo.prototype._recompute=function(t,e){var n,r;t.values&&(this._differs(e.NAs,e.NAs=e.values.filter(function(t){return"string"==typeof t||Number.isNaN(t)}).length)&&(t.NAs=!0),this._differs(e.validValues,e.validValues=function(t){return t.filter(function(t){return"number"==typeof t&&!Number.isNaN(t)})}(e.values))&&(t.validValues=!0)),(t.validValues||t.format)&&this._differs(e.stats,e.stats=function(t,e){var n=function(t,e){var n,r,o=t.length,a=-1;if(null==e){for(;++a<o;)if(null!=(n=t[a])&&n>=n)for(r=n;++a<o;)null!=(n=t[a])&&r>n&&(r=n)}else for(;++a<o;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=n;++a<o;)null!=(n=e(t[a],a,t))&&r>n&&(r=n);return r}(t),r=Zt(t),o=Jt(t),a=Gt(t);return[{x:n,label:e(n),name:"Min"},{x:r,label:e(r),name:"Max"},{x:o,label:e(o),name:"Mittelwert"},{x:a,label:e(a),name:"Median"}]}(e.validValues,e.format))&&(t.stats=!0),(t.width||t.padding)&&this._differs(e.innerWidth,e.innerWidth=(n=e.width,r=e.padding,n-r.left-r.right))&&(t.innerWidth=!0),(t.validValues||t.innerWidth)&&this._differs(e.xScale,e.xScale=function(t,e){return fo.domain(Et(t)).nice().range([0,e])}(e.validValues,e.innerWidth))&&(t.xScale=!0),(t.xScale||t.format)&&this._differs(e.ticks,e.ticks=function(t,e){return t.ticks(4).map(function(t){return{x:t,label:e(t)}})}(e.xScale,e.format))&&(t.ticks=!0),(t.xScale||t.validValues)&&this._differs(e.bins,e.bins=function(t,e){return Wt().domain(t.domain()).thresholds(t.ticks(14))(e)}(e.xScale,e.validValues))&&(t.bins=!0),(t.height||t.padding)&&this._differs(e.innerHeight,e.innerHeight=function(t,e){return t-e.bottom-e.top}(e.height,e.padding))&&(t.innerHeight=!0),(t.innerHeight||t.bins)&&this._differs(e.yScale,e.yScale=function(t,e){return ho.domain([0,Zt(e,function(t){return t.length})]).range([t,0])}(e.innerHeight,e.bins))&&(t.yScale=!0),(t.bins||t.xScale)&&this._differs(e.barWidth,e.barWidth=function(t,e){return e(t[0].x1)-e(t[0].x0)-1}(e.bins,e.xScale))&&(t.barWidth=!0),(t.validValues||t.format)&&(this._differs(e.mean,e.mean=function(t,e){var n=Jt(t);return{x:n,label:e(n)}}(e.validValues,e.format))&&(t.mean=!0),this._differs(e.median,e.median=(e.validValues,void e.format))&&(t.median=!0))};var Co=null;var Mo={render:function(){this.get("hot").render()},update:function(){var t=this,e=this.get(),n=e.data,r=e.transpose,o=e.firstRowIsHeader,a=e.skipRows,u=e.hot;if(n){var s=this.store.get("dw_chart"),l=s.dataset(dw.datasource.delimited({csv:n,transpose:r,firstRowIsHeader:o,skipRows:a}).parse()).dataset();this.set({columnOrder:l.columnOrder()});var c=[[]];l.eachColumn(function(t){return c[0].push(t.title())}),l.eachRow(function(t){var e=[];l.eachColumn(function(n){return e.push(n.raw(t))}),c.push(e)}),u.loadData(c);var f=ko(this,l,i);u.updateSettings({cells:function(e,n){return{readOnly:t.get().readonly||l.hasColumn(n)&&l.column(n).isComputed&&0===e,renderer:f}},manualColumnMove:[]}),this.set({ds:l}),this.set({has_changes:s.get("metadata.data.changes",[]).length>0}),i.hooks.once("afterRender",function(){return t.initCustomEvents()}),u.render()}},dataChanged:function(t){var e=this,n=this.get().hot,r=!1;t.forEach(function(t){var o=t[0],a=t[1],i=t[2],u=t[3];if(i!=u){var s=e.store.get("dw_chart"),l=e.get().transpose,c=s.get("metadata.data.changes",[]);if(o=n.toPhysicalRow(o),a=s.dataset().columnOrder()[a],l){var f=o;o=a,a=f}c.push({column:a,row:o,value:u,time:(new Date).getTime()}),s.set("metadata.data.changes",c),r=!0}}),r&&setTimeout(function(){e.update(),chart.save()},100)},columnMoved:function(t,e){var n=this,r=this.get().hot;if(t.length){var o=this.get().columnOrder,a=o.slice(0),u=o[e],s=a.splice(t[0],t.length),l=void 0===u?a.length:u?a.indexOf(u):0;a.splice.apply(a,[l,0].concat(s)),this.store.get("dw_chart").set("metadata.data.column-order",a.slice(0)),this.set({columnOrder:a}),i.hooks.once("afterRender",function(){setTimeout(function(){n.fire("resetSort"),r.selectCell(0,l,r.countRows()-1,l+s.length-1)},10)}),this.update()}},updateHeight:function(){var t=document.querySelector(".ht_master.handsontable .wtHolder .wtHider").getBoundingClientRect().height;this.refs.hot.style.height=Math.min(500,t+10)+"px"},checkRange:function(t,e,n,r){var o=this.get().hot,a=this.get().ds;this.refs;if(e!=r||0!==t||n!=o.countRows()-1)if(e==r||0!==t||n!=o.countRows()-1)this.set({activeColumn:null,multiSelection:!1});else{for(var i=[],u=Math.min(e,r);u<=Math.max(e,r);u++)i.push(+document.querySelector("#data-preview .htCore tbody tr:first-child td:nth-child("+(u+2)+")").dataset.column);this.set({multiSelection:i.map(function(t){return a.column(t)}),activeColumn:null})}},initCustomEvents:function(){var t=this;setTimeout(function(){t.refs.hot.querySelectorAll(".htCore thead th:first-child").forEach(function(t){t.removeEventListener("click",No),t.addEventListener("click",No)}),t.refs.hot.querySelectorAll(".htCore thead th+th").forEach(function(t){t.removeEventListener("click",So),t.addEventListener("click",So)})},500)},getColumnFormat:function(t){return this.store.get("dw_chart").get("metadata.data.column-format",{})[t]||{type:"auto",ignore:!1}}};function ko(t,e,n){var r={date:"fa fa-clock-o"};return function(o,a,i,u,s,l,c){if(!(e.numColumns()<=u)&&e.hasColumn(u)){var f=e.column(u),h=t.get(),m=h.searchResults,d=h.currentResult,p=h.activeColumn,v=t.getColumnFormat(f.name());if((i=o.toPhysicalRow(i))>0)l=chart.columnFormatter(f)(f.val(i-1),!0);parseInt(l)<0&&a.classList.add("negative"),a.classList.add(f.type()+"Type"),a.dataset.column=u,"text"==f.type()&&l&&l.length>70&&(l=l.substr(0,60)+"…"),0===i?(a.classList.add("firstRow"),r[f.type()]&&(l='<i class="'+r[f.type()]+'"></i> '+l)):a.classList.add(i%2?"oddRow":"evenRow"),v.ignore&&a.classList.add("ignored"),p&&p.name()==f.name()&&a.classList.add("active");var g=o.getPlugin("columnSorting").untranslateRow(i);m.forEach(function(t){t.row==g&&t.col==u&&a.classList.add("htSearchResult")}),d&&d.row==g&&d.col==u&&a.classList.add("htCurrentSearchResult"),i>0&&!f.type(!0).isValid(f.val(i-1))&&a.classList.add("parsingError"),c.readOnly&&a.classList.add("readOnly"),chart.dataCellChanged(u,i)&&a.classList.add("changed"),function(t,e,r,o,a,i,u){var s=dw.utils.purifyHtml(n.helper.stringify(i));e.innerHTML=s}(0,a,0,0,0,l)}}}function No(t){t.preventDefault();var e=Co.get().transpose;Co.set({transpose:!e}),Co.update()}function So(t){for(var e=this.parentNode.children.length,n=-1,r=0;r<e;r++)if(this.parentNode.children.item(r)==this){n=r;break}var o=+Co.refs.hot.querySelector(".htCore tbody tr:first-child td:nth-child("+(n+1)+")").dataset.column,a=Co.store.get("dw_chart"),i=Co.get(),u=i.activeColumn,s=i.hot;if(a.dataset().hasColumn(o)){var l=a.dataset().column(+o);u&&u.name()==l.name()?(t.target.parentNode.classList.remove("selected"),Co.set({activeColumn:!1}),s.deselectCell()):(t.target.parentNode.classList.add("selected"),Co.set({activeColumn:l}))}}function To(t){R(this,t),this.refs={},this._state=s({data:"",readonly:!1,skipRows:0,firstRowIsHeader:!0,searchIndex:0,sortBy:"-",transpose:!1,activeColumn:null,search:"",searchResults:[]},t.data),this._recompute({searchResults:1,searchIndex:1},this._state);var e,n,r=function(){var t=this;Co=this,i.hooks.once("afterRender",function(){return t.initCustomEvents()}),window.addEventListener("keyup",function(e){var n=t.get(),r=n.activeColumn,o=n.ds;if(r&&("ArrowRight"==e.key||"ArrowLeft"==e.key)){e.preventDefault(),e.stopPropagation();var a=o.indexOf(r.name());"ArrowRight"==e.key?t.set({activeColumn:o.column((a+1)%o.numColumns())}):t.set({activeColumn:o.column((a-1+o.numColumns())%o.numColumns())})}});var e=this.store.get("dw_chart"),n=new i(this.refs.hot,{data:[],rowHeaders:function(t){return n.getPlugin("ColumnSorting").translateRow(t)+1},colHeaders:!0,fixedRowsTop:1,filters:!0,dropdownMenu:!0,startRows:13,startCols:8,fillHandle:!1,stretchH:"all",height:500,manualColumnMove:!0,selectionMode:"range",autoColumnSize:{useHeaders:!0,syncLimit:5},columnSorting:!0,sortIndicator:!0,sortFunction:function(t,r){if(r.col>-1){var o=e.dataset().column(r.col),a=o.type(),i=n.getPlugin("columnSorting");return function(e,n){var u;if(0===e[0])return-1;switch(e[1]=o.val(e[0]-1),n[1]=o.val(n[0]-1),"number"==a&&(isNaN(e[1])&&(e[1]=t?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY),isNaN(n[1])&&(n[1]=t?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY)),"date"==a&&("string"==typeof e[1]&&(e[1]=new Date(110,0,1)),"string"==typeof n[1]&&(n[1]=new Date(110,0,1))),a){case"date":u=i.dateSort;break;case"number":u=i.numericSort;break;default:u=i.defaultSort}return u(t,r)(e,n)}}return function(t,e){return t[0]-e[0]}},afterGetColHeader:function(e,n){var r=t.get(),o=r.activeColumn,a=r.ds;a&&a.hasColumn(e)&&((0===e||e)&&o&&a.column(e).name()==o.name()&&n.classList.add("selected"),(0===e||e)&&(t.getColumnFormat(a.column(e).name()).ignore?n.classList.add("ignored"):n.classList.remove("ignored")))},search:"search"});window.HT=n,this.set({hot:n}),i.hooks.add("afterSetDataAtCell",function(e){return t.dataChanged(e)}),i.hooks.add("afterColumnMove",function(e,n){return t.columnMoved(e,n)}),i.hooks.add("afterRender",function(){return t.updateHeight()}),i.hooks.add("afterSelection",function(e,n,r,o){return t.checkRange(e,n,r,o)}),this.observe("data",function(){return t.update()}),this.observe("firstRowIsHeader",function(e,n){e!=n&&void 0!==n&&t.update()}),this.observe("search",function(e,r){e!=r&&t.set({searchIndex:0});var o=n.search.query(e);t.set({searchResults:o}),n.render()}),this.observe("currentResult",function(t){t&&n&&(n.render(),n.scrollViewportTo(t.row,t.col),setTimeout(function(){n.scrollViewportTo(t.row,t.col)},100))}),this.observe("activeColumn",function(){setTimeout(function(){return n.render()},10)}),this.observe("sorting",function(t){n.sort(e.dataset().indexOf(t.sortBy),t.sortDir)})}.bind(this);t.root||(this._oncreate=[]),this._fragment=(e=this,this._state,{c:function(){n=d("div"),this.h()},h:function(){n.id="data-preview"},m:function(t,r){c(n,t,r),e.refs.hot=n},p:u,u:function(){f(n)},d:function(){e.refs.hot===n&&(e.refs.hot=null)}}),this.root._oncreate.push(r),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),H(this._oncreate))}s(To.prototype,Mo,A),To.prototype._recompute=function(t,e){(t.searchResults||t.searchIndex)&&this._differs(e.currentResult,e.currentResult=function(t,e){if(!t||!t.length)return null;var n=t.length;if(e<0||e>=n){for(;e<0;)e+=n;e>n&&(e%=n)}return t[e]}(e.searchResults,e.searchIndex))&&(t.currentResult=!0)};var Fo={nextResult:function(t){var e=this.get(),n=e.searchIndex,r=e.searchResults;(n+=t)<0&&(n+=r.length),n%=r.length,this.set({searchIndex:n})},keyPress:function(t){"F3"!=t.key&&"Enter"!=t.key||this.nextResult(t.shiftKey?-1:1)},toggleTranspose:function(){var t=this;this.set({activeColumn:!1}),this.set({transpose:!this.get("transpose")}),setTimeout(function(){return t.refs.hot.update()},500)},revertChanges:function(){var t=this.store.get("dw_chart");t.set("metadata.data.changes",[]),t.saveSoon(),this.refs.hot.update()},cmFocus:function(){var t=this;setTimeout(function(){t.refs.hot.get("hot").render()},100)},addComputedColumn:function(){for(var t=this.store.get("dw_chart"),e=t.dataset(),n=Tt(t.get("metadata.describe.computed-columns",{})),r=1;e.hasColumn("Column "+r);)r++;var o="Column "+r;n[o]="",t.set("metadata.describe.computed-columns",n),t.saveSoon();var a=t.dataset(!0);this.refs.hot.update(),this.set({activeColumn:a.column(o)})},sort:function(t,e,n){t.preventDefault(),t.stopPropagation(),this.set({sortBy:e,sortDir:n}),this.refs.sortDropdownGroup.classList.remove("open")},force:function(t,e){void 0===e&&(e=!0),t.preventDefault(),this.set({forceColumnFormat:e})},hideMultiple:function(t,e){var n=this,r=this.store.get("dw_chart"),o=r.get("metadata.data.column-format",{});t.forEach(function(t){o[t.name()]?o[t.name()].ignore=e:o[t.name()]={type:"auto",ignore:e}}),r.set("metadata.data.column-format",o),r.saveSoon(),setTimeout(function(){n.refs.hot.get("hot").render()},10),this.set({multiSelection:!1})}};function Ro(t,e){var n,r,o,a;function i(e){t.force(e,!1)}return{c:function(){n=d("button"),r=d("i"),o=v(" "),a=v("Zurück zum Formel-Editor"),this.h()},h:function(){r.className="fa  fa-chevron-left",n.className="btn",b(n,"click",i)},m:function(t,e){c(n,t,e),l(r,n),l(o,n),l(a,n)},u:function(){f(n)},d:function(){_(n,"click",i)}}}function Do(t,e){var n,r,o,a={},i={};"customColumn"in e&&(i.column=e.customColumn,a.column=!0),"columns"in e&&(i.columns=e.columns,a.columns=!0);var u=new bt({root:t.root,data:i,_bind:function(e,n){t.get();var r={};!a.column&&e.column&&(r.customColumn=n.column),!a.columns&&e.columns&&(r.columns=n.columns),t._set(r),a={}}});function s(e){t.force(e,!0)}return t.root._beforecreate.push(function(){u._bind({column:1,columns:1},u.get())}),u.on("updateTable",function(e){t.refs.hot.update()}),u.on("renderTable",function(e){t.refs.hot.render()}),u.on("unselect",function(e){t.set({activeColumn:!1})}),{c:function(){u._fragment.c(),n=v("\n\n                "),r=d("button"),o=v("Spaltenformat anpassen"),this.h()},h:function(){r.className="btn",b(r,"click",s)},m:function(t,e){u._mount(t,e),c(n,t,e),c(r,t,e),l(o,r)},p:function(t,e){var n={};!a.column&&t.customColumn&&(n.column=e.customColumn,a.column=!0),!a.columns&&t.columns&&(n.columns=e.columns,a.columns=!0),u._set(n),a={}},u:function(){u._unmount(),f(n),f(r)},d:function(){u.destroy(!1),_(r,"click",s)}}}function Ho(t,e){var n,r,o={},a={};"columnFormat"in e&&(a.column=e.columnFormat,o.column=!0),"columns"in e&&(a.columns=e.columns,o.columns=!0);var i=new Dt({root:t.root,data:a,_bind:function(e,n){t.get();var r={};!o.column&&e.column&&(r.columnFormat=n.column),!o.columns&&e.columns&&(r.columns=n.columns),t._set(r),o={}}});t.root._beforecreate.push(function(){i._bind({column:1,columns:1},i.get())}),i.on("updateTable",function(e){t.refs.hot.update()}),i.on("renderTable",function(e){t.refs.hot.render()});var u=e.columnFormat.isComputed&&Ro(t);return{c:function(){i._fragment.c(),n=v("\n\n                    "),u&&u.c(),r=g()},m:function(t,e){i._mount(t,e),c(n,t,e),u&&u.m(t,e),c(r,t,e)},p:function(e,n){var a={};!o.column&&e.columnFormat&&(a.column=n.columnFormat,o.column=!0),!o.columns&&e.columns&&(a.columns=n.columns,o.columns=!0),i._set(a),o={},n.columnFormat.isComputed?u||((u=Ro(t)).c(),u.m(r.parentNode,r)):u&&(u.u(),u.d(),u=null)},u:function(){i._unmount(),f(n),u&&u.u(),f(r)},d:function(){i.destroy(!1),u&&u.d()}}}function Io(t,e){var n={},r={};"activeValues"in e&&(r.values=e.activeValues,n.values=!0),"activeFormat"in e&&(r.format=e.activeFormat,n.format=!0);var o=new xo({root:t.root,data:r,_bind:function(e,r){t.get();var o={};!n.values&&e.values&&(o.activeValues=r.values),!n.format&&e.format&&(o.activeFormat=r.format),t._set(o),n={}}});return t.root._beforecreate.push(function(){o._bind({values:1,format:1},o.get())}),{c:function(){o._fragment.c()},m:function(t,e){o._mount(t,e)},p:function(t,e){var r={};!n.values&&t.activeValues&&(r.values=e.activeValues,n.values=!0),!n.format&&t.activeFormat&&(r.format=e.activeFormat,n.format=!0),o._set(r),n={}},u:function(){o._unmount()},d:function(){o.destroy(!1)}}}function Ao(t,e){var n,r,o,a,i,s,h=e.locale,m=(e.locale_index,h.label),p=h.value;return{c:function(){n=d("option"),r=v(m),o=v(" ("),a=v(p),i=v(")"),this.h()},h:function(){n.__value=s=h.value,n.value=n.__value},m:function(t,e){c(n,t,e),l(r,n),l(o,n),l(a,n),l(i,n)},p:function(t,e){h=e.locale,e.locale_index,t.locales&&m!==(m=h.label)&&(r.data=m),t.locales&&p!==(p=h.value)&&(a.data=p),t.locales&&s!==(s=h.value)&&(n.__value=s),n.value=n.__value},u:function(){f(n)},d:u}}function Uo(t,e){var n,r;function o(t){return t.customColumn?Do:t.columnFormat?Ho:null}var a=o(e),i=a&&a(t,e),u="number"==e.activeColumn.type()&&Io(t,e);return{c:function(){i&&i.c(),n=v("\n\n                "),u&&u.c(),r=g()},m:function(t,e){i&&i.m(t,e),c(n,t,e),u&&u.m(t,e),c(r,t,e)},p:function(e,s){a===(a=o(s))&&i?i.p(e,s):(i&&(i.u(),i.d()),(i=a&&a(t,s))&&i.c(),i&&i.m(n.parentNode,n)),"number"==s.activeColumn.type()?u?u.p(e,s):((u=Io(t,s)).c(),u.m(r.parentNode,r)):u&&(u.u(),u.d(),u=null)},u:function(){i&&i.u(),f(n),u&&u.u(),f(r)},d:function(){i&&i.d(),u&&u.d()}}}function Lo(t,e){var n,r,o,a,i,s,h,m,p,g,y,x,C,M;function k(e){var n=t.get();t.hideMultiple(n.multiSelection,!1)}function N(e){var n=t.get();t.hideMultiple(n.multiSelection,!0)}return{c:function(){n=d("h3"),r=v("Spalten ein-/ausblenden"),o=v("\n\n                "),a=d("ul"),i=d("li"),s=d("button"),h=d("i"),m=v(" "),p=v("Ausgewählte Spalten einblenden"),g=d("li"),y=d("button"),x=d("i"),C=v(" "),M=v("Ausgewählte Spalten ausblenden"),this.h()},h:function(){n.className="first",h.className="fa fa-eye",s.className="btn",b(s,"click",k),w(i,"margin-bottom","5px"),x.className="fa fa-eye-slash",y.className="btn",b(y,"click",N),a.className="unstyled"},m:function(t,e){c(n,t,e),l(r,n),c(o,t,e),c(a,t,e),l(i,a),l(s,i),l(h,s),l(m,s),l(p,s),l(g,a),l(y,g),l(x,y),l(C,y),l(M,y)},p:u,u:function(){f(n),f(o),f(a)},d:function(){_(s,"click",k),_(y,"click",N)}}}function Eo(t,e){var n,r,o,a,i,u,h,p,g,y,w,M,k,N,S={},T=!1,F={label:"Erste Zeile als Beschriftung"};"firstRowIsHeader"in e&&(F.value=e.firstRowIsHeader,S.value=!0);var R=new _t({root:t.root,data:F,_bind:function(e,n){t.get();var r={};!S.value&&e.value&&(r.firstRowIsHeader=n.value),t._set(r),S={}}});t.root._beforecreate.push(function(){R._bind({value:1},R.get())});for(var D=e.locales,H=[],I=0;I<D.length;I+=1)H[I]=Ao(0,s({},e,{locales:D,locale:D[I],locale_index:I}));function A(){T=!0,t.set({locale:C(N)}),T=!1}return{c:function(){n=d("h3"),r=v("Überprüfe dass die Daten richtig aussehen"),o=v("\n\n                "),a=d("p"),i=v("Please make sure that Datawrapper interprets your data correctly. In the table columns should be shown in blue, dates in green and text in black."),u=v("\n\n                "),R._fragment.c(),h=v("\n\n                "),p=d("h4"),g=v("Ausgabe-Sprachraum"),y=v("\n\n                "),w=d("p"),M=v("Bestimmt Dezimal- und Tausendertrennzeichen sowie die Übersetzung von Monatsnamen und Wochentagen."),k=v("\n\n                "),N=d("select");for(var t=0;t<H.length;t+=1)H[t].c();this.h()},h:function(){n.className="first",b(N,"change",A),"locale"in e||t.root._beforecreate.push(A)},m:function(t,s){c(n,t,s),l(r,n),c(o,t,s),c(a,t,s),l(i,a),c(u,t,s),R._mount(t,s),c(h,t,s),c(p,t,s),l(g,p),c(y,t,s),c(w,t,s),l(M,w),c(k,t,s),c(N,t,s);for(var f=0;f<H.length;f+=1)H[f].m(N,null);x(N,e.locale)},p:function(t,e){var n={label:"Erste Zeile als Beschriftung"};!S.value&&t.firstRowIsHeader&&(n.value=e.firstRowIsHeader,S.value=!0),R._set(n),S={};var r=e.locales;if(t.locales){for(var o=0;o<r.length;o+=1){var a=s({},e,{locales:r,locale:r[o],locale_index:o});H[o]?H[o].p(t,a):(H[o]=Ao(0,a),H[o].c(),H[o].m(N,null))}for(;o<H.length;o+=1)H[o].u(),H[o].d();H.length=r.length}T||x(N,e.locale)},u:function(){f(n),f(o),f(a),f(u),R._unmount(),f(h),f(p),f(y),f(w),f(k),f(N);for(var t=0;t<H.length;t+=1)H[t].u()},d:function(){R.destroy(!1),m(H),_(N,"change",A)}}}function $o(t,e){var n,r,o,a,i,u,s,h,m,p,g,y=e.col,w=(e.col_index,y.title());return{c:function(){n=d("li"),r=d("a"),o=d("i"),i=v("\n                                "),u=d("i"),h=v("   "),m=v(w),this.h()},h:function(){o.className=a="fa fa-sort-"+("text"==y.type()?"alpha":"amount")+"-asc fa-fw svelte-1mhp3v1",b(o,"click",zo),o._svelte={component:t,columns:e.columns,col_index:e.col_index},u.className=s="fa fa-sort-"+("text"==y.type()?"alpha":"amount")+"-desc fa-fw svelte-1mhp3v1",b(u,"click",Po),u._svelte={component:t,columns:e.columns,col_index:e.col_index},r.href=p="#/"+y.name(),r.className="svelte-1mhp3v1",b(r,"click",qo),r._svelte={component:t,columns:e.columns,col_index:e.col_index},n.className=g=y.name()==e.sortBy?"active":""},m:function(t,e){c(n,t,e),l(r,n),l(o,r),l(i,r),l(u,r),l(h,r),l(m,r)},p:function(t,e){y=e.col,e.col_index,t.columns&&a!==(a="fa fa-sort-"+("text"==y.type()?"alpha":"amount")+"-asc fa-fw svelte-1mhp3v1")&&(o.className=a),o._svelte.columns=e.columns,o._svelte.col_index=e.col_index,t.columns&&s!==(s="fa fa-sort-"+("text"==y.type()?"alpha":"amount")+"-desc fa-fw svelte-1mhp3v1")&&(u.className=s),u._svelte.columns=e.columns,u._svelte.col_index=e.col_index,t.columns&&w!==(w=y.title())&&(m.data=w),t.columns&&p!==(p="#/"+y.name())&&(r.href=p),r._svelte.columns=e.columns,r._svelte.col_index=e.col_index,(t.columns||t.sortBy)&&g!==(g=y.name()==e.sortBy?"active":"")&&(n.className=g)},u:function(){f(n)},d:function(){_(o,"click",zo),_(u,"click",Po),_(r,"click",qo)}}}function Oo(t,e){var n,r,o,a;function i(e){t.nextResult(-1)}function u(e){t.nextResult(1)}return{c:function(){n=d("div"),(r=d("button")).innerHTML='<i class="fa fa-chevron-up"></i>',o=v("\n                          "),(a=d("button")).innerHTML='<i class="fa fa-chevron-down"></i>',this.h()},h:function(){r.className="btn svelte-1mhp3v1",b(r,"click",i),a.className="btn svelte-1mhp3v1",b(a,"click",u),n.className="btn-group"},m:function(t,e){c(n,t,e),l(r,n),l(o,n),l(a,n)},u:function(){f(n)},d:function(){_(r,"click",i),_(a,"click",u)}}}function jo(t,e){var n,r,o,a,i,s,l,h=e.searchIndexSafe+1,m=e.searchResults.length;return{c:function(){n=v(h),r=v("\n                            "),o=v("von"),a=v("\n                            "),i=v(m),s=v("\n                            "),l=v("Treffern")},m:function(t,e){c(n,t,e),c(r,t,e),c(o,t,e),c(a,t,e),c(i,t,e),c(s,t,e),c(l,t,e)},p:function(t,e){t.searchIndexSafe&&h!==(h=e.searchIndexSafe+1)&&(n.data=h),t.searchResults&&m!==(m=e.searchResults.length)&&(i.data=m)},u:function(){f(n),f(r),f(o),f(a),f(i),f(s),f(l)},d:u}}function Vo(t,e){var n;return{c:function(){n=v("Keine Treffer")},m:function(t,e){c(n,t,e)},p:u,u:function(){f(n)},d:u}}function Yo(t,e){var n;function r(t){return t.searchResults.length>0?jo:t.search?Vo:null}var o=r(e),a=o&&o(t,e);return{c:function(){n=d("div"),a&&a.c(),this.h()},h:function(){n.className="results svelte-1mhp3v1"},m:function(t,e){c(n,t,e),a&&a.m(n,null)},p:function(e,i){o===(o=r(i))&&a?a.p(e,i):(a&&(a.u(),a.d()),(a=o&&o(t,i))&&a.c(),a&&a.m(n,null))},u:function(){f(n),a&&a.u()},d:function(){a&&a.d()}}}function zo(t){var e=this._svelte.component,n=this._svelte.columns[this._svelte.col_index];e.sort(t,n.name(),!0)}function Po(t){var e=this._svelte.component,n=this._svelte.columns[this._svelte.col_index];e.sort(t,n.name(),!1)}function qo(t){var e=this._svelte.component,n=this._svelte.columns[this._svelte.col_index];e.sort(t,n.name(),!0)}function Bo(t){R(this,t),this.refs={},this._state=s(this.store._init(["dw_chart"]),{locale:"en-US",search:"",chartData:"",readonly:!1,transpose:!1,firstRowIsHeader:!0,searchIndex:0,activeColumn:!1,customColumn:!1,columnFormat:!1,multiSelection:!1,forceColumnFormat:!1,searchResults:[],sortBy:"-",sortDir:!0},t.data),this.store._add(this,["dw_chart"]),this._recompute({searchIndex:1,searchResults:1,activeColumn:1,forceColumnFormat:1,$dw_chart:1,sortBy:1,sortDir:1},this._state),this._handlers.destroy=[I];var e=function(){var t=this;window.addEventListener("keypress",function(e){e.ctrlKey&&"f"==e.key&&(e.preventDefault(),t.refs.search!=window.document.activeElement?t.refs.search.focus():t.nextResult(1))});var e=function(e,n){t.observe(e,function(r){if(t.store.get("dw_chart").set(""+n,r),"locale"==e){if(!r)return;t.store.get("dw_chart").locale(r,function(){t.refs.hot.render()})}})};e("transpose","metadata.data.transpose"),e("firstRowIsHeader","metadata.data.horizontal-header"),e("locale","language"),this.observe("activeColumn",function(e){e||t.set({forceColumnFormat:!1})})}.bind(this);t.root||(this._oncreate=[],this._beforecreate=[],this._aftercreate=[]),this._fragment=function(t,e){var n,r,o,a,i,u,p,g,y,x,C,M,k,N,S,T,F,R,D,H,I,A,U,L,E,$,O,j,V,Y,z,P,q,B,W,Z,J,G,Q,X,K,tt,et,nt,rt,ot,at,it,ut,st,lt,ct,ft,ht,mt,dt,pt,vt,gt,bt,_t,yt,wt,xt,Ct,Mt,kt,Nt,St=!1,Tt={};function Ft(t){return t.activeColumn?Uo:t.multiSelection?Lo:Eo}var Rt=Ft(e),Dt=Rt(t,e);function Ht(e){t.sort(e,"-")}for(var It=e.columns,At=[],Ut=0;Ut<It.length;Ut+=1)At[Ut]=$o(t,s({},e,{columns:It,col:It[Ut],col_index:Ut}));function Lt(){St=!0,t.set({search:nt.value}),St=!1}function Et(e){t.keyPress(e)}var $t=e.searchResults.length>0&&Oo(t),Ot=e.search&&Yo(t,e),jt={};"chartData"in e&&(jt.data=e.chartData,Tt.data=!0),"transpose"in e&&(jt.transpose=e.transpose,Tt.transpose=!0),"firstRowIsHeader"in e&&(jt.firstRowIsHeader=e.firstRowIsHeader,Tt.firstRowIsHeader=!0),"activeColumn"in e&&(jt.activeColumn=e.activeColumn,Tt.activeColumn=!0),"readonly"in e&&(jt.readonly=e.readonly,Tt.readonly=!0),"sorting"in e&&(jt.sorting=e.sorting,Tt.sorting=!0),"search"in e&&(jt.search=e.search,Tt.search=!0),"searchResults"in e&&(jt.searchResults=e.searchResults,Tt.searchResults=!0),"searchIndex"in e&&(jt.searchIndex=e.searchIndex,Tt.searchIndex=!0),"multiSelection"in e&&(jt.multiSelection=e.multiSelection,Tt.multiSelection=!0);var Vt=new To({root:t.root,data:jt,_bind:function(e,n){t.get();var r={};!Tt.data&&e.data&&(r.chartData=n.data),!Tt.transpose&&e.transpose&&(r.transpose=n.transpose),!Tt.firstRowIsHeader&&e.firstRowIsHeader&&(r.firstRowIsHeader=n.firstRowIsHeader),!Tt.activeColumn&&e.activeColumn&&(r.activeColumn=n.activeColumn),!Tt.readonly&&e.readonly&&(r.readonly=n.readonly),!Tt.sorting&&e.sorting&&(r.sorting=n.sorting),!Tt.search&&e.search&&(r.search=n.search),!Tt.searchResults&&e.searchResults&&(r.searchResults=n.searchResults),!Tt.searchIndex&&e.searchIndex&&(r.searchIndex=n.searchIndex),!Tt.multiSelection&&e.multiSelection&&(r.multiSelection=n.multiSelection),t._set(r),Tt={}}});function Yt(e){t.toggleTranspose()}function zt(e){t.addComputedColumn()}function Pt(e){t.revertChanges()}return t.root._beforecreate.push(function(){Vt._bind({data:1,transpose:1,firstRowIsHeader:1,activeColumn:1,readonly:1,sorting:1,search:1,searchResults:1,searchIndex:1,multiSelection:1},Vt.get())}),Vt.on("resetSort",function(e){t.set({sortBy:"-"})}),t.refs.hot=Vt,{c:function(){n=d("div"),r=d("div"),o=d("div"),a=d("div"),Dt.c(),i=v("\n\n                "),u=d("hr"),p=v("\n\n                "),g=d("div"),y=d("a"),x=d("i"),C=v(" "),M=v("Zurück"),k=v("\n                    "),N=d("a"),S=v("Weiter"),T=v(" "),F=d("i"),R=v("\n\n                "),D=d("p"),H=v("\n        "),I=d("div"),A=d("div"),U=d("noscript"),L=v(" "),E=d("img"),$=v("\n            "),O=d("div"),j=d("div"),V=d("div"),Y=d("button"),z=d("noscript"),P=v("… "),q=d("span"),B=v("\n                        "),W=d("ul"),Z=d("li"),J=d("a");for(var t=0;t<At.length;t+=1)At[t].c();Q=v("\n\n                "),X=d("div"),K=d("i"),tt=v("\n                    "),et=d("div"),nt=d("input"),ot=v("\n                        "),$t&&$t.c(),it=v("\n\n                    "),Ot&&Ot.c(),ut=v("\n\n            "),Vt._fragment.c(),st=v("\n\n            "),lt=d("div"),ct=d("button"),ft=d("img"),ht=v(" "),mt=v("Zeilen und Spalten vertauschen (transponieren)"),dt=v("\n\n                "),pt=d("button"),vt=d("i"),gt=v(" "),bt=v("Spalte hinzufügen"),_t=v("…"),yt=v("\n\n                "),wt=d("button"),xt=d("i"),Ct=v(" "),Mt=v("Änderungen zurücksetzen"),kt=v("..."),this.h()},h:function(){x.className="icon-chevron-left",y.className="btn submit",y.href="upload",F.className="icon-chevron-right icon-white",N.href="visualize",N.className="submit btn btn-primary",N.id="describe-proceed",g.className="btn-group",D.className="not-happy",a.className="sidebar",o.className="span4",E.src="/static/img/arrow.svg",A.className="help svelte-1mhp3v1",q.className="caret",Y.className="btn dropdown-toggle",Y.dataset.toggle="dropdown",J.href="#s",J.className="svelte-1mhp3v1",b(J,"click",Ht),Z.className=G="-"==e.sortBy?"active":"",W.className="dropdown-menu sort-menu",V.className="btn-group",j.className="sort-box svelte-1mhp3v1",K.className="im im-magnifier svelte-1mhp3v1",b(nt,"input",Lt),nt.type="text",nt.placeholder="Search data table",nt.className=rt=(e.searchResults.length>0?"with-results":"")+" search-query svelte-1mhp3v1",b(nt,"keypress",Et),et.className=at=e.searchResults.length>0?"input-append":"",X.className="search-box form-search svelte-1mhp3v1",O.className="pull-right",w(O,"margin-bottom","10px"),ft.src="/static/css/chart-editor/transpose.png",ft.className="svelte-1mhp3v1",ct.className="btn transpose svelte-1mhp3v1",b(ct,"click",Yt),vt.className="fa fa-calculator",pt.className="btn computed-columns",b(pt,"click",zt),xt.className="fa fa-undo",wt.className=Nt="btn "+(e.has_changes?"":"disabled")+" svelte-1mhp3v1",wt.id="reset-data-changes",b(wt,"click",Pt),lt.className="buttons below-table pull-right svelte-1mhp3v1",I.className="span8 svelte-1mhp3v1",r.className="row",n.className="chart-editor"},m:function(s,f){c(n,s,f),l(r,n),l(o,r),l(a,o),Dt.m(a,null),l(i,a),l(u,a),l(p,a),l(g,a),l(y,g),l(x,y),l(C,y),l(M,y),l(k,g),l(N,g),l(S,N),l(T,N),l(F,N),l(R,a),l(D,a),D.innerHTML="Du magst die neue Ansicht nicht? Sag uns <a href='mailto:hello@datawrapper.de?subject=Feedback'>weshalb</a>!<br><a href='?beta=0'>Hier</a> kannst du zur alten Seite wechseln.",l(H,r),l(I,r),l(A,I),l(U,A),U.insertAdjacentHTML("beforebegin","Auf Tabellenkopf klicken um<br>Spalteneigenschaften zu ändern"),l(L,A),l(E,A),l($,I),l(O,I),l(j,O),l(V,j),l(Y,V),l(z,Y),z.insertAdjacentHTML("beforebegin","Ansicht sortieren nach"),l(P,Y),l(q,Y),l(B,V),l(W,V),l(Z,W),l(J,Z),J.innerHTML="Keine Sortierung";for(var h=0;h<At.length;h+=1)At[h].m(W,null);t.refs.sortDropdownGroup=V,l(Q,O),l(X,O),l(K,X),l(tt,X),l(et,X),l(nt,et),t.refs.search=nt,nt.value=e.search,l(ot,et),$t&&$t.m(et,null),l(it,X),Ot&&Ot.m(X,null),l(ut,I),Vt._mount(I,null),l(st,I),l(lt,I),l(ct,lt),l(ft,ct),l(ht,ct),l(mt,ct),l(dt,lt),l(pt,lt),l(vt,pt),l(gt,pt),l(bt,pt),l(_t,pt),l(yt,lt),l(wt,lt),l(xt,wt),l(Ct,wt),l(Mt,wt),l(kt,wt)},p:function(e,n){Rt===(Rt=Ft(n))&&Dt?Dt.p(e,n):(Dt.u(),Dt.d(),(Dt=Rt(t,n)).c(),Dt.m(a,i)),e.sortBy&&G!==(G="-"==n.sortBy?"active":"")&&(Z.className=G);var r=n.columns;if(e.columns||e.sortBy){for(var o=0;o<r.length;o+=1){var u=s({},n,{columns:r,col:r[o],col_index:o});At[o]?At[o].p(e,u):(At[o]=$o(t,u),At[o].c(),At[o].m(W,null))}for(;o<At.length;o+=1)At[o].u(),At[o].d();At.length=r.length}St||(nt.value=n.search),e.searchResults&&rt!==(rt=(n.searchResults.length>0?"with-results":"")+" search-query svelte-1mhp3v1")&&(nt.className=rt),n.searchResults.length>0?$t||(($t=Oo(t)).c(),$t.m(et,null)):$t&&($t.u(),$t.d(),$t=null),e.searchResults&&at!==(at=n.searchResults.length>0?"input-append":"")&&(et.className=at),n.search?Ot?Ot.p(e,n):((Ot=Yo(t,n)).c(),Ot.m(X,null)):Ot&&(Ot.u(),Ot.d(),Ot=null);var l={};!Tt.data&&e.chartData&&(l.data=n.chartData,Tt.data=!0),!Tt.transpose&&e.transpose&&(l.transpose=n.transpose,Tt.transpose=!0),!Tt.firstRowIsHeader&&e.firstRowIsHeader&&(l.firstRowIsHeader=n.firstRowIsHeader,Tt.firstRowIsHeader=!0),!Tt.activeColumn&&e.activeColumn&&(l.activeColumn=n.activeColumn,Tt.activeColumn=!0),!Tt.readonly&&e.readonly&&(l.readonly=n.readonly,Tt.readonly=!0),!Tt.sorting&&e.sorting&&(l.sorting=n.sorting,Tt.sorting=!0),!Tt.search&&e.search&&(l.search=n.search,Tt.search=!0),!Tt.searchResults&&e.searchResults&&(l.searchResults=n.searchResults,Tt.searchResults=!0),!Tt.searchIndex&&e.searchIndex&&(l.searchIndex=n.searchIndex,Tt.searchIndex=!0),!Tt.multiSelection&&e.multiSelection&&(l.multiSelection=n.multiSelection,Tt.multiSelection=!0),Vt._set(l),Tt={},e.has_changes&&Nt!==(Nt="btn "+(n.has_changes?"":"disabled")+" svelte-1mhp3v1")&&(wt.className=Nt)},u:function(){D.innerHTML="",h(U),h(z),J.innerHTML="",f(n),Dt.u();for(var t=0;t<At.length;t+=1)At[t].u();$t&&$t.u(),Ot&&Ot.u()},d:function(){Dt.d(),_(J,"click",Ht),m(At),t.refs.sortDropdownGroup===V&&(t.refs.sortDropdownGroup=null),_(nt,"input",Lt),_(nt,"keypress",Et),t.refs.search===nt&&(t.refs.search=null),$t&&$t.d(),Ot&&Ot.d(),Vt.destroy(!1),t.refs.hot===Vt&&(t.refs.hot=null),_(ct,"click",Yt),_(pt,"click",zt),_(wt,"click",Pt)}}}(this,this._state),this.root._oncreate.push(e),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),this._lock=!0,H(this._beforecreate),H(this._oncreate),H(this._aftercreate),this._lock=!1)}function Wo(t,e){this._observers={pre:M(),post:M()},this._changeHandlers=[],this._dependents=[],this._computed=M(),this._sortedComputedProperties=[],this._state=s({},t),this._differs=e&&e.immutable?S:N}s(Bo.prototype,Fo,A),Bo.prototype._recompute=function(t,e){var n,r,o,a,i,u;(t.searchIndex||t.searchResults)&&this._differs(e.searchIndexSafe,e.searchIndexSafe=(n=e.searchIndex,r=e.searchResults,n<0&&(n+=r.length),n%=r.length))&&(t.searchIndexSafe=!0),(t.activeColumn||t.forceColumnFormat)&&(this._differs(e.customColumn,e.customColumn=(o=e.activeColumn,a=e.forceColumnFormat,!(!o||a||!o.isComputed)&&o))&&(t.customColumn=!0),this._differs(e.columnFormat,e.columnFormat=function(t,e){return!(!t||t.isComputed&&!e)&&t}(e.activeColumn,e.forceColumnFormat))&&(t.columnFormat=!0)),t.activeColumn&&this._differs(e.activeValues,e.activeValues=function(t){return t?t.values():[]}(e.activeColumn))&&(t.activeValues=!0),(t.activeColumn||t.$dw_chart)&&this._differs(e.activeFormat,e.activeFormat=function(t,e){return t?e.columnFormatter(t):function(t){return t}}(e.activeColumn,e.$dw_chart))&&(t.activeFormat=!0),t.activeColumn&&this._differs(e.columns,e.columns=function(t){var e=chart.dataset();if(!t)return e?e.columns():[];try{return e.columns().filter(function(t){return!t.isComputed})}catch(t){return[]}}(e.activeColumn))&&(t.columns=!0),(t.sortBy||t.sortDir)&&this._differs(e.sorting,e.sorting=(i=e.sortBy,u=e.sortDir,{sortBy:i,sortDir:u}))&&(t.sorting=!0)},s(Wo.prototype,{_add:function(t,e){this._dependents.push({component:t,props:e})},_init:function(t){for(var e={},n=0;n<t.length;n+=1){var r=t[n];e["$"+r]=this._state[r]}return e},_remove:function(t){for(var e=this._dependents.length;e--;)if(this._dependents[e].component===t)return void this._dependents.splice(e,1)},_sortComputedProperties:function(){var t,e=this._computed,n=this._sortedComputedProperties=[],r=M();function o(a){if(t[a])throw new Error("Cyclical dependency detected");if(!r[a]){r[a]=!0;var i=e[a];i&&(t[a]=!0,i.deps.forEach(o),n.push(i))}}for(var a in this._computed)t=M(),o(a)},compute:function(t,e,n){var r,o=this,a={deps:e,update:function(a,i,u){var s=e.map(function(t){return t in i&&(u=!0),a[t]});if(u){var l=n.apply(null,s);o._differs(l,r)&&(r=l,i[t]=!0,a[t]=r)}}};a.update(this._state,{},!0),this._computed[t]=a,this._sortComputedProperties()},get:F,observe:D,onchange:function(t){this._changeHandlers.push(t);var e=this;return{cancel:function(){var n=e._changeHandlers.indexOf(t);~n&&e._changeHandlers.splice(n,1)}}},set:function(t){var e=this._state,n=this._changed={},r=!1;for(var o in t){if(this._computed[o])throw new Error("'"+o+"' is a read-only property");this._differs(t[o],e[o])&&(n[o]=r=!0)}if(r){this._state=s({},e,t);for(var a=0;a<this._sortedComputedProperties.length;a+=1)this._sortedComputedProperties[a].update(this._state,n);for(a=0;a<this._changeHandlers.length;a+=1)this._changeHandlers[a](this._state,n);T(this,this._observers.pre,n,this._state,e);var i=this._dependents.slice();for(a=0;a<i.length;a+=1){var u=i[a],l={};r=!1;for(var c=0;c<u.props.length;c+=1){var f=u.props[c];f in n&&(l["$"+f]=this._state[f],r=!0)}r&&u.component.set(l)}T(this,this._observers.post,n,this._state,e)}}});return{App:Bo,store:new Wo({}),data:{chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0}}});

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("Handsontable"),require("cm/lib/codemirror"),require("cm/mode/javascript/javascript")):"function"==typeof define&&define.amd?define("svelte/describe",["Handsontable","cm/lib/codemirror","cm/mode/javascript/javascript"],t):e.describe=t(e.HOT,e.CodeMirror)}(this,function(e,t){"use strict";function n(){}function s(e){for(var t,n,s=arguments,a=1,r=arguments.length;a<r;a++)for(t in n=s[a])e[t]=n[t];return e}function a(e,t){t.appendChild(e)}function r(e,t,n){t.insertBefore(e,n)}function o(e){e.parentNode.removeChild(e)}function c(e){return document.createElement(e)}function i(e){return document.createTextNode(e)}function u(e,t,n){e.addEventListener(t,n,!1)}function l(e,t,n){e.removeEventListener(t,n,!1)}function h(e,t,n){e.setAttribute(t,n)}function f(e,t,n){e.style.setProperty(t,n)}function d(){return Object.create(null)}function m(e){this.destroy=n,this.fire("destroy"),this.set=this.get=n,!1!==e&&this._fragment.u(),this._fragment.d(),this._fragment=this._state=null}function p(e,t){return e!==t||e&&"object"==typeof e||"function"==typeof e}function v(e,t,n,s,a){for(var r in t)if(n[r]){var o=s[r],c=a[r],i=t[r];if(i)for(var u=0;u<i.length;u+=1){var l=i[u];l.__calling||(l.__calling=!0,l.call(e,o,c),l.__calling=!1)}}}function g(e){return e?this._state[e]:this._state}function _(e,t){e._observers={pre:d(),post:d()},e._handlers=d(),e._bind=t._bind,e.options=t,e.root=t.root||e,e.store=e.root.store||t.store}function w(e,t,n){var s=n&&n.defer?this._observers.post:this._observers.pre;return(s[e]||(s[e]=[])).push(t),n&&!1===n.init||(t.__calling=!0,t.call(this,this._state[e]),t.__calling=!1),{cancel:function(){var n=s[e].indexOf(t);~n&&s[e].splice(n,1)}}}function b(e){for(;e&&e.length;)e.pop()()}e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t;var R={destroy:m,get:g,fire:function(e,t){var n=e in this._handlers&&this._handlers[e].slice();if(n)for(var s=0;s<n.length;s+=1)n[s].call(this,t)},observe:w,on:function(e,t){if("teardown"===e)return this.on("destroy",t);var n=this._handlers[e]||(this._handlers[e]=[]);return n.push(t),{cancel:function(){var e=n.indexOf(t);~e&&n.splice(e,1)}}},set:function(e){this._set(s({},e)),this.root._lock||(this.root._lock=!0,b(this.root._beforecreate),b(this.root._oncreate),b(this.root._aftercreate),this.root._lock=!1)},teardown:m,_recompute:n,_set:function(e){var t=this._state,n={},a=!1;for(var r in e)p(e[r],t[r])&&(n[r]=a=!0);a&&(this._state=s({},t,e),this._recompute(n,this._state),this._bind&&this._bind(n,this._state),this._fragment&&(v(this,this._observers.pre,n,this._state,t),this._fragment.p(n,this._state),v(this,this._observers.post,n,this._state,t)))},_mount:function(e,t){this._fragment.m(e,t)},_unmount:function(){this._fragment&&this._fragment.u()}};var C={update:function(){var t=this,n=this.get(),s=n.data,a=n.transpose,r=n.firstRowIsHeader,o=n.skipRows,c=n.hot;if(s){var i=this.store.get("dw_chart"),u=i.dataset(dw.datasource.delimited({csv:s,transpose:a,firstRowIsHeader:r,skipRows:o}).parse()).dataset();this.set({columnOrder:u.columnOrder()});var l=[[]];u.eachColumn(function(e){return l[0].push(e.title())}),u.eachRow(function(e){var t=[];u.eachColumn(function(n){return t.push(n.raw(e))}),l.push(t)}),c.loadData(l),c.updateSettings({cells:function(n,s){return{readOnly:t.get().readonly||u.numColumns()>s&&u.column(s).isComputed&&0===n,renderer:y(t,u,e,{})}},manualColumnMove:[]}),this.set({has_changes:i.get("metadata.data.changes",[]).length>0}),c.render()}},dataChanged:function(e){var t=this,n=this.get().hot,s=!1;e.forEach(function(e){var a=e[0],r=e[1],o=e[2],c=e[3];if(o!=c){var i=t.store.get("dw_chart"),u=t.get().transpose,l=i.get("metadata.data.changes");if(a=n.toPhysicalRow(a),u){var h=a;a=r,r=h}l.push({row:a,column:r,value:c,time:(new Date).getTime()}),i.set("metadata.data.changes",l),s=!0}}),s&&setTimeout(function(){t.update(),chart.save()},100)},columnMoved:function(t,n){var s=this.get().hot;if(t.length){var a=this.get().columnOrder,r=a.slice(0),o=a[n],c=r.splice(t[0],t.length),i=o?r.indexOf(o):r.length;r.splice.apply(r,[i,0].concat(c)),this.store.get("dw_chart").set("metadata.data.column-order",r.slice(0)),this.set({columnOrder:r}),e.hooks.once("afterRender",function(){setTimeout(function(){s.selectCell(0,i,s.countRows()-1,i+c.length-1)},10)}),this.update()}},updateHeight:function(){var e=document.querySelector(".ht_master.handsontable .wtHolder .wtHider").getBoundingClientRect().height;this.refs.hot.style.height=Math.min(400,e+10)+"px"},checkRange:function(e,t,n,s){var a=this.get().hot;if(t!=s||0!==e||n!=a.countRows()-1)this.set({activeColumn:null});else{var r=this.store.get("dw_chart");this.set({activeColumn:r.dataset().column(t)})}}};function y(e,t,n,s){var a={date:"fa fa-clock-o"};return function(s,r,o,c,i,u,l){if(!(t.numColumns()<=c)){var h=t.column(c),f=e.get(),d=f.searchResults,m=f.currentResult,p=f.activeColumn;if((o=s.toPhysicalRow(o))>0)u=chart.columnFormatter(h)(h.val(o-1),!0);parseInt(u)<0&&r.classList.add("negative"),r.classList.add(h.type()+"Type"),"text"==h.type()&&u.length>70&&(u=u.substr(0,60)+"…"),0===o?(r.classList.add("firstRow"),a[h.type()]&&(u='<i class="'+a[h.type()]+'"></i> '+u)):r.classList.add(o%2?"oddRow":"evenRow"),p&&p==h&&r.classList.add("area"),d.forEach(function(e){e.row==o&&e.col==c&&r.classList.add("htSearchResult")}),m&&m.row==o&&m.col==c&&r.classList.add("htCurrentSearchResult"),o>0&&!h.type(!0).isValid(h.val(o-1))&&r.classList.add("parsingError"),l.readOnly&&r.classList.add("readOnly"),chart.dataCellChanged(c,o)&&r.classList.add("changed"),function(e,t,s,a,r,o,c){var i=dw.utils.purifyHtml(n.helper.stringify(o));t.innerHTML=i}(0,r,0,0,0,u)}}}function I(t){_(this,t),this.refs={},this._state=s({data:"",readonly:!1,skipRows:0,firstRowIsHeader:!0,searchIndex:0,transpose:!1,activeColumn:null,search:"",searchResults:[]},t.data),this._recompute({searchResults:1,searchIndex:1},this._state);var a,i,u=function(){var t=this,n=new e(this.refs.hot,{data:[],rowHeaders:function(e){return n.getPlugin("ColumnSorting").translateRow(e)+1},colHeaders:!0,fixedRowsTop:1,filters:!0,dropdownMenu:!0,startRows:13,startCols:8,fillHandle:!1,stretchH:"all",height:400,manualColumnMove:!0,selectionMode:"range",autoColumnSize:{useHeaders:!0},columnSorting:!0,sortIndicator:!0,sortFunction:function(e,t){return function(s,a){var r,o=n.getPlugin("columnSorting");if(0===s[0])return-1;switch(t.type){case"date":r=o.dateSort;break;case"numeric":r=o.numericSort;break;default:r=o.defaultSort}return r(e,t)(s,a)}},search:"search"});window.HT=n,this.set({hot:n}),e.hooks.add("afterSetDataAtCell",function(e){return t.dataChanged(e)}),e.hooks.add("afterColumnMove",function(e,n){return t.columnMoved(e,n)}),e.hooks.add("afterRender",function(){return t.updateHeight()}),e.hooks.add("afterSelection",function(e,n,s,a){return t.checkRange(e,n,s,a)}),this.observe("data",function(){return t.update()}),this.observe("transpose",function(){return t.update()}),this.observe("firstRowIsHeader",function(){return t.update()}),this.observe("search",function(e){var s=n.search.query(e);t.set({searchResults:s}),n.render()}),this.observe("currentResult",function(e){e&&n&&(n.render(),n.scrollViewportTo(e.row,e.col),setTimeout(function(){n.scrollViewportTo(e.row,e.col)},100))})}.bind(this);t.root?this.root._oncreate.push(u):this._oncreate=[u],this._fragment=(this._state,a=this,{c:function(){i=c("div"),this.h()},h:function(){i.id="data-preview"},m:function(e,t){r(i,e,t),a.refs.hot=i},p:n,u:function(){o(i)},d:function(){a.refs.hot===i&&(a.refs.hot=null)}}),t.target&&(this._fragment.c(),this._fragment.m(t.target,t.anchor||null),b(this._oncreate))}s(I.prototype,C,R),I.prototype._recompute=function(e,t){(e.searchResults||e.searchIndex)&&p(t.currentResult,t.currentResult=function(e,t){if(!e||!e.length)return null;var n=e.length;if(t<0||t>=n){for(;t<0;)t+=n;t>n&&(t%=n)}return e[t]}(t.searchResults,t.searchIndex))&&(e.currentResult=!0)};function x(e){h(e,"svelte-3309569136","")}function k(e,t,n,s,h){var f,d,m=n.key;return{c:function(){f=c("li"),d=i(m),this.h()},h:function(){x(f),u(f,"click",H),f._svelte={component:h,metaColumns_1:t,column_index:s}},m:function(e,t){r(f,e,t),a(d,f)},p:function(e,t,n,s,a){e.metaColumns&&m!==(m=s.key)&&(d.data=m),f._svelte.metaColumns_1=n,f._svelte.column_index=a},u:function(){o(f)},d:function(){l(f,"click",H)}}}function H(e){var t=this._svelte.component,n=this._svelte.metaColumns_1[this._svelte.column_index];t.insert(n)}function N(e){_(this,e),this.refs={},this._state=s({},e.data),this._recompute({columns:1},this._state);var n=function(){var e=this,n=t.fromTextArea(this.refs.code,{value:this.get("formula"),mode:"javascript"});this.observe("formula",function(e){e!=n.getValue()&&n.setValue(e)}),n.on("change",function(t){e.set({formula:t.getValue()})}),n.on("focus",function(){e.fire("focus")})}.bind(this);e.root?this.root._oncreate.push(n):this._oncreate=[n],this._fragment=function(e,t){var n,s,h,d,m,p,v,g,_,w,b,R,C,y,I,H,N,S,T,O,L,D,F,E,M=e.column.name(),P=!1;function z(){P=!0,t.set({name:C.value}),P=!1}for(var j=e.metaColumns,V=[],q=0;q<j.length;q+=1)V[q]=k(0,j,j[q],q,t);return{c:function(){n=c("div"),s=c("h3"),h=i('Edit computed column "'),d=i(M),m=i('"'),p=i("\n    "),v=c("p"),g=i("Die Werte in den Spalten können nach einer Formel berechnet werden, wie in Excel."),_=i("\n\n    "),w=c("label"),b=i("computed columns / modal / name"),R=i("\n    "),C=c("input"),y=i("\n\n    "),I=c("label"),H=i("Formel (JavaScript)"),N=i("\n    "),S=c("textarea"),T=i("\n\n    "),O=c("p"),L=i("Verfügbare Spalten"),D=i(":"),F=i("\n\n    "),E=c("ul");for(var e=0;e<V.length;e+=1)V[e].c();this.h()},h:function(){s.className="first",x(w),u(C,"input",z),C.type="text",x(I),S.className="code",f(O,"margin-top","1em"),x(E),E.className="col-select"},m:function(o,c){r(n,o,c),a(s,n),a(h,s),a(d,s),a(m,s),a(p,n),a(v,n),a(g,v),a(_,n),a(w,n),a(b,w),a(R,n),a(C,n),C.value=e.name,a(y,n),a(I,n),a(H,I),a(N,n),a(S,n),t.refs.code=S,a(T,n),a(O,n),a(L,O),a(D,O),a(F,n),a(E,n);for(var i=0;i<V.length;i+=1)V[i].m(E,null)},p:function(e,n){e.column&&M!==(M=n.column.name())&&(d.data=M),P||(C.value=n.name);var s=n.metaColumns;if(e.metaColumns){for(var a=0;a<s.length;a+=1)V[a]?V[a].p(e,n,s,s[a],a):(V[a]=k(0,s,s[a],a,t),V[a].c(),V[a].m(E,null));for(;a<V.length;a+=1)V[a].u(),V[a].d();V.length=s.length}},u:function(){o(n);for(var e=0;e<V.length;e+=1)V[e].u()},d:function(){l(C,"input",z),t.refs.code===S&&(t.refs.code=null),function(e){for(var t=0;t<e.length;t+=1)e[t]&&e[t].d()}(V)}}}(this._state,this),e.target&&(this._fragment.c(),this._fragment.m(e.target,e.anchor||null),b(this._oncreate))}function S(e){_(this,e),this._state=s({},e.data),this._fragment=function(e,t){var n,s,h,d,m;function p(){t.set({value:h.checked})}return{c:function(){n=c("div"),s=c("label"),h=c("input"),d=i(" "),m=i(e.label),this.h()},h:function(){u(h,"change",p),h.type="checkbox",s.className="checkbox",f(s,"text-align","left"),f(s,"width","100%"),f(s,"position","relative"),f(s,"left","0"),n.className="control-group vis-option-group vis-option-type-checkbox"},m:function(t,o){r(n,t,o),a(s,n),a(h,s),h.checked=e.value,a(d,s),a(m,s)},p:function(e,t){h.checked=t.value,e.label&&(m.data=t.label)},u:function(){o(n)},d:function(){l(h,"change",p)}}}(this._state,this),e.target&&(this._fragment.c(),this._fragment.m(e.target,e.anchor||null))}s(N.prototype,{insert:function(e){}},R),N.prototype._recompute=function(e,t){var n;e.columns&&p(t.metaColumns,t.metaColumns=(n=t.columns)?n.map(function(e){return{key:(t=e.name(),t.toString().toLowerCase().replace(/\s+/g,"_").replace(/[^\w-]+/g,"").replace(/-/g,"_").replace(/__+/g,"_").replace(/^_+/,"").replace(/_+$/,"").replace(/^(\d)/,"_$1").replace(/(abstract|arguments|await|boolean|break|byte|case|catch|char|class|const|continue|debugger|default|delete|do|double|else|enum|eval|export|extends|false|final|finally|float|for|function|goto|if|implements|import|in|instanceof|int|interface|let|long|native|new|null|package|private|protected|public|return|short|static|super|switch|synchronized|this|throw|throws|transient|true|try|typeof|var|void|volatile|while|window|with|yield)/,"$1_")),title:e.title()};var t}):[])&&(e.metaColumns=!0)},s(S.prototype,R);var T={nextResult:function(e){var t=this.get(),n=t.searchIndex,s=t.searchResults;(n+=e)<0&&(n+=s.length),n%=s.length,this.set({searchIndex:n})},keyPress:function(e){"F3"!=e.key&&"Enter"!=e.key||this.nextResult(e.shiftKey?-1:1)},toggleTranspose:function(){this.set({transpose:!this.get("transpose")})},revertChanges:function(){var e=this.store.get("dw_chart");e.set("metadata.data.changes",[]),e.saveSoon(),this.refs.hot.update()},cmFocus:function(){var e=this;setTimeout(function(){e.refs.hot.get("hot").render()},100)}};function O(e){h(e,"svelte-1903720201","")}function L(e,t){var n={},a={};"customColumn"in e&&(a.column=e.customColumn,n.column=!0),"formula"in e&&(a.formula=e.formula,n.formula=!0),"columns"in e&&(a.columns=e.columns,n.columns=!0);var r=new N({root:t.root,data:a,_bind:function(e,a){t.get();var r={};!n.column&&e.column&&(r.customColumn=a.column),!n.formula&&e.formula&&(r.formula=a.formula),!n.columns&&e.columns&&(r.columns=a.columns),n=s({},e),t._set(r),n={}}});return t.root._beforecreate.push(function(){t.get();var e=r.get(),s={};e&&(n.column||(s.customColumn=e.column),n.formula||(s.formula=e.formula),n.columns||(s.columns=e.columns),n={column:!0,formula:!0,columns:!0},t._set(s),n={})}),r.on("focus",function(e){t.cmFocus()}),{c:function(){r._fragment.c()},m:function(e,t){r._mount(e,t)},p:function(e,t){var s={};!n.column&&e.customColumn&&(s.column=t.customColumn,n.column=!0),!n.formula&&e.formula&&(s.formula=t.formula,n.formula=!0),!n.columns&&e.columns&&(s.columns=t.columns,n.columns=!0),r._set(s),n={}},u:function(){r._unmount()},d:function(){r.destroy(!1)}}}function D(e,t){var s,a,c=e.columnFormat.title();return{c:function(){s=i("COLUMN FORMAT FOR "),a=i(c)},m:function(e,t){r(s,e,t),r(a,e,t)},p:function(e,t){e.columnFormat&&c!==(c=t.columnFormat.title())&&(a.data=c)},u:function(){o(s),o(a)},d:n}}function F(e,t){var n,u,l,h,f,d,m,p,v,g,_={},w={label:"Erste Zeile als Beschriftung"};"firstRowIsHeader"in e&&(w.value=e.firstRowIsHeader,_.value=!0);var b=new S({root:t.root,data:w,_bind:function(e,n){t.get();var a={};!_.value&&e.value&&(a.firstRowIsHeader=n.value),_=s({},e),t._set(a),_={}}});return t.root._beforecreate.push(function(){t.get();var e=b.get(),n={};e&&(_.value||(n.firstRowIsHeader=e.value),_={value:!0},t._set(n),_={})}),{c:function(){n=c("h3"),u=i("Überprüfe dass die Daten richtig aussehen"),l=i("\n\n                "),h=c("p"),f=i("Interpretiert Datawrapper deine Daten korrekt? In der nebenstehenden Tabelle sollten Zahlenspalten in blau, Datums-Spalten in grün und Textspalten in schwarz angezeigt werden."),d=i("\n\n                "),b._fragment.c(),m=i("\n\n                [TODO: hook]\n                "),p=c("hr"),v=i("\n\n                "),(g=c("div")).innerHTML='<a class="btn submit" href="upload"><i class="icon-chevron-left"></i> Zurück</a>\n                    <a href="visualize" class="submit btn btn-primary" id="describe-proceed">Weiter <i class="icon-chevron-right icon-white"></i></a>',this.h()},h:function(){n.className="first",g.className="btn-group"},m:function(e,t){r(n,e,t),a(u,n),r(l,e,t),r(h,e,t),a(f,h),r(d,e,t),b._mount(e,t),r(m,e,t),r(p,e,t),r(v,e,t),r(g,e,t)},p:function(e,t){var n={label:"Erste Zeile als Beschriftung"};!_.value&&e.firstRowIsHeader&&(n.value=t.firstRowIsHeader,_.value=!0),b._set(n),_={}},u:function(){o(n),o(l),o(h),o(d),b._unmount(),o(m),o(p),o(v),o(g)},d:function(){b.destroy(!1)}}}function E(e,t){var n,s,h,f;function d(e){t.nextResult(-1)}function m(e){t.nextResult(1)}return{c:function(){n=c("div"),(s=c("button")).innerHTML='<i class="fa fa-chevron-up"></i>',h=i("\n                      "),(f=c("button")).innerHTML='<i class="fa fa-chevron-down"></i>',this.h()},h:function(){O(s),s.className="btn",u(s,"click",d),O(f),f.className="btn",u(f,"click",m),n.className="btn-group"},m:function(e,t){r(n,e,t),a(s,n),a(h,n),a(f,n)},u:function(){o(n)},d:function(){l(s,"click",d),l(f,"click",m)}}}function M(e,t){var s,a,c,u,l,h,f,d=e.searchIndexSafe+1,m=e.searchResults.length;return{c:function(){s=i(d),a=i("\n                        "),c=i("von"),u=i("\n                        "),l=i(m),h=i("\n                        "),f=i("Treffern")},m:function(e,t){r(s,e,t),r(a,e,t),r(c,e,t),r(u,e,t),r(l,e,t),r(h,e,t),r(f,e,t)},p:function(e,t){e.searchIndexSafe&&d!==(d=t.searchIndexSafe+1)&&(s.data=d),e.searchResults&&m!==(m=t.searchResults.length)&&(l.data=m)},u:function(){o(s),o(a),o(c),o(u),o(l),o(h),o(f)},d:n}}function P(e,t){var s;return{c:function(){s=i("Keine Treffer")},m:function(e,t){r(s,e,t)},p:n,u:function(){o(s)},d:n}}function z(e,t){var n,s=V(e),a=s&&s(e,t);return{c:function(){n=c("div"),a&&a.c(),this.h()},h:function(){O(n),n.className="results"},m:function(e,t){r(n,e,t),a&&a.m(n,null)},p:function(e,r){s===(s=V(r))&&a?a.p(e,r):(a&&(a.u(),a.d()),(a=s&&s(r,t))&&a.c(),a&&a.m(n,null))},u:function(){o(n),a&&a.u()},d:function(){a&&a.d()}}}function j(e){return e.customColumn?L:e.columnFormat?D:F}function V(e){return e.searchResults.length>0?M:e.search?P:null}function q(e){_(this,e),this.refs={},this._state=s({search:"",chartData:"",transpose:!1,firstRowIsHeader:!0,searchIndex:0,activeColumn:!1,customColumn:!1,columnFormat:!1,formula:"",searchResults:[]},e.data),this._recompute({searchIndex:1,searchResults:1,activeColumn:1},this._state);var t=function(){var e=this;window.addEventListener("keypress",function(t){t.ctrlKey&&"f"==t.key&&(t.preventDefault(),e.refs.search!=window.document.activeElement?e.refs.search.focus():e.nextResult(1))});var t=function(t,n){e.observe(t,function(t){e.store.get("dw_chart").set("metadata."+n,t)})};t("transpose","data.transpose"),t("firstRowIsHeader","data.horizontal-header"),this.observe("customColumn",function(t,n){if(t&&t!=n){var s=e.store.get("dw_chart").get("metadata.describe.computed-columns",{});e.set({formula:s[t.name()]||""})}}),this.observe("formula",function(t){var n=e.get().customColumn,s=e.store.get("dw_chart");if(n){var a=s.get("metadata.describe.computed-columns",{});a[n.name()]=t,s.set("metadata.describe.computed-columns",a),s.saveSoon(),e.refs.hot.update()}})}.bind(this);e.root?this.root._oncreate.push(t):(this._oncreate=[t],this._beforecreate=[],this._aftercreate=[]),this._fragment=function(e,t){var n,h,f,d,m,p,v,g,_,w,b,R,C,y,x,k,H,N,S,T,L,D,F,M,P,V,q,A,Z,$,B,K,W,J,U=!1,G={},Q=j(e),X=Q(e,t);function Y(e){t.toggleTranspose()}function ee(){U=!0,t.set({search:k.value}),U=!1}function te(e){t.keyPress(e)}var ne=e.searchResults.length>0&&E(0,t),se=e.search&&z(e,t),ae={};"chartData"in e&&(ae.data=e.chartData,G.data=!0),"transpose"in e&&(ae.transpose=e.transpose,G.transpose=!0),"firstRowIsHeader"in e&&(ae.firstRowIsHeader=e.firstRowIsHeader,G.firstRowIsHeader=!0),"activeColumn"in e&&(ae.activeColumn=e.activeColumn,G.activeColumn=!0),"search"in e&&(ae.search=e.search,G.search=!0),"searchResults"in e&&(ae.searchResults=e.searchResults,G.searchResults=!0),"searchIndex"in e&&(ae.searchIndex=e.searchIndex,G.searchIndex=!0);var re=new I({root:t.root,data:ae,_bind:function(e,n){t.get();var a={};!G.data&&e.data&&(a.chartData=n.data),!G.transpose&&e.transpose&&(a.transpose=n.transpose),!G.firstRowIsHeader&&e.firstRowIsHeader&&(a.firstRowIsHeader=n.firstRowIsHeader),!G.activeColumn&&e.activeColumn&&(a.activeColumn=n.activeColumn),!G.search&&e.search&&(a.search=n.search),!G.searchResults&&e.searchResults&&(a.searchResults=n.searchResults),!G.searchIndex&&e.searchIndex&&(a.searchIndex=n.searchIndex),G=s({},e),t._set(a),G={}}});function oe(e){t.revertChanges()}return t.root._beforecreate.push(function(){t.get();var e=re.get(),n={};e&&(G.data||(n.chartData=e.data),G.transpose||(n.transpose=e.transpose),G.firstRowIsHeader||(n.firstRowIsHeader=e.firstRowIsHeader),G.activeColumn||(n.activeColumn=e.activeColumn),G.search||(n.search=e.search),G.searchResults||(n.searchResults=e.searchResults),G.searchIndex||(n.searchIndex=e.searchIndex),G={data:!0,transpose:!0,firstRowIsHeader:!0,activeColumn:!0,search:!0,searchResults:!0,searchIndex:!0},t._set(n),G={})}),t.refs.hot=re,{c:function(){n=c("div"),h=c("div"),f=c("div"),d=c("div"),X.c(),m=i("\n        "),p=c("div"),v=c("button"),g=c("img"),_=i(" "),w=i("Zeilen und Spalten vertauschen (transponieren)"),b=i("\n\n            "),R=c("div"),C=c("i"),y=i("\n                "),x=c("div"),k=c("input"),N=i("\n                    "),ne&&ne.c(),S=i("\n\n                "),se&&se.c(),T=i("\n\n            "),re._fragment.c(),L=i("\n\n            "),D=c("div"),F=c("button"),M=c("i"),P=i(" "),V=i("Spalte hinzufügen"),q=i("..."),A=i("\n\n                "),Z=c("button"),$=c("i"),B=i(" "),K=i("Änderungen zurücksetzen"),W=i("..."),this.h()},h:function(){d.className="sidebar",f.className="span4",O(p),O(v),O(g),g.src="/static/css/chart-editor/transpose.png",v.className="btn transpose",u(v,"click",Y),O(R),O(C),C.className="fa fa-search",O(k),u(k,"input",ee),k.type="text",k.placeholder="Search data table",k.className=H=e.searchResults.length>0?"with-results":"",u(k,"keypress",te),x.className="input-append",R.className="search-box pull-right",O(D),M.className="fa fa-calculator",F.className="btn computed-columns",O(Z),$.className="fa fa-undo",Z.className=J="btn "+(e.has_changes?"":"disabled"),Z.id="reset-data-changes",u(Z,"click",oe),D.className="buttons below-table pull-right",p.className="span8",h.className="row",n.className="chart-editor"},m:function(s,o){r(n,s,o),a(h,n),a(f,h),a(d,f),X.m(d,null),a(m,h),a(p,h),a(v,p),a(g,v),a(_,v),a(w,v),a(b,p),a(R,p),a(C,R),a(y,R),a(x,R),a(k,x),t.refs.search=k,k.value=e.search,a(N,x),ne&&ne.m(x,null),a(S,R),se&&se.m(R,null),a(T,p),re._mount(p,null),a(L,p),a(D,p),a(F,D),a(M,F),a(P,F),a(V,F),a(q,F),a(A,D),a(Z,D),a($,Z),a(B,Z),a(K,Z),a(W,Z)},p:function(e,n){Q===(Q=j(n))&&X?X.p(e,n):(X.u(),X.d(),(X=Q(n,t)).c(),X.m(d,null)),U||(k.value=n.search),e.searchResults&&H!==(H=n.searchResults.length>0?"with-results":"")&&(k.className=H),n.searchResults.length>0?ne||((ne=E(0,t)).c(),ne.m(x,null)):ne&&(ne.u(),ne.d(),ne=null),n.search?se?se.p(e,n):((se=z(n,t)).c(),se.m(R,null)):se&&(se.u(),se.d(),se=null);var s={};!G.data&&e.chartData&&(s.data=n.chartData,G.data=!0),!G.transpose&&e.transpose&&(s.transpose=n.transpose,G.transpose=!0),!G.firstRowIsHeader&&e.firstRowIsHeader&&(s.firstRowIsHeader=n.firstRowIsHeader,G.firstRowIsHeader=!0),!G.activeColumn&&e.activeColumn&&(s.activeColumn=n.activeColumn,G.activeColumn=!0),!G.search&&e.search&&(s.search=n.search,G.search=!0),!G.searchResults&&e.searchResults&&(s.searchResults=n.searchResults,G.searchResults=!0),!G.searchIndex&&e.searchIndex&&(s.searchIndex=n.searchIndex,G.searchIndex=!0),re._set(s),G={},e.has_changes&&J!==(J="btn "+(n.has_changes?"":"disabled"))&&(Z.className=J)},u:function(){o(n),X.u(),ne&&ne.u(),se&&se.u()},d:function(){X.d(),l(v,"click",Y),l(k,"input",ee),l(k,"keypress",te),t.refs.search===k&&(t.refs.search=null),ne&&ne.d(),se&&se.d(),re.destroy(!1),t.refs.hot===re&&(t.refs.hot=null),l(Z,"click",oe)}}}(this._state,this),e.target&&(this._fragment.c(),this._fragment.m(e.target,e.anchor||null),this._lock=!0,b(this._beforecreate),b(this._oncreate),b(this._aftercreate),this._lock=!1)}function A(e){this._observers={pre:d(),post:d()},this._changeHandlers=[],this._dependents=[],this._computed=d(),this._sortedComputedProperties=[],this._state=s({},e)}s(q.prototype,T,R),q.prototype._recompute=function(e,t){var n,s,a;(e.searchIndex||e.searchResults)&&p(t.searchIndexSafe,t.searchIndexSafe=(n=t.searchIndex,s=t.searchResults,n<0&&(n+=s.length),n%=s.length))&&(e.searchIndexSafe=!0),e.activeColumn&&(p(t.customColumn,t.customColumn=!(!(a=t.activeColumn)||!a.isComputed)&&a)&&(e.customColumn=!0),p(t.columnFormat,t.columnFormat=function(e){return!(!e||e.isComputed)&&e}(t.activeColumn))&&(e.columnFormat=!0),p(t.columns,t.columns=function(e){if(!e)return[];try{return chart.dataset().columns().filter(function(e){return!e.isComputed})}catch(e){return[]}}(t.activeColumn))&&(e.columns=!0))},s(A.prototype,{_add:function(e,t){this._dependents.push({component:e,props:t})},_init:function(e){for(var t={},n=0;n<e.length;n+=1){var s=e[n];t["$"+s]=this._state[s]}return t},_remove:function(e){for(var t=this._dependents.length;t--;)if(this._dependents[t].component===e)return void this._dependents.splice(t,1)},_sortComputedProperties:function(){var e,t=this._computed,n=this._sortedComputedProperties=[],s=d();function a(r){if(e[r])throw new Error("Cyclical dependency detected");if(!s[r]){s[r]=!0;var o=t[r];o&&(e[r]=!0,o.deps.forEach(a),n.push(o))}}for(var r in this._computed)e=d(),a(r)},compute:function(e,t,n){var s,a={deps:t,update:function(a,r,o){var c=t.map(function(e){return e in r&&(o=!0),a[e]});if(o){var i=n.apply(null,c);p(i,s)&&(s=i,r[e]=!0,a[e]=s)}}};a.update(this._state,{},!0),this._computed[e]=a,this._sortComputedProperties()},get:g,observe:w,onchange:function(e){return this._changeHandlers.push(e),{cancel:function(){var t=this._changeHandlers.indexOf(e);~t&&this._changeHandlers.splice(t,1)}}},set:function(e){var t=this._state,n=this._changed={},a=!1;for(var r in e){if(this._computed[r])throw new Error("'"+r+"' is a read-only property");p(e[r],t[r])&&(n[r]=a=!0)}if(a){this._state=s({},t,e);for(var o=0;o<this._sortedComputedProperties.length;o+=1)this._sortedComputedProperties[o].update(this._state,n);for(o=0;o<this._changeHandlers.length;o+=1)this._changeHandlers[o](this._state,n);v(this,this._observers.pre,n,this._state,t);var c=this._dependents.slice();for(o=0;o<c.length;o+=1){var i=c[o],u={};a=!1;for(var l=0;l<i.props.length;l+=1){var h=i.props[l];h in n&&(u["$"+h]=this._state[h],a=!0)}a&&i.component.set(u)}v(this,this._observers.post,n,this._state,t)}}});return{App:q,store:new A({}),data:{chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0}}});

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("svelte/upload",e):t.upload=e()}(this,function(){"use strict";function t(){}function e(t,e){for(var a in e)t[a]=e[a];return t}function a(t,e){e.appendChild(t)}function n(t,e,a){e.insertBefore(t,a)}function r(t){t.parentNode.removeChild(t)}function o(t){for(var e=0;e<t.length;e+=1)t[e]&&t[e].d()}function s(t){return document.createElement(t)}function i(t){return document.createTextNode(t)}function c(t,e,a){t.setAttribute(e,a)}function u(){return Object.create(null)}function d(e){this.destroy=t,this.fire("destroy"),this.set=this.get=t,!1!==e&&this._fragment.u(),this._fragment.d(),this._fragment=this._state=null}function h(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e}function f(t,e){var a=t in this._handlers&&this._handlers[t].slice();if(a)for(var n=0;n<a.length;n+=1){var r=a[n];r.__calling||(r.__calling=!0,r.call(this,e),r.__calling=!1)}}function _(t){return t?this._state[t]:this._state}function p(t,e){t._handlers=u(),t._bind=e._bind,t.options=e,t.root=e.root||t,t.store=t.root.store||e.store}function v(t,e,a){var n=e.bind(this);return a&&!1===a.init||n(this.get()[t],void 0),this.on(a&&a.defer?"update":"state",function(e){e.changed[t]&&n(e.current[t],e.previous&&e.previous[t])})}function m(t,e){if("teardown"===t)return this.on("destroy",e);var a=this._handlers[t]||(this._handlers[t]=[]);return a.push(e),{cancel:function(){var t=a.indexOf(e);~t&&a.splice(t,1)}}}function g(t){for(;t&&t.length;)t.shift()()}var y={destroy:d,get:_,fire:f,observe:v,on:m,set:function(t){this._set(e({},t)),this.root._lock||(this.root._lock=!0,g(this.root._beforecreate),g(this.root._oncreate),g(this.root._aftercreate),this.root._lock=!1)},teardown:d,_recompute:t,_set:function(t){var a=this._state,n={},r=!1;for(var o in t)this._differs(t[o],a[o])&&(n[o]=r=!0);r&&(this._state=e(e({},a),t),this._recompute(n,this._state),this._bind&&this._bind(n,this._state),this._fragment&&(this.fire("state",{changed:n,current:this._state,previous:a}),this._fragment.p(n,this._state),this.fire("update",{changed:n,current:this._state,previous:a})))},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_unmount:function(){this._fragment&&this._fragment.u()},_differs:h};function b(o){var i,c,u,d;p(this,o),this._state=e({placeholder:"Paste your copied data here..."},o.data),this._fragment=(i=this._state,{c:function(){c=s("form"),u=s("div"),d=s("textarea"),this.h()},h:function(){var t,e;d.readOnly=i.readonly,d.id="upload-data-text",t="resize",e="none",d.style.setProperty(t,e),d.placeholder=i.placeholder,d.className="svelte-1sz3211",d.value=i.chartData,u.className="control-group",c.className="upload-form"},m:function(t,e){n(c,t,e),a(u,c),a(d,u)},p:function(t,e){t.readonly&&(d.readOnly=e.readonly),t.placeholder&&(d.placeholder=e.placeholder),t.chartData&&(d.value=e.chartData)},u:function(){r(c)},d:t}),o.target&&(this._fragment.c(),this._mount(o.target,o.anchor))}function x(t,a){for(var i,u,d=a.group,h=(a.each_value,a.group_index,d.datasets),l=[],f=0;f<h.length;f+=1)l[f]=N(t,e(e({},a),{each_value_1:h,dataset:h[f],dataset_index:f}));return{c:function(){i=s("optgroup");for(var t=0;t<l.length;t+=1)l[t].c();this.h()},h:function(){c(i,"label",u=d.type)},m:function(t,e){n(i,t,e);for(var a=0;a<l.length;a+=1)l[a].m(i,null)},p:function(a,n){d=n.group,n.each_value,n.group_index;var r=d.datasets;if(a.datasetsArray){for(var o=0;o<r.length;o+=1){var s=e(e({},n),{each_value_1:r,dataset:r[o],dataset_index:o});l[o]?l[o].p(a,s):(l[o]=N(t,s),l[o].c(),l[o].m(i,null))}for(;o<l.length;o+=1)l[o].u(),l[o].d();l.length=r.length}a.datasetsArray&&u!==(u=d.type)&&c(i,"label",u)},u:function(){r(i);for(var t=0;t<l.length;t+=1)l[t].u()},d:function(){o(l)}}}function N(e,o){o.group,o.each_value,o.group_index;var c,u,d,h=o.dataset,l=(o.each_value_1,o.dataset_index,h.title);return{c:function(){c=s("option"),u=i(l),this.h()},h:function(){c.__value=d=h.id,c.value=c.__value,c.className="demo-dataset"},m:function(t,e){n(c,t,e),a(u,c)},p:function(t,e){e.group,e.each_value,e.group_index,h=e.dataset,e.each_value_1,e.dataset_index,t.datasetsArray&&l!==(l=h.title)&&(u.data=l),t.datasetsArray&&d!==(d=h.id)&&(c.__value=d),c.value=c.__value},u:function(){r(c)},d:t}}function w(t){p(this,t),this._state=e({},t.data),this._recompute({datasets:1},this._state),this._fragment=function(t,c){for(var u,d,h,l,f,_,p,v,m,g,y=c.datasetsArray,b=[],N=0;N<y.length;N+=1)b[N]=x(t,e(e({},c),{each_value:y,group:y[N],group_index:N}));return{c:function(){u=s("p"),d=i("Select your data (including header row/column) in Excel or OpenOffice and paste it in the text field on the right. You can also upload a CSV file from your computer."),h=i("\n\n"),l=s("div"),f=s("p"),_=i("If you just want to try Datawrapper, hereâ€˜s a list of some example datasets you can use:"),p=i("\n    "),v=s("select"),m=s("option"),g=i("Select a sample dataset");for(var t=0;t<b.length;t+=1)b[t].c();this.h()},h:function(){m.__value="Select a sample dataset",m.value=m.__value,v.disabled=c.readonly,v.id="demo-datasets",v.className="",l.className="demo-datasets"},m:function(t,e){n(u,t,e),a(d,u),n(h,t,e),n(l,t,e),a(f,l),a(_,f),a(p,l),a(v,l),a(m,v),a(g,m);for(var r=0;r<b.length;r+=1)b[r].m(v,null)},p:function(a,n){m.value=m.__value;var r=n.datasetsArray;if(a.datasetsArray){for(var o=0;o<r.length;o+=1){var s=e(e({},n),{each_value:r,group:r[o],group_index:o});b[o]?b[o].p(a,s):(b[o]=x(t,s),b[o].c(),b[o].m(v,null))}for(;o<b.length;o+=1)b[o].u(),b[o].d();b.length=r.length}a.readonly&&(v.disabled=n.readonly)},u:function(){r(u),r(h),r(l);for(var t=0;t<b.length;t+=1)b[t].u()},d:function(){o(b)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor))}e(b.prototype,y),e(w.prototype,y),w.prototype._recompute=function(t,e){var a;t.datasets&&this._differs(e.datasetsArray,e.datasetsArray=(a=e.datasets,Object.keys(a).map(function(t){return a[t]})))&&(t.datasetsArray=!0)},e(function(a){var o;p(this,a),this._state=e({},a.data),this._fragment=(this._state,{c:function(){(o=s("button")).textContent="BUTTON"},m:function(t,e){n(o,t,e)},p:t,u:function(){r(o)},d:t}),a.target&&(this._fragment.c(),this._mount(a.target,a.anchor))}.prototype,y);function D(t,e){var o,c,u,d,h,l,f,_=e.btn,p=(e.each_value,e.btn_index,_.title);return{c:function(){o=s("li"),c=s("i"),d=i("\n                        "),h=s("span"),l=i(p),this.h()},h:function(){var a,n;c.className=u=_.icon+" svelte-16m922t",h.className="svelte-16m922t",a="click",n=A,o.addEventListener(a,n,!1),o.className=f="action "+(e.active==_.id?"active":"")+" svelte-16m922t",o._svelte={component:t,each_value:e.each_value,btn_index:e.btn_index}},m:function(t,e){n(o,t,e),a(c,o),a(d,o),a(h,o),a(l,h)},p:function(t,e){_=e.btn,e.each_value,e.btn_index,t.buttons&&u!==(u=_.icon+" svelte-16m922t")&&(c.className=u),t.buttons&&p!==(p=_.title)&&(l.data=p),(t.active||t.buttons)&&f!==(f="action "+(e.active==_.id?"active":"")+" svelte-16m922t")&&(o.className=f),o._svelte.each_value=e.each_value,o._svelte.btn_index=e.btn_index},u:function(){r(o)},d:function(){var t,e;t="click",e=A,o.removeEventListener(t,e,!1)}}}function A(t){var e=this._svelte.component,a=this._svelte.each_value[this._svelte.btn_index];e.btnAction(a)}function C(t){p(this,t),this._state=e({Upload:b,UploadHelp:w,active:"copy",buttons:[{id:"copy",title:"Copy & paste data table",icon:"im im-copy",upload:b,action:function(){}},{id:"upload",title:"Upload CSV/TSV file",icon:"im im-upload",upload:b,action:function(){console.log("upload")}}]},t.data),t.root||(this._oncreate=[],this._beforecreate=[],this._aftercreate=[]),this._fragment=function(t,c){for(var u,d,h,l,f,_,p,v,m,g,y,b,x,N,w,A,C={},k={},P=c.buttons,U=[],O=0;O<P.length;O+=1)U[O]=D(t,e(e({},c),{each_value:P,btn:P[O],btn_index:O}));var E=c.UploadHelp;function S(e){var a={};return"datasets"in e&&(a.datasets=e.datasets,C.datasets=!0),{root:t.root,data:a,_bind:function(e,a){t.get();var n={};!C.datasets&&e.datasets&&(n.datasets=a.datasets),t._set(n),C={}}}}if(E){var j=new E(S(c));t.root._beforecreate.push(function(){j._bind({datasets:1},j.get())})}var H=c.Upload;function T(e){var a={};return"chartData"in e&&(a.chartData=e.chartData,k.chartData=!0),"readonly"in e&&(a.readonly=e.readonly,k.readonly=!0),{root:t.root,data:a,_bind:function(e,a){t.get();var n={};!k.chartData&&e.chartData&&(n.chartData=a.chartData),!k.readonly&&e.readonly&&(n.readonly=a.readonly),t._set(n),k={}}}}if(H){var V=new H(T(c));t.root._beforecreate.push(function(){V._bind({chartData:1,readonly:1},V.get())})}return{c:function(){u=s("div"),d=s("div"),h=s("div"),l=s("div"),(f=s("h3")).textContent="How to you want to upload your data?",_=i("\n\n                "),p=s("ul");for(var t=0;t<U.length;t+=1)U[t].c();v=i("\n\n                "),j&&j._fragment.c(),m=i("\n        "),g=s("div"),V&&V._fragment.c(),y=i("\n\n            "),b=s("div"),x=s("a"),N=i("Proceed"),w=i(" "),A=s("i"),this.h()},h:function(){p.className="import-methods svelte-16m922t",l.className="sidebar",h.className="span5",A.className="icon-chevron-right icon-white",x.href="describe",x.className="submit btn btn-primary",x.id="describe-proceed",b.className="buttons pull-right",g.className="span7",d.className="row",u.className="chart-editor dw-create-upload upload-data"},m:function(t,e){n(u,t,e),a(d,u),a(h,d),a(l,h),a(f,l),a(_,l),a(p,l);for(var r=0;r<U.length;r+=1)U[r].m(p,null);a(v,l),j&&j._mount(l,null),a(m,d),a(g,d),V&&V._mount(g,null),a(y,g),a(b,g),a(x,b),a(N,x),a(w,x),a(A,x)},p:function(a,n){var r=n.buttons;if(a.buttons||a.active){for(var o=0;o<r.length;o+=1){var s=e(e({},n),{each_value:r,btn:r[o],btn_index:o});U[o]?U[o].p(a,s):(U[o]=D(t,s),U[o].c(),U[o].m(p,null))}for(;o<U.length;o+=1)U[o].u(),U[o].d();U.length=r.length}if(E!==(E=n.UploadHelp))j&&j.destroy(),E&&((j=new E(S(n)))._fragment.c(),j._mount(l,null));else{var i={};!C.datasets&&a.datasets&&(i.datasets=n.datasets,C.datasets=!0),j._set(i),C={}}if(H!==(H=n.Upload))V&&V.destroy(),H&&((V=new H(T(n)))._fragment.c(),V._mount(g,y));else{var c={};!k.chartData&&a.chartData&&(c.chartData=n.chartData,k.chartData=!0),!k.readonly&&a.readonly&&(c.readonly=n.readonly,k.readonly=!0),V._set(c),k={}}},u:function(){r(u);for(var t=0;t<U.length;t+=1)U[t].u()},d:function(){o(U),j&&j.destroy(!1),V&&V.destroy(!1)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),this._lock=!0,g(this._beforecreate),g(this._oncreate),g(this._aftercreate),this._lock=!1)}function k(t,a){this._observers={pre:u(),post:u()},this._handlers={},this._dependents=[],this._computed=u(),this._sortedComputedProperties=[],this._state=e({},t),this._differs=a&&a.immutable?l:h}e(C.prototype,y),e(C.prototype,{btnAction:function(t){this.set({active:t.id}),t.action&&t.action(),t.upload&&this.set({Upload:t.upload})}}),e(k.prototype,{_add:function(t,e){this._dependents.push({component:t,props:e})},_init:function(t){for(var e={},a=0;a<t.length;a+=1){var n=t[a];e["$"+n]=this._state[n]}return e},_remove:function(t){for(var e=this._dependents.length;e--;)if(this._dependents[e].component===t)return void this._dependents.splice(e,1)},_sortComputedProperties:function(){var t,e=this._computed,a=this._sortedComputedProperties=[],n=u();function r(o){if(t[o])throw new Error("Cyclical dependency detected");if(!n[o]){n[o]=!0;var s=e[o];s&&(t[o]=!0,s.deps.forEach(r),a.push(s))}}for(var o in this._computed)t=u(),r(o)},compute:function(t,e,a){var n,r=this,o={deps:e,update:function(o,s,i){var c=e.map(function(t){return t in s&&(i=!0),o[t]});if(i){var u=a.apply(null,c);r._differs(u,n)&&(n=u,s[t]=!0,o[t]=n)}}};o.update(this._state,{},!0),this._computed[t]=o,this._sortComputedProperties()},fire:f,get:_,observe:v,on:m,onchange:function(t){return console.warn("store.onchange is deprecated in favour of store.on('state', event => {...})"),this.on("state",function(e){t(e.current,e.changed)})},set:function(t){var a=this._state,n=this._changed={},r=!1;for(var o in t){if(this._computed[o])throw new Error("'"+o+"' is a read-only property");this._differs(t[o],a[o])&&(n[o]=r=!0)}if(r){this._state=e(e({},a),t);for(var s=0;s<this._sortedComputedProperties.length;s+=1)this._sortedComputedProperties[s].update(this._state,n);this.fire("state",{changed:n,current:this._state,previous:a});var i=this._dependents.slice();for(s=0;s<i.length;s+=1){var c=i[s],u={};r=!1;for(var d=0;d<c.props.length;d+=1){var h=c.props[d];h in n&&(u["$"+h]=this._state[h],r=!0)}r&&c.component.set(u)}this.fire("update",{changed:n,current:this._state,previous:a})}}});return{App:C,store:new k({}),data:{chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0}}});

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("svelte/publish",t):e.publish=t()}(this,function(){"use strict";function e(){}function t(e){for(var t,n,s=arguments,i=1,r=arguments.length;i<r;i++)for(t in n=s[i])e[t]=n[t];return e}function n(e,t){t.appendChild(e)}function s(e,t,n){t.insertBefore(e,n)}function i(e){e.parentNode.removeChild(e)}function r(e){for(;e.nextSibling;)e.parentNode.removeChild(e.nextSibling)}function a(e){for(var t=0;t<e.length;t+=1)e[t]&&e[t].d()}function o(e){return document.createElement(e)}function u(e){return document.createTextNode(e)}function c(e,t,n){e.addEventListener(t,n,!1)}function h(e,t,n){e.removeEventListener(t,n,!1)}function l(e,t,n){e.style.setProperty(t,n)}function d(){return Object.create(null)}function p(t){this.destroy=e,this.fire("destroy"),this.set=this.get=e,!1!==t&&this._fragment.u(),this._fragment.d(),this._fragment=this._state=null}function f(e,t){return e!==t||e&&"object"==typeof e||"function"==typeof e}function b(e,t,n,s,i){for(var r in t)if(n[r]){var a=s[r],o=i[r],u=t[r];if(u)for(var c=0;c<u.length;c+=1){var h=u[c];h.__calling||(h.__calling=!0,h.call(e,a,o),h.__calling=!1)}}}function m(e){return e?this._state[e]:this._state}function _(e,t,n){var s=n&&n.defer?this._observers.post:this._observers.pre;return(s[e]||(s[e]=[])).push(t),n&&!1===n.init||(t.__calling=!0,t.call(this,this._state[e]),t.__calling=!1),{cancel:function(){var n=s[e].indexOf(t);~n&&s[e].splice(n,1)}}}function g(e){for(;e&&e.length;)e.pop()()}var v={destroy:p,get:m,fire:function(e,t){var n=e in this._handlers&&this._handlers[e].slice();if(n)for(var s=0;s<n.length;s+=1)n[s].call(this,t)},observe:_,on:function(e,t){if("teardown"===e)return this.on("destroy",t);var n=this._handlers[e]||(this._handlers[e]=[]);return n.push(t),{cancel:function(){var e=n.indexOf(t);~e&&n.splice(e,1)}}},set:function(e){this._set(t({},e)),this.root._lock||(this.root._lock=!0,g(this.root._beforecreate),g(this.root._oncreate),g(this.root._aftercreate),this.root._lock=!1)},teardown:p,_recompute:e,_set:function(e){var n=this._state,s={},i=!1;for(var r in e)f(e[r],n[r])&&(s[r]=i=!0);i&&(this._state=t({},n,e),this._recompute(s,this._state),this._bind&&this._bind(s,this._state),this._fragment&&(b(this,this._observers.pre,s,this._state,n),this._fragment.p(s,this._state),b(this,this._observers.post,s,this._state,n)))},_mount:function(e,t){this._fragment.m(e,t)},_unmount:function(){this._fragment&&this._fragment.u()}};function y(e,t,n,s){window.fetch(e,{credentials:"include",method:t,mode:"cors",body:n}).then(function(e){if(200!=e.status)return new Error(e.statusText);try{return e.json()}catch(t){return e.text()}}).then(s).catch(function(e){console.error(e)})}var w=[100,200,300,400,500,700,800,900,1e3];var N=0;var T={publish:function(){var e=this;if(window.chart.save){var t,n,s,i,r,a=e.get("chart");e.set({publishing:!0,progress:0,publish_error:!1}),a.metadata.publish["embed-heights"]=(e.get("embed_templates"),t={},n=window.$,s=n(n("#iframe-vis")[0].contentDocument),i=n("h1",s).height()+n(".chart-intro",s).height()+n(".dw-chart-notes",s).height(),r=n("#iframe-vis").height(),w.forEach(function(e){s.find("h1,.chart-intro,.dw-chart-notes").css("width",e+"px");var a=n("h1",s).height()+n(".chart-intro",s).height()+n(".dw-chart-notes",s).height();t[e]=r+(a-i)}),s.find("h1,.chart-intro,.dw-chart-notes").css("width","auto"),t),e.set({chart:a}),window.chart.attributes(a).save().then(function(t){y("/api/charts/"+a.id+"/publish","POST",null,function(t){"ok"==t.status?e.publishFinished(t.data):e.set({publish_error:t.message})}),N=0,e.updateStatus()})}else setTimeout(function(){e.publish()},100)},updateProgressBar:function(e){this.refs.bar&&(this.refs.bar.style.width=(100*e).toFixed()+"%")},updateStatus:function(){var e=this,t=e.get("chart");N+=.05,y("/api/charts/"+t.id+"/publish/status","GET",null,function(t){t&&(t=+t/100+N,e.set({progress:Math.min(1,t)})),e.get("publishing")&&setTimeout(function(){e.updateStatus()},400)})},publishFinished:function(e){var t=this;this.set({progress:1,published:!0,needs_republish:!1}),setTimeout(function(){return t.set({publishing:!1})},500),this.set({chart:e}),window.chart.attributes(e)},copy:function(e){var t=this;console.log("COPY",e),t.refs.embedInput.select();try{document.execCommand("copy")&&(t.set({copy_success:!0}),setTimeout(function(){return t.set({copy_success:!1})},300))}catch(e){}}};function L(e){!function(e,t,n){e.setAttribute(t,n)}(e,"svelte-2615052596","")}function H(t,n){var r;return{c:function(){r=o("p")},m:function(e,t){s(r,e,t),r.innerHTML="This chart has been published! If you make changes to the chart you will need to re-publish them."},u:function(){r.innerHTML="",i(r)},d:e}}function M(t,n){var r;return{c:function(){r=o("p"),this.h()},h:function(){l(r,"margin-bottom","20px")},m:function(e,t){s(r,e,t),r.innerHTML="To share or embed your chart you need to publish it. It will only be visible to people who know the chart URL."},u:function(){r.innerHTML="",i(r)},d:e}}function C(t,r){var a,c,h,l,d,p;return{c:function(){a=o("span"),c=o("i"),l=u(" "),d=o("span"),p=u("Re-publish chart"),this.h()},h:function(){L(c),c.className=h="fa fa-fw fa-refresh "+(t.publishing?"fa-spin":""),L(d),d.className="title",a.className="re-publish"},m:function(e,t){s(a,e,t),n(c,a),n(l,a),n(d,a),n(p,d)},p:function(e,t){e.publishing&&h!==(h="fa fa-fw fa-refresh "+(t.publishing?"fa-spin":""))&&(c.className=h)},u:function(){i(a)},d:e}}function k(t,r){var a,c,h,l,d,p;return{c:function(){a=o("span"),c=o("i"),l=u(" "),d=o("span"),p=u("Publish chart"),this.h()},h:function(){L(c),c.className=h="fa fa-fw "+(t.publishing?"fa-refresh fa-spin":"fa-cloud-upload"),L(d),d.className="title",a.className="publish"},m:function(e,t){s(a,e,t),n(c,a),n(l,a),n(d,a),n(p,d)},p:function(e,t){e.publishing&&h!==(h="fa fa-fw "+(t.publishing?"fa-refresh fa-spin":"fa-cloud-upload"))&&(c.className=h)},u:function(){i(a)},d:e}}function x(t,r){var a,c,h,l;return{c:function(){a=o("div"),(c=o("div")).innerHTML='<i class="fa fa-chevron-left"></i>',h=u("\n    "),l=o("div"),this.h()},h:function(){L(a),L(c),c.className="arrow",L(l),l.className="text",a.className="publish-intro"},m:function(e,t){s(a,e,t),n(c,a),n(h,a),n(l,a),l.innerHTML="Click here if you want to embed your chart in your <b>website</b> or <b>CMS</b>."},u:function(){l.innerHTML="",i(a)},d:e}}function U(t,n){var r;return{c:function(){r=o("div"),this.h()},h:function(){L(r),r.className="btn-aside alert"},m:function(e,t){s(r,e,t),r.innerHTML="You have changed the chart after its last publication. To make these changes show up you got to <b>publish the chart again</b>."},u:function(){r.innerHTML="",i(r)},d:e}}function S(t,n){var r;return{c:function(){r=o("div"),this.h()},h:function(){r.className="alert alert-success"},m:function(e,t){s(r,e,t),r.innerHTML="Congratulations, your chart can now be shared and embedded on your site."},u:function(){r.innerHTML="",i(r)},d:e}}function j(t,n){var r;return{c:function(){r=o("div"),this.h()},h:function(){r.className="alert alert-error"},m:function(e,n){s(r,e,n),r.innerHTML=t.publish_error},p:function(e,t){e.publish_error&&(r.innerHTML=t.publish_error)},u:function(){r.innerHTML="",i(r)},d:e}}function E(e,t){var r,a,c,h,l,d,p;return{c:function(){r=o("div"),a=u("Your chart is now being prepared for publication and should be ready in a few seconds."),c=u("\n    "),h=o("div"),l=o("div"),this.h()},h:function(){L(r),L(h),L(l),l.className=d="bar "+(e.progress<1?"":"bar-success"),h.className="progress progress-striped active",r.className=p="alert "+(e.progress<1?"alert-info":"alert-success")+" publishing"},m:function(e,i){s(r,e,i),n(a,r),n(c,r),n(h,r),n(l,h),t.refs.bar=l},p:function(e,t){e.progress&&d!==(d="bar "+(t.progress<1?"":"bar-success"))&&(l.className=d),e.progress&&p!==(p="alert "+(t.progress<1?"alert-info":"alert-success")+" publishing")&&(r.className=p)},u:function(){i(r)},d:function(){t.refs.bar===l&&(t.refs.bar=null)}}}function P(e,t,a,l,d){var p,f,b,m,_,g=a.name;function v(){d.set({shareurl_type:f.__value})}return{c:function(){p=o("label"),f=o("input"),m=u(" "),_=o("noscript"),this.h()},h:function(){L(f),d._bindingGroups[0].push(f),c(f,"change",v),f.__value=b=a.id,f.value=f.__value,f.type="radio",f.name="url-type",p.className="radio"},m:function(t,i){s(p,t,i),n(f,p),f.checked=f.__value===e.shareurl_type,n(m,p),n(_,p),_.insertAdjacentHTML("afterend",g)},p:function(e,t,n,s,i){f.checked=f.__value===t.shareurl_type,e.plugin_shareurls&&b!==(b=s.id)&&(f.__value=b),f.value=f.__value,e.plugin_shareurls&&g!==(g=s.name)&&(r(_),_.insertAdjacentHTML("afterend",g))},u:function(){r(_),i(p)},d:function(){d._bindingGroups[0].splice(d._bindingGroups[0].indexOf(f),1),h(f,"change",v)}}}function G(e,t,a,l,d){var p,f,b,m,_,g=a.title;function v(){d.set({embed_type:f.__value})}return{c:function(){p=o("label"),f=o("input"),m=u(" "),_=o("noscript"),this.h()},h:function(){L(f),d._bindingGroups[1].push(f),c(f,"change",v),f.type="radio",f.__value=b=a.id,f.value=f.__value,p.className="radio"},m:function(t,i){s(p,t,i),n(f,p),f.checked=f.__value===e.embed_type,n(m,p),n(_,p),_.insertAdjacentHTML("afterend",g)},p:function(e,t,n,s,i){f.checked=f.__value===t.embed_type,e.embed_templates&&b!==(b=s.id)&&(f.__value=b),f.value=f.__value,e.embed_templates&&g!==(g=s.title)&&(r(_),_.insertAdjacentHTML("afterend",g))},u:function(){r(_),i(p)},d:function(){d._bindingGroups[1].splice(d._bindingGroups[1].indexOf(f),1),h(f,"change",v)}}}function A(t,a,c,h,l){var d,p,f,b,m,_,g=c.title,v=c.text;return{c:function(){d=o("div"),p=o("b"),f=u(g),b=u(":"),m=u(" "),_=o("noscript")},m:function(e,t){s(d,e,t),n(p,d),n(f,p),n(b,p),n(m,d),n(_,d),_.insertAdjacentHTML("afterend",v)},p:function(e,t,n,s,i){e.embed_templates&&g!==(g=s.title)&&(f.data=g),e.embed_templates&&v!==(v=s.text)&&(r(_),_.insertAdjacentHTML("afterend",v))},u:function(){r(_),i(d)},d:e}}function O(e){return e.published?H:M}function I(e){return e.published?C:k}function D(e){!function(e,t){e._observers={pre:d(),post:d()},e._handlers=d(),e._bind=t._bind,e.options=t,e.root=t.root||e,e.store=e.root.store||t.store}(this,e),this.refs={},this._state=t({},e.data),this._recompute({shareurl_type:1,chart:1,plugin_shareurls:1,published:1,embed_type:1},this._state),this._bindingGroups=[[],[]];var p=function(){var e=this;e.observe("publishing",function(t){t&&e.updateProgressBar(e.get("progress"))}),e.observe("progress",function(t){e.updateProgressBar(t)}),e.observe("embed_type",function(e){var t=window.dw.backend.__userData;e&&t&&(t.embed_type=e,window.dw.backend.setUserData(t))}),e.observe("shareurl_type",function(e){var t=window.dw.backend.__userData;e&&t&&(t.shareurl_type=e,window.dw.backend.setUserData(t))}),e.observe("published",function(e){window.document.querySelector(".dw-create-publish .publish-step").classList[e?"add":"remove"]("is-published")});var t=!0;e.observe("auto_publish",function(n){n&&t&&(e.publish(),t=!1,window.history.replaceState("","",location.pathname))})}.bind(this);e.root?this.root._oncreate.push(p):this._oncreate=[p],this._fragment=function(e,t){var d,p,f,b,m,_,g,v,y,w,N,T,H,M,C,k,D,R,B,z,F,Y,$,q,J,K,Q,V,W,X,Z,ee,te,ne,se,ie,re,ae,oe,ue,ce,he,le,de,pe,fe,be,me,_e,ge,ve,ye,we,Ne,Te,Le,He,Me,Ce,ke,xe,Ue,Se,je=O(e),Ee=je(e,t),Pe=I(e),Ge=Pe(e,t);function Ae(e){t.publish()}var Oe=!e.published&&x(),Ie=e.needs_republish&&!e.publishing&&U(),De=e.published&&!e.needs_republish&&1==e.progress&&!e.publishing&&S(),Re=e.publish_error&&j(e),Be=e.publishing&&E(e,t);function ze(){t.set({shareurl_type:Y.__value})}for(var Fe=e.plugin_shareurls,Ye=[],$e=0;$e<Fe.length;$e+=1)Ye[$e]=P(e,0,Fe[$e],0,t);var qe=e.embed_templates,Je=[];for($e=0;$e<qe.length;$e+=1)Je[$e]=G(e,0,qe[$e],0,t);function Ke(e){var n=t.get();t.copy(n.embedCode)}var Qe=e.embed_templates.slice(2),Ve=[];for($e=0;$e<Qe.length;$e+=1)Ve[$e]=A(0,0,Qe[$e]);return{c:function(){Ee.c(),d=u("\n\n"),p=o("button"),Ge.c(),b=u("\n\n\n"),Oe&&Oe.c(),m=u("\n\n\n"),Ie&&Ie.c(),_=u("\n"),De&&De.c(),g=u("\n\n"),Re&&Re.c(),v=u("\n\n"),Be&&Be.c(),y=u("\n\n"),w=o("div"),N=o("h2"),T=u("\n    "),H=o("div"),M=o("i"),C=u("\n        "),k=o("div"),D=o("div"),R=o("b"),B=u("\n                "),z=o("div"),F=o("label"),Y=o("input"),$=u(" "),q=o("noscript"),J=u("\n                    ");for(var t=0;t<Ye.length;t+=1)Ye[t].c();for(K=u("\n            "),Q=o("div"),V=o("a"),W=u(e.shareUrl),X=u("\n        "),Z=o("div"),(ee=o("span")).textContent="?",te=u("\n            "),ne=o("div"),se=u("\n\n    "),ie=o("div"),re=o("i"),ae=u("\n        "),oe=o("div"),ue=o("div"),ce=o("b"),he=u("\n                "),le=o("div"),t=0;t<Je.length;t+=1)Je[t].c();for(de=u("\n            "),pe=o("div"),fe=o("input"),be=u(" "),me=o("button"),_e=o("i"),ge=u(" "),ve=u("copy"),ye=u("\n                "),we=o("div"),Ne=u("Embed code was copied to clipboard!"),Le=u("\n        "),He=o("div"),(Me=o("span")).textContent="?",Ce=u("\n            "),ke=o("div"),xe=o("noscript"),Ue=u("\n                "),t=0;t<Ve.length;t+=1)Ve[t].c();this.h()},h:function(){L(p),p.disabled=e.publishing,p.className=f="btn-publish btn btn-primary btn-large "+(e.published?"":"btn-first-publish"),c(p,"click",Ae),M.className="icon fa fa-link fa-fw",L(z),L(Y),t._bindingGroups[0].push(Y),c(Y,"change",ze),Y.__value="default",Y.value=Y.__value,Y.type="radio",Y.name="url-type",F.className="radio",z.className="embed-options",D.className="h",L(V),V.target="_blank",V.className="share-url",V.href=e.shareUrl,Q.className="inpt",k.className="ctrls",ne.className="content",Z.className="help",H.className="block",re.className="icon fa fa-code fa-fw",L(le),le.className="embed-options",ue.className="h",fe.type="text",fe.className="input embed-code",fe.readOnly=!0,fe.value=e.embedCode,_e.className="fa fa-copy",me.className="btn btn-copy",me.title="copy",c(me,"click",Ke),L(we),we.className=Te="copy-success "+(e.copy_success?"show":""),pe.className="inpt",oe.className="ctrls",ke.className="content",He.className="help",ie.className="block",l(w,"margin-top","20px"),w.className=Se=e.published?"":"inactive"},m:function(i,r){Ee.m(i,r),s(d,i,r),s(p,i,r),Ge.m(p,null),s(b,i,r),Oe&&Oe.m(i,r),s(m,i,r),Ie&&Ie.m(i,r),s(_,i,r),De&&De.m(i,r),s(g,i,r),Re&&Re.m(i,r),s(v,i,r),Be&&Be.m(i,r),s(y,i,r),s(w,i,r),n(N,w),N.innerHTML="Share & Embed",n(T,w),n(H,w),n(M,H),n(C,H),n(k,H),n(D,k),n(R,D),R.innerHTML="Share via URL",n(B,D),n(z,D),n(F,z),n(Y,F),Y.checked=Y.__value===e.shareurl_type,n($,F),n(q,F),q.insertAdjacentHTML("afterend","fullscreen"),n(J,z);for(var a=0;a<Ye.length;a+=1)Ye[a].m(z,null);for(n(K,k),n(Q,k),n(V,Q),n(W,V),n(X,H),n(Z,H),n(ee,Z),n(te,Z),n(ne,Z),ne.innerHTML="The <b>normal size</b> URL displays the chart exactly the size you created it, and is useful for sharing on social media sites. The <b>fullscreen</b> URL will show your chart sized to fill the entire browser window.",n(se,w),n(ie,w),n(re,ie),n(ae,ie),n(oe,ie),n(ue,oe),n(ce,ue),ce.innerHTML="Copy Embed code",n(he,ue),n(le,ue),a=0;a<Je.length;a+=1)Je[a].m(le,null);for(n(de,oe),n(pe,oe),n(fe,pe),t.refs.embedInput=fe,n(be,pe),n(me,pe),n(_e,me),n(ge,me),n(ve,me),n(ye,pe),n(we,pe),n(Ne,we),n(Le,ie),n(He,ie),n(Me,He),n(Ce,He),n(ke,He),n(xe,ke),xe.insertAdjacentHTML("beforebegin","Copy and paste this HTML code into your website or CMS to embed your chart. The <b>responsive iframe</b> automatically adjusts its height to fit both headline and chart on different devices."),n(Ue,ke),a=0;a<Ve.length;a+=1)Ve[a].m(ke,null)},p:function(e,n){je!==(je=O(n))&&(Ee.u(),Ee.d(),(Ee=je(n,t)).c(),Ee.m(d.parentNode,d)),Pe===(Pe=I(n))&&Ge?Ge.p(e,n):(Ge.u(),Ge.d(),(Ge=Pe(n,t)).c(),Ge.m(p,null)),e.publishing&&(p.disabled=n.publishing),e.published&&f!==(f="btn-publish btn btn-primary btn-large "+(n.published?"":"btn-first-publish"))&&(p.className=f),n.published?Oe&&(Oe.u(),Oe.d(),Oe=null):Oe||((Oe=x()).c(),Oe.m(m.parentNode,m)),n.needs_republish&&!n.publishing?Ie||((Ie=U()).c(),Ie.m(_.parentNode,_)):Ie&&(Ie.u(),Ie.d(),Ie=null),!n.published||n.needs_republish||1!=n.progress||n.publishing?De&&(De.u(),De.d(),De=null):De||((De=S()).c(),De.m(g.parentNode,g)),n.publish_error?Re?Re.p(e,n):((Re=j(n)).c(),Re.m(v.parentNode,v)):Re&&(Re.u(),Re.d(),Re=null),n.publishing?Be?Be.p(e,n):((Be=E(n,t)).c(),Be.m(y.parentNode,y)):Be&&(Be.u(),Be.d(),Be=null),Y.checked=Y.__value===n.shareurl_type;var s=n.plugin_shareurls;if(e.shareurl_type||e.plugin_shareurls){for(var i=0;i<s.length;i+=1)Ye[i]?Ye[i].p(e,n,s,s[i],i):(Ye[i]=P(n,0,s[i],0,t),Ye[i].c(),Ye[i].m(z,null));for(;i<Ye.length;i+=1)Ye[i].u(),Ye[i].d();Ye.length=s.length}e.shareUrl&&(W.data=n.shareUrl,V.href=n.shareUrl);var r=n.embed_templates;if(e.embed_type||e.embed_templates){for(i=0;i<r.length;i+=1)Je[i]?Je[i].p(e,n,r,r[i],i):(Je[i]=G(n,0,r[i],0,t),Je[i].c(),Je[i].m(le,null));for(;i<Je.length;i+=1)Je[i].u(),Je[i].d();Je.length=r.length}e.embedCode&&(fe.value=n.embedCode),e.copy_success&&Te!==(Te="copy-success "+(n.copy_success?"show":""))&&(we.className=Te);var a=n.embed_templates.slice(2);if(e.embed_templates){for(i=0;i<a.length;i+=1)Ve[i]?Ve[i].p(e,n,a,a[i],i):(Ve[i]=A(0,0,a[i]),Ve[i].c(),Ve[i].m(ke,null));for(;i<Ve.length;i+=1)Ve[i].u(),Ve[i].d();Ve.length=a.length}e.published&&Se!==(Se=n.published?"":"inactive")&&(w.className=Se)},u:function(){N.innerHTML="",R.innerHTML="",r(q),ne.innerHTML="",ce.innerHTML="",function(e){for(;e.previousSibling;)e.parentNode.removeChild(e.previousSibling)}(xe),Ee.u(),i(d),i(p),Ge.u(),i(b),Oe&&Oe.u(),i(m),Ie&&Ie.u(),i(_),De&&De.u(),i(g),Re&&Re.u(),i(v),Be&&Be.u(),i(y),i(w);for(var e=0;e<Ye.length;e+=1)Ye[e].u();for(e=0;e<Je.length;e+=1)Je[e].u();for(e=0;e<Ve.length;e+=1)Ve[e].u()},d:function(){Ee.d(),Ge.d(),h(p,"click",Ae),Oe&&Oe.d(),Ie&&Ie.d(),De&&De.d(),Re&&Re.d(),Be&&Be.d(),t._bindingGroups[0].splice(t._bindingGroups[0].indexOf(Y),1),h(Y,"change",ze),a(Ye),a(Je),t.refs.embedInput===fe&&(t.refs.embedInput=null),h(me,"click",Ke),a(Ve)}}}(this._state,this),e.target&&(this._fragment.c(),this._fragment.m(e.target,e.anchor||null),g(this._oncreate))}function R(e){this._observers={pre:d(),post:d()},this._changeHandlers=[],this._dependents=[],this._computed=d(),this._sortedComputedProperties=[],this._state=t({},e)}t(D.prototype,T,v),D.prototype._recompute=function(e,t){var n,s;(e.shareurl_type||e.chart||e.plugin_shareurls||e.published)&&f(t.shareUrl,t.shareUrl=function(e,t,n,s){if(!s)return"https://www.datawrapper.de/...";if("default"==e)return t.publicUrl;var i="";return n.forEach(function(n){n.id==e&&(i=n.url.replace(/%chart_id%/g,t.id))}),i}(t.shareurl_type,t.chart,t.plugin_shareurls,t.published))&&(e.shareUrl=!0),(e.embed_type||e.chart)&&f(t.embedCode,t.embedCode=(n=t.embed_type,(s=t.chart).metadata?s.metadata.publish&&!s.metadata.publish["embed-codes"]?'<iframe src="'+s.publicUrl+'" width="100%" height="'+s.metadata.publish["embed-height"]+'" scrolling="no" frameborder="0" allowtransparency="true"></iframe>':s.metadata.publish["embed-codes"]["embed-method-"+n]:""))&&(e.embedCode=!0)},t(R.prototype,{_add:function(e,t){this._dependents.push({component:e,props:t})},_init:function(e){for(var t={},n=0;n<e.length;n+=1){var s=e[n];t["$"+s]=this._state[s]}return t},_remove:function(e){for(var t=this._dependents.length;t--;)if(this._dependents[t].component===e)return void this._dependents.splice(t,1)},_sortComputedProperties:function(){var e,t=this._computed,n=this._sortedComputedProperties=[],s=d();function i(r){if(e[r])throw new Error("Cyclical dependency detected");if(!s[r]){s[r]=!0;var a=t[r];a&&(e[r]=!0,a.deps.forEach(i),n.push(a))}}for(var r in this._computed)e=d(),i(r)},compute:function(e,t,n){var s,i={deps:t,update:function(i,r,a){var o=t.map(function(e){return e in r&&(a=!0),i[e]});if(a){var u=n.apply(null,o);f(u,s)&&(s=u,r[e]=!0,i[e]=s)}}};i.update(this._state,{},!0),this._computed[e]=i,this._sortComputedProperties()},get:m,observe:_,onchange:function(e){return this._changeHandlers.push(e),{cancel:function(){var t=this._changeHandlers.indexOf(e);~t&&this._changeHandlers.splice(t,1)}}},set:function(e){var n=this._state,s=this._changed={},i=!1;for(var r in e){if(this._computed[r])throw new Error("'"+r+"' is a read-only property");f(e[r],n[r])&&(s[r]=i=!0)}if(i){this._state=t({},n,e);for(var a=0;a<this._sortedComputedProperties.length;a+=1)this._sortedComputedProperties[a].update(this._state,s);for(a=0;a<this._changeHandlers.length;a+=1)this._changeHandlers[a](this._state,s);b(this,this._observers.pre,s,this._state,n);var o=this._dependents.slice();for(a=0;a<o.length;a+=1){var u=o[a],c={};i=!1;for(var h=0;h<u.props.length;h+=1){var l=u.props[h];l in s&&(c["$"+l]=this._state[l],i=!0)}i&&u.component.set(c)}b(this,this._observers.post,s,this._state,n)}}});return{App:D,store:new R({}),data:{chart:{id:""},embed_templates:[],plugin_shareurls:[],published:!1,publishing:!1,needs_republish:!1,publish_error:!1,auto_publish:!1,progress:0,shareurl_type:"default",embed_type:"responsive",copy_success:!1}}});

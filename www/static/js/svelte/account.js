!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("svelte/account",e):(t=t||self).account=e()}(this,(function(){"use strict";function t(){}function e(t,e){for(var n in e)t[n]=e[n];return t}function n(t,e){for(var n in e)t[n]=1;return t}function a(t,e){t.appendChild(e)}function s(t,e,n){t.insertBefore(e,n)}function r(t){t.parentNode.removeChild(t)}function o(t,e){for(var n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function i(t){return document.createElement(t)}function c(t){return document.createTextNode(t)}function l(t,e,n,a){t.addEventListener(e,n,a)}function u(t,e,n,a){t.removeEventListener(e,n,a)}function f(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function d(t,e){t.data=""+e}function m(t,e,n){t.style.setProperty(e,n)}function h(t,e,n){t.classList[n?"add":"remove"](e)}function g(){return Object.create(null)}function p(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function v(t,e){return t!=t?e==e:t!==e}function b(t,e){var n=t in this._handlers&&this._handlers[t].slice();if(n)for(var a=0;a<n.length;a+=1){var s=n[a];if(!s.__calling)try{s.__calling=!0,s.call(this,e)}finally{s.__calling=!1}}}function w(t){t._lock=!0,P(t._beforecreate),P(t._oncreate),P(t._aftercreate),t._lock=!1}function _(){return this._state}function N(t,e){t._handlers=g(),t._slots=g(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}function y(t,e){var n=this._handlers[t]||(this._handlers[t]=[]);return n.push(e),{cancel:function(){var t=n.indexOf(e);~t&&n.splice(t,1)}}}function P(t){for(;t&&t.length;)t.shift()()}var k={destroy:function(e){this.destroy=t,this.fire("destroy"),this.set=t,this._fragment.d(!1!==e),this._fragment=null,this._state={}},get:_,fire:b,on:y,set:function(t){this._set(e({},t)),this.root._lock||w(this.root)},_recompute:t,_set:function(t){var n=this._state,a={},s=!1;for(var r in t=e(this._staged,t),this._staged={},t)this._differs(t[r],n[r])&&(a[r]=s=!0);s&&(this._state=e(e({},n),t),this._recompute(a,this._state),this._bind&&this._bind(a,this._state),this._fragment&&(this.fire("state",{changed:a,current:this._state,previous:n}),this._fragment.p(a,this._state),this.fire("update",{changed:a,current:this._state,previous:n})))},_stage:function(t){e(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:p},E={};function T(t,e){var n=arguments;if(void 0===e&&(e="core"),t=t.trim(),E[e]||function(t){void 0===t&&(t="core"),"chart"===t?window.__dw&&window.__dw.vis&&window.__dw.vis.meta&&(E[t]=window.__dw.vis.meta.locale||{}):E[t]="core"===t?dw.backend.__messages.core:Object.assign({},dw.backend.__messages.core,dw.backend.__messages[t])}(e),!E[e][t])return"MISSING:"+t;var a=E[e][t];return"string"==typeof a&&arguments.length>2&&(a=a.replace(/\$(\d)/g,(function(t,e){return e=2+Number(e),void 0===n[e]?t:n[e]}))),a}function A(t,e,n,a,s){var r={method:e,body:a,mode:"cors",credentials:n};return window.fetch(t,r).then((function(t){if(!t.ok)throw new Error(t.statusText);return t.text()})).then((function(t){try{return JSON.parse(t)}catch(e){return console.warn("malformed json input",t),t}})).then((function(t){return s&&s(t),t})).catch((function(t){console.error(t)}))}function x(t,e,n){return 2===arguments.length&&(n=e,e="include"),A(t,"GET",e,null,n)}function C(t,e,n){return A(t,"PUT","include",e,n)}var H={changeEmail:function(){var t=this,e=this.get(),n=e.email,a=e.userId;this.set({savingEmail:!0}),C("/api/users/"+a,JSON.stringify({email:n}),(function(e){t.set({savingEmail:!1});var a=[],s=[];"error"===e.status&&s.push(e.message),e.data&&e.data.messages&&e.data.messages.forEach((function(t){a.push(t)})),e.data&&e.data.errors&&e.data.errors.forEach((function(t){s.push(t)})),0===s.length?t.set({originalEmail:n,changeEmail:!1,messages:a,errors:[]}):t.set({errors:s})}))},changePassword:function(){var t,e,n,a=this,s=this.get(),r=s.currentPassword,o=s.newPassword1,i=s.newPassword2,c=s.userId,l=(t=o,e=i,""===r?n=dw.backend.messages.provideCurPwd:t.length<4?n=dw.backend.messages.pwdTooShort:t!==e&&(n=dw.backend.messages.pwdMismatch),n||!0);if(!0===l)this.set({savingPassword:!0}),x("/api/auth/salt",(function(t){if("ok"===t.status){var e=t.data.salt,n={oldpwhash:CryptoJS.HmacSHA256(r,e).toString(),pwd:CryptoJS.HmacSHA256(o,e).toString()};C("/api/users/"+c,JSON.stringify(n),(function(t){a.set({savingPassword:!1,currentPassword:"",newPassword1:"",newPassword2:""});var e=[],n=[];"error"===t.status&&n.push(t.message),t.data&&t.data.messages&&t.data.messages.forEach((function(t){e.push(t)})),t.data&&t.data.errors&&t.data.errors.forEach((function(t){n.push(t)})),0===n.length?(e.push("Your password was changed sucessfully"),a.set({changePassword:!1,messages:e,errors:[]})):a.set({errors:n})}))}else a.set({errors:["Could not load salt."],savingPassword:!1})}));else{var u=[l];this.set({errors:u})}},deleteAccount:function(){var t=this,e=this.get().confirmPassword;this.set({deletingAccount:!0}),x("/api/auth/salt",(function(n){if("ok"===n.status){var a=CryptoJS.HmacSHA256(e,n.data.salt).toString();A("/api/users/current?pwd="+a,"DELETE","include",JSON.stringify({pwd:a}),(function(e){t.set({deletingAccount:!1});var n=[];"error"===e.status&&n.push(e.message),e.data&&e.data.messages&&e.data.messages.forEach((function(t){})),e.data&&e.data.errors&&e.data.errors.forEach((function(t){n.push(t)})),0===n.length?t.set({deleteAccount2:!1,deleteAccount3:!0}):t.set({errors:n})}))}else t.set({errors:["Could not load salt."],deletingAccount:!1})}))}};function L(t){var e=t.changed,n=t.current,a=t.previous;e.email&&!a&&this.set({originalEmail:n.email})}function S(t,e,n){var a=Object.create(t);return a.message=e[n],a}function M(t,e,n){var a=Object.create(t);return a.message=e[n],a}function O(t,e,n){var a=Object.create(t);return a.message=e[n],a}function j(t,e,n){var a=Object.create(t);return a.message=e[n],a}function q(t,e){var n,o,l,u,f=T("Edit profile");function d(t){return t.changePassword?D:t.deleteAccount?B:t.deleteAccount2?F:t.deleteAccount3?Y:t.changeEmail?J:I}var m=d(e),h=m(t,e);return{c:function(){n=i("h2"),o=c(f),l=c("\n\n\n"),h.c(),u=document.createComment("")},m:function(t,e){s(t,n,e),a(n,o),s(t,l,e),h.m(t,e),s(t,u,e)},p:function(e,n){m===(m=d(n))&&h?h.p(e,n):(h.d(1),(h=m(t,n)).c(),h.m(u.parentNode,u))},d:function(t){t&&(r(n),r(l)),h.d(t),t&&r(u)}}}function I(t,e){var n,o,d,h,g,p,v,b,w,_,N,y,P,k,E,A,x,C,H,L,S,M,O,j,q,I,J,Y,F,B,D,$,z,R,U,K,Q,V=T("E-Mail"),W=T("account / email"),X=T("Password"),Z=T("account / password"),tt=T("account / or"),et=T("account / delete"),nt=T("account / change-login"),at=e.messages&&e.messages.length&&G(t,e);function st(e){t.set({changeEmail:!0})}function rt(e){t.set({changePassword:!0})}function ot(e){t.set({deleteAccount:!0})}return{c:function(){at&&at.c(),n=c("\n\n"),o=i("div"),d=i("div"),h=i("div"),g=i("div"),p=c(V),v=c(":"),b=c("\n            "),w=i("div"),_=i("input"),y=c("\n            "),P=i("div"),k=i("button"),E=c(W),A=c("\n\n        "),x=i("div"),C=i("div"),H=c(X),L=c(":"),S=c("\n            "),(M=i("div")).innerHTML='<input disabled="" value="abcdefgh" type="password">',O=c("\n            "),j=i("div"),q=i("button"),I=c(Z),J=c("\n\n        "),Y=i("div"),F=c(tt),B=c("\n            "),D=i("span"),$=c(et),z=c("."),R=c("\n    "),U=i("div"),K=i("p"),Q=c(nt),g.className="svelte-1gfuyl2",_.disabled=N=!e.changeEmail,_.value=e.originalEmail,f(_,"type","text"),w.className="svelte-1gfuyl2",l(k,"click",st),k.className="btn btn-save btn-default",P.className="svelte-1gfuyl2",h.className="svelte-1gfuyl2",C.className="svelte-1gfuyl2",M.className="svelte-1gfuyl2",l(q,"click",rt),q.className="btn btn-save btn-default",j.className="svelte-1gfuyl2",x.className="svelte-1gfuyl2",l(D,"click",ot),D.className="link svelte-1gfuyl2",f(D,"href","#"),m(Y,"text-align","center"),m(Y,"display","block"),Y.className="svelte-1gfuyl2",d.className="span6",K.className="help",U.className="span4",o.className="row edit-account svelte-1gfuyl2",m(o,"margin-top",(e.messages&&e.messages.length?0:20)+"px")},m:function(t,e){at&&at.m(t,e),s(t,n,e),s(t,o,e),a(o,d),a(d,h),a(h,g),a(g,p),a(g,v),a(h,b),a(h,w),a(w,_),a(h,y),a(h,P),a(P,k),a(k,E),a(d,A),a(d,x),a(x,C),a(C,H),a(C,L),a(x,S),a(x,M),a(x,O),a(x,j),a(j,q),a(q,I),a(d,J),a(d,Y),a(Y,F),a(Y,B),a(Y,D),a(D,$),a(Y,z),a(o,R),a(o,U),a(U,K),a(K,Q)},p:function(e,a){a.messages&&a.messages.length?at?at.p(e,a):((at=G(t,a)).c(),at.m(n.parentNode,n)):at&&(at.d(1),at=null),e.changeEmail&&N!==(N=!a.changeEmail)&&(_.disabled=N),e.originalEmail&&(_.value=a.originalEmail),e.messages&&m(o,"margin-top",(a.messages&&a.messages.length?0:20)+"px")},d:function(t){at&&at.d(t),t&&(r(n),r(o)),u(k,"click",st),u(q,"click",rt),u(D,"click",ot)}}}function J(t,e){var n,o,d,h,g,p,v,b,w,_,N,y,P,k,E,A,x,C,H,L,S,M,O,j,q,I,J,Y,F,B=T("account / email"),D=T("account / confirm-email-change"),G=T("E-Mail"),$=!1,R=T("Back"),U=T("account / email"),K=e.errors&&e.errors.length&&z(t,e);function Q(){$=!0,t.set({email:C.value}),$=!1}function V(e){t.set({changeEmail:!1})}function W(e){t.changeEmail()}return{c:function(){n=i("div"),o=i("div"),d=i("div"),h=i("h2"),g=c(B),p=c("\n            "),v=i("p"),b=c(D),w=c("\n\n            "),K&&K.c(),_=c("\n\n            "),N=i("fieldset"),y=i("div"),P=i("label"),k=c(G),E=c(":"),A=c("\n                    "),x=i("div"),C=i("input"),L=c("\n\n                "),S=i("div"),M=i("button"),O=c(R),j=c("\n                    "),q=i("button"),I=i("i"),Y=c("Â  "),F=c(U),P.className="control-label",P.htmlFor="email",l(C,"input",Q),C.disabled=H=!e.changeEmail,f(C,"type","text"),x.className="controls",y.className="control-group",l(M,"click",V),M.className="btn btn-default",I.className=J="fa "+(e.savingEmail?"fa-spin fa-spinner":"fa-check")+" svelte-1gfuyl2",l(q,"click",W),m(q,"float","right"),q.className="btn btn-save btn-primary",S.className="",d.className="form-horizontal edit-account",o.className="span6 offset3",n.className="row"},m:function(t,r){s(t,n,r),a(n,o),a(o,d),a(d,h),a(h,g),a(d,p),a(d,v),a(v,b),a(d,w),K&&K.m(d,null),a(d,_),a(d,N),a(N,y),a(y,P),a(P,k),a(P,E),a(y,A),a(y,x),a(x,C),C.value=e.email,a(N,L),a(N,S),a(S,M),a(M,O),a(S,j),a(S,q),a(q,I),a(q,Y),a(q,F)},p:function(e,n){n.errors&&n.errors.length?K?K.p(e,n):((K=z(t,n)).c(),K.m(d,_)):K&&(K.d(1),K=null),!$&&e.email&&(C.value=n.email),e.changeEmail&&H!==(H=!n.changeEmail)&&(C.disabled=H),e.savingEmail&&J!==(J="fa "+(n.savingEmail?"fa-spin fa-spinner":"fa-check")+" svelte-1gfuyl2")&&(I.className=J)},d:function(t){t&&r(n),K&&K.d(),u(C,"input",Q),u(M,"click",V),u(q,"click",W)}}}function Y(e,n){var o,l,u,f,d,h,g,p=T("Your account has been deleted."),v=T("Goodbye!");return{c:function(){o=i("div"),l=i("div"),u=i("h2"),f=c(p),d=c("\n        "),h=i("a"),g=c(v),m(u,"margin-bottom","20px"),u.className="svelte-1gfuyl2",h.href="/",h.className="btn btn-primary btn-large",l.className="span6 offset3",o.className="row delete-account svelte-1gfuyl2"},m:function(t,e){s(t,o,e),a(o,l),a(l,u),a(u,f),a(l,d),a(l,h),a(h,g)},p:t,d:function(t){t&&r(o)}}}function F(t,e){var n,o,d,h,g,p,v,b,w,_,N,y,P,k,E,A,x,C,H,L,S,M,O,j,q,I,J,Y,F,B,D,G,$,z,R,K,Q,V,W,X,Z,tt,et,nt=T("account / delete / hed"),at=T("account / delete / really"),st=T("account / confirm-account-deletion / free"),rt=T("You cannot login and logout anymore."),ot=T("You cannot edit or remove your charts anymore."),it=T("account / delete / charts-stay-online"),ct=T("Please enter your password to confirm the deletion request:"),lt=!1,ut=T("account / delete / really-really"),ft=T("No, I changed my mind.."),dt=T("Yes, delete it!"),mt=e.errors&&e.errors.length&&U(t,e);function ht(){lt=!0,t.set({confirmPassword:F.value}),lt=!1}function gt(e){t.set({deleteAccount2:!1})}function pt(e){t.deleteAccount()}return{c:function(){n=i("div"),o=i("div"),d=i("h2"),h=c(nt),g=c("\n\n        "),mt&&mt.c(),p=c("\n\n        "),v=i("p"),b=c(at),w=c("\n        "),_=i("ul"),N=i("li"),y=c(st),P=c("\n            "),k=i("li"),E=c(rt),A=c("\n            "),x=i("li"),C=c(ot),H=c("\n        "),L=i("p"),S=c(it),M=c("\n        "),O=i("div"),j=i("p"),q=i("b"),I=c(ct),J=c("\n            "),Y=i("div"),F=i("input"),B=c("\n            "),D=i("p"),G=c("\n            "),$=i("div"),z=i("button"),R=i("i"),K=c("Â  "),Q=c(ft),V=c("\n                "),W=i("button"),X=i("i"),tt=c("Â  "),et=c(dt),m(d,"margin-bottom","20px"),d.className="svelte-1gfuyl2",l(F,"input",ht),f(F,"type","password"),F.placeholder=T("Password"),Y.className="control-group",R.className="fa fa-chevron-left",l(z,"click",gt),z.className="btn btn-info",X.className=Z="fa "+(e.deletingAccount?"fa-spin fa-spinner":"fa-check")+" svelte-1gfuyl2",l(W,"click",pt),m(W,"float","right"),W.className="btn btn-danger",$.className="control-group",O.className="",o.className="span6 offset3",n.className="row delete-account svelte-1gfuyl2"},m:function(t,r){s(t,n,r),a(n,o),a(o,d),a(d,h),a(o,g),mt&&mt.m(o,null),a(o,p),a(o,v),a(v,b),a(o,w),a(o,_),a(_,N),a(N,y),a(_,P),a(_,k),a(k,E),a(_,A),a(_,x),a(x,C),a(o,H),a(o,L),a(L,S),a(o,M),a(o,O),a(O,j),a(j,q),a(q,I),a(O,J),a(O,Y),a(Y,F),F.value=e.confirmPassword,a(O,B),a(O,D),D.innerHTML=ut,a(O,G),a(O,$),a($,z),a(z,R),a(z,K),a(z,Q),a($,V),a($,W),a(W,X),a(W,tt),a(W,et)},p:function(e,n){n.errors&&n.errors.length?mt?mt.p(e,n):((mt=U(t,n)).c(),mt.m(o,p)):mt&&(mt.d(1),mt=null),!lt&&e.confirmPassword&&(F.value=n.confirmPassword),e.deletingAccount&&Z!==(Z="fa "+(n.deletingAccount?"fa-spin fa-spinner":"fa-check")+" svelte-1gfuyl2")&&(X.className=Z)},d:function(t){t&&r(n),mt&&mt.d(),u(F,"input",ht),u(z,"click",gt),u(W,"click",pt)}}}function B(e,n){var o,f,d,h,g,p,v,b,w,_,N,y,P,k,E,A,x,C,H,L,S=T("account / confirm-account-deletion"),M=T("account / confirm-account-deletion / no"),O=T("account / or"),j=T("account / confirm-account-deletion / yes");function q(t){e.set({deleteAccount:!1})}function I(t){e.set({deleteAccount:!1,deleteAccount2:!0})}return{c:function(){o=i("div"),f=i("div"),(d=i("div")).innerHTML='<i class="fa fa-times"></i>',h=c("\n\n        "),g=i("h2"),p=c(S),v=c("\n\n        "),b=i("div"),w=i("button"),_=i("i"),N=c(" Â  "),y=c(M),P=c("\n\n            "),k=i("div"),E=c(O),A=c("\n\n            "),x=i("button"),C=i("i"),H=c(" Â  "),L=c(j),d.className="iconholder svelte-1gfuyl2",m(g,"margin-bottom","20px"),g.className="svelte-1gfuyl2",_.className="fa fa-chevron-left",l(w,"click",q),w.className="btn btn-back btn-primary",m(k,"display","block"),m(k,"margin","0px 10px"),C.className="fa fa-times",l(x,"click",I),x.className="btn btn-default",m(b,"display","flex"),m(b,"justify-content","center"),m(b,"align-items","center"),f.className="span6 offset3",o.className="row delete-account svelte-1gfuyl2"},m:function(t,e){s(t,o,e),a(o,f),a(f,d),a(f,h),a(f,g),a(g,p),a(f,v),a(f,b),a(b,w),a(w,_),a(w,N),a(w,y),a(b,P),a(b,k),a(k,E),a(b,A),a(b,x),a(x,C),a(x,H),a(x,L)},p:t,d:function(t){t&&r(o),u(w,"click",q),u(x,"click",I)}}}function D(t,e){var n,o,d,h,g,p,v,b,w,_,N,y,P,k,E,A,x,C,H,L,S,M,O,j,q,I,J,Y,F,B,D,G,$,z,R,U,K,V,W,X,Z,tt,et,nt,at=T("account / password"),st=T("account / password / strong-password-note"),rt=T("Current Password"),ot=!1,it=T("account / password / current-password-note"),ct=T("New Password"),lt=!1,ut=T("(repeat)"),ft=!1,dt=T("Back"),mt=T("account / password"),ht=e.errors&&e.errors.length&&Q(t,e);function gt(){ot=!0,t.set({currentPassword:x.value}),ot=!1}function pt(){lt=!0,t.set({newPassword1:J.value}),lt=!1}function vt(){ft=!0,t.set({newPassword2:z.value}),ft=!1}function bt(e){t.set({changePassword:!1})}function wt(e){t.changePassword()}return{c:function(){n=i("div"),o=i("div"),d=i("div"),h=i("h2"),g=c(at),p=c("\n            "),v=i("p"),b=c(st),w=c("\n\n            "),ht&&ht.c(),_=c("\n\n            "),N=i("fieldset"),y=i("div"),P=i("label"),k=c(rt),E=c("\n                    "),A=i("div"),x=i("input"),C=c("\n                        "),H=i("p"),L=c(it),S=c("\n                "),M=i("div"),O=i("label"),j=c(ct),q=c("\n                    "),I=i("div"),J=i("input"),Y=c("\n                "),F=i("div"),B=i("label"),D=c(ut),G=c("\n                    "),$=i("div"),z=i("input"),R=c("\n\n                "),U=i("div"),K=i("button"),V=c(dt),W=c("\n                    "),X=i("button"),Z=i("i"),et=c("Â  "),nt=c(mt),P.className="control-label",l(x,"input",gt),f(x,"type","password"),x.className="input-xlarge",H.className="help-block",A.className="controls",y.className="control-group",O.className="control-label",l(J,"input",pt),f(J,"type","password"),J.className="input-xlarge",I.className="controls",M.className="control-group",B.className="control-label",l(z,"input",vt),f(z,"type","password"),z.className="input-xlarge",$.className="controls",F.className="control-group",l(K,"click",bt),K.className="btn btn-save btn-default btn-back",Z.className=tt="fa "+(e.savingPassword?"fa-spin fa-spinner":"fa-check")+" svelte-1gfuyl2",l(X,"click",wt),X.className="btn btn-primary",m(X,"float","right"),d.className="form-horizontal edit-account-confirm",o.className="span6 offset3",n.className="row"},m:function(t,r){s(t,n,r),a(n,o),a(o,d),a(d,h),a(h,g),a(d,p),a(d,v),a(v,b),a(d,w),ht&&ht.m(d,null),a(d,_),a(d,N),a(N,y),a(y,P),a(P,k),a(y,E),a(y,A),a(A,x),x.value=e.currentPassword,a(A,C),a(A,H),a(H,L),a(N,S),a(N,M),a(M,O),a(O,j),a(M,q),a(M,I),a(I,J),J.value=e.newPassword1,a(N,Y),a(N,F),a(F,B),a(B,D),a(F,G),a(F,$),a($,z),z.value=e.newPassword2,a(N,R),a(N,U),a(U,K),a(K,V),a(U,W),a(U,X),a(X,Z),a(X,et),a(X,nt)},p:function(e,n){n.errors&&n.errors.length?ht?ht.p(e,n):((ht=Q(t,n)).c(),ht.m(d,_)):ht&&(ht.d(1),ht=null),!ot&&e.currentPassword&&(x.value=n.currentPassword),!lt&&e.newPassword1&&(J.value=n.newPassword1),!ft&&e.newPassword2&&(z.value=n.newPassword2),e.savingPassword&&tt!==(tt="fa "+(n.savingPassword?"fa-spin fa-spinner":"fa-check")+" svelte-1gfuyl2")&&(Z.className=tt)},d:function(t){t&&r(n),ht&&ht.d(),u(x,"input",gt),u(J,"input",pt),u(z,"input",vt),u(K,"click",bt),u(X,"click",wt)}}}function G(t,e){for(var n,c,l,u,f=e.messages,d=[],h=0;h<f.length;h+=1)d[h]=$(t,S(e,f,h));return{c:function(){n=i("div"),c=i("div"),l=i("div"),u=i("ul");for(var t=0;t<d.length;t+=1)d[t].c();m(u,"margin-bottom","0"),l.className="alert alert-success",c.className="span6 offset3",n.className="row",m(n,"margin-top","20px")},m:function(t,e){s(t,n,e),a(n,c),a(c,l),a(l,u);for(var r=0;r<d.length;r+=1)d[r].m(u,null)},p:function(e,n){if(e.messages){f=n.messages;for(var a=0;a<f.length;a+=1){var s=S(n,f,a);d[a]?d[a].p(e,s):(d[a]=$(t,s),d[a].c(),d[a].m(u,null))}for(;a<d.length;a+=1)d[a].d(1);d.length=f.length}},d:function(t){t&&r(n),o(d,t)}}}function $(t,e){var n,a=e.message;return{c:function(){n=i("li")},m:function(t,e){s(t,n,e),n.innerHTML=a},p:function(t,e){t.messages&&a!==(a=e.message)&&(n.innerHTML=a)},d:function(t){t&&r(n)}}}function z(t,e){for(var n,c,l=e.errors,u=[],f=0;f<l.length;f+=1)u[f]=R(t,M(e,l,f));return{c:function(){n=i("div"),c=i("ul");for(var t=0;t<u.length;t+=1)u[t].c();m(c,"margin-bottom","0"),n.className="alert"},m:function(t,e){s(t,n,e),a(n,c);for(var r=0;r<u.length;r+=1)u[r].m(c,null)},p:function(e,n){if(e.errors){l=n.errors;for(var a=0;a<l.length;a+=1){var s=M(n,l,a);u[a]?u[a].p(e,s):(u[a]=R(t,s),u[a].c(),u[a].m(c,null))}for(;a<u.length;a+=1)u[a].d(1);u.length=l.length}},d:function(t){t&&r(n),o(u,t)}}}function R(t,e){var n,a=e.message;return{c:function(){n=i("li")},m:function(t,e){s(t,n,e),n.innerHTML=a},p:function(t,e){t.errors&&a!==(a=e.message)&&(n.innerHTML=a)},d:function(t){t&&r(n)}}}function U(t,e){for(var n,c,l=e.errors,u=[],f=0;f<l.length;f+=1)u[f]=K(t,O(e,l,f));return{c:function(){n=i("div"),c=i("ul");for(var t=0;t<u.length;t+=1)u[t].c();m(c,"margin-bottom","0"),n.className="alert"},m:function(t,e){s(t,n,e),a(n,c);for(var r=0;r<u.length;r+=1)u[r].m(c,null)},p:function(e,n){if(e.errors){l=n.errors;for(var a=0;a<l.length;a+=1){var s=O(n,l,a);u[a]?u[a].p(e,s):(u[a]=K(t,s),u[a].c(),u[a].m(c,null))}for(;a<u.length;a+=1)u[a].d(1);u.length=l.length}},d:function(t){t&&r(n),o(u,t)}}}function K(t,e){var n,a=e.message;return{c:function(){n=i("li")},m:function(t,e){s(t,n,e),n.innerHTML=a},p:function(t,e){t.errors&&a!==(a=e.message)&&(n.innerHTML=a)},d:function(t){t&&r(n)}}}function Q(t,e){for(var n,c,l=e.errors,u=[],f=0;f<l.length;f+=1)u[f]=V(t,j(e,l,f));return{c:function(){n=i("div"),c=i("ul");for(var t=0;t<u.length;t+=1)u[t].c();m(c,"margin-bottom","0"),n.className="alert"},m:function(t,e){s(t,n,e),a(n,c);for(var r=0;r<u.length;r+=1)u[r].m(c,null)},p:function(e,n){if(e.errors){l=n.errors;for(var a=0;a<l.length;a+=1){var s=j(n,l,a);u[a]?u[a].p(e,s):(u[a]=V(t,s),u[a].c(),u[a].m(c,null))}for(;a<u.length;a+=1)u[a].d(1);u.length=l.length}},d:function(t){t&&r(n),o(u,t)}}}function V(t,e){var n,a=e.message;return{c:function(){n=i("li")},m:function(t,e){s(t,n,e),n.innerHTML=a},p:function(t,e){t.errors&&a!==(a=e.message)&&(n.innerHTML=a)},d:function(t){t&&r(n)}}}function W(t){var a=this;N(this,t),this._state=e({changePassword:!1,changeEmail:!1,deleteAccount:!1,showPasswordInPlaintext:!1,messages:[],currentPassword:"",newPassword1:"",newPassword2:"",confirmPassword:"",groups:[{title:"Account settings",tabs:[{title:"Profile",icon:"fa fa-fw fa-user"}]},{title:"Team settings",tabs:[]}]},t.data),this._intro=!0,this._handlers.state=[L],L.call(this,{changed:n({},this._state),current:this._state}),this._fragment=q(this,this._state),this.root._oncreate.push((function(){a.fire("update",{changed:n({},a._state),current:a._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),w(this))}e(W.prototype,k),e(W.prototype,H);var X={title:"Profile",id:"profile",icon:"fa fa-fw fa-user",ui:W};var Z={activateTab:function(t,e){t.ui&&(e.preventDefault(),this.set({activeTab:t}))},addTab:function(t){var e=this.get(),n=e.groups,a=e.wasLookingFor;console.log("groups",n),n[0].tabs.push(t),a&&t.id===a&&this.set({activeTab:t,wasLookingFor:null}),this.set({groups:n})}};function tt(){var t=this,e=window.location.pathname.split("/").slice(1)[1]||"profile";dw.backend.__svelteApps.account=this;var n=this.get().groups,a=!1;n.forEach((function(n){n.tabs.forEach((function(n){n.id===e&&(t.set({activeTab:n}),a=!0)}))})),a||this.set({activeTab:X,wasLookingFor:e})}function et(t){var e=t.changed,n=t.current;e.activeTab&&n.activeTab&&(console.log(n.activeTab),window.history.pushState({id:n.activeTab.id},"","/account/"+n.activeTab.id))}function nt(t){var e=this._svelte,n=e.component,a=e.ctx;n.activateTab(a.tab,t)}function at(t,e,n){var a=Object.create(t);return a.tab=e[n],a}function st(t,e,n){var a=Object.create(t);return a.group=e[n],a}function rt(t,e){var n,o,f,m,g,p,v,b=e.tab.title;return{c:function(){n=i("li"),o=i("a"),f=i("i"),g=c(" Â  "),p=c(b),f.className=m=e.tab.icon+" svelte-yq9vlw",o._svelte={component:t,ctx:e},l(o,"click",nt),o.href=v=e.tab.url||"/account/"+e.tab.id,o.className="svelte-yq9vlw",n.className="svelte-yq9vlw",h(n,"active",e.activeTab===e.tab)},m:function(t,e){s(t,n,e),a(n,o),a(o,f),a(o,g),a(o,p)},p:function(t,a){e=a,t.groups&&m!==(m=e.tab.icon+" svelte-yq9vlw")&&(f.className=m),t.groups&&b!==(b=e.tab.title)&&d(p,b),o._svelte.ctx=e,t.groups&&v!==(v=e.tab.url||"/account/"+e.tab.id)&&(o.href=v),(t.activeTab||t.groups)&&h(n,"active",e.activeTab===e.tab)},d:function(t){t&&r(n),u(o,"click",nt)}}}function ot(t,e){for(var n,l,u,f,m=e.group.title,h=e.group.tabs,g=[],p=0;p<h.length;p+=1)g[p]=rt(t,at(e,h,p));return{c:function(){n=i("div"),l=c(m),u=c("\n\n            "),f=i("ul");for(var t=0;t<g.length;t+=1)g[t].c();n.className="group svelte-yq9vlw",f.className="nav nav-stacked nav-tabs"},m:function(t,e){s(t,n,e),a(n,l),s(t,u,e),s(t,f,e);for(var r=0;r<g.length;r+=1)g[r].m(f,null)},p:function(e,n){if(e.groups&&m!==(m=n.group.title)&&d(l,m),e.activeTab||e.groups){h=n.group.tabs;for(var a=0;a<h.length;a+=1){var s=at(n,h,a);g[a]?g[a].p(e,s):(g[a]=rt(t,s),g[a].c(),g[a].m(f,null))}for(;a<g.length;a+=1)g[a].d(1);g.length=h.length}},d:function(t){t&&(r(n),r(u),r(f)),o(g,t)}}}function it(t,e){var n,a,o=e.activeTab.ui;function c(e){return{root:t.root,store:t.store}}if(o)var l=new o(c());return{c:function(){n=i("div"),l&&l._fragment.c(),n.className=a="span10 account-page-content tab-"+e.activeTab.id+" svelte-yq9vlw"},m:function(t,e){s(t,n,e),l&&l._mount(n,null)},p:function(t,e){o!==(o=e.activeTab.ui)&&(l&&l.destroy(),o?((l=new o(c()))._fragment.c(),l._mount(n,null)):l=null),t.activeTab&&a!==(a="span10 account-page-content tab-"+e.activeTab.id+" svelte-yq9vlw")&&(n.className=a)},d:function(t){t&&r(n),l&&l.destroy()}}}function ct(t){var l=this;N(this,t),this._state=e({hash:"profile",activeTab:null,groups:[{title:"Account settings",tabs:[X]},{title:"Team settings",tabs:[{title:"Create team",icon:"fa fa-fw fa-plus",url:"/team/new/setup"}]}]},t.data),this._intro=!0,this._handlers.state=[et],et.call(this,{changed:n({},this._state),current:this._state}),this._fragment=function(t,e){for(var n,l,u,f,d,m,h=e.groups,g=[],p=0;p<h.length;p+=1)g[p]=ot(t,st(e,h,p));var v=e.activeTab&&it(t,e);return{c:function(){n=i("div"),(l=i("h1")).textContent="Settings",u=c("\n\n    "),f=i("div"),d=i("div");for(var t=0;t<g.length;t+=1)g[t].c();m=c("\n        "),v&&v.c(),l.className="title",d.className="span2 svelte-yq9vlw",f.className="row",n.className="admin"},m:function(t,e){s(t,n,e),a(n,l),a(n,u),a(n,f),a(f,d);for(var r=0;r<g.length;r+=1)g[r].m(d,null);a(f,m),v&&v.m(f,null)},p:function(e,n){if(e.groups||e.activeTab){h=n.groups;for(var a=0;a<h.length;a+=1){var s=st(n,h,a);g[a]?g[a].p(e,s):(g[a]=ot(t,s),g[a].c(),g[a].m(d,null))}for(;a<g.length;a+=1)g[a].d(1);g.length=h.length}n.activeTab?v?v.p(e,n):((v=it(t,n)).c(),v.m(f,null)):v&&(v.d(1),v=null)},d:function(t){t&&r(n),o(g,t),v&&v.d()}}}(this,this._state),this.root._oncreate.push((function(){tt.call(l),l.fire("update",{changed:n({},l._state),current:l._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),w(this))}function lt(t,n){this._handlers={},this._dependents=[],this._computed=g(),this._sortedComputedProperties=[],this._state=e({},t),this._differs=n&&n.immutable?v:p}e(ct.prototype,k),e(ct.prototype,Z),e(lt.prototype,{_add:function(t,e){this._dependents.push({component:t,props:e})},_init:function(t){for(var e={},n=0;n<t.length;n+=1){var a=t[n];e["$"+a]=this._state[a]}return e},_remove:function(t){for(var e=this._dependents.length;e--;)if(this._dependents[e].component===t)return void this._dependents.splice(e,1)},_set:function(t,n){var a=this,s=this._state;this._state=e(e({},s),t);for(var r=0;r<this._sortedComputedProperties.length;r+=1)this._sortedComputedProperties[r].update(this._state,n);this.fire("state",{changed:n,previous:s,current:this._state}),this._dependents.filter((function(t){for(var e={},s=!1,r=0;r<t.props.length;r+=1){var o=t.props[r];o in n&&(e["$"+o]=a._state[o],s=!0)}if(s)return t.component._stage(e),!0})).forEach((function(t){t.component.set({})})),this.fire("update",{changed:n,previous:s,current:this._state})},_sortComputedProperties:function(){var t,e=this._computed,n=this._sortedComputedProperties=[],a=g();function s(r){var o=e[r];o&&(o.deps.forEach((function(e){if(e===t)throw new Error("Cyclical dependency detected between "+e+" <-> "+r);s(e)})),a[r]||(a[r]=!0,n.push(o)))}for(var r in this._computed)s(t=r)},compute:function(t,n,a){var s,r=this,o={deps:n,update:function(e,o,i){var c=n.map((function(t){return t in o&&(i=!0),e[t]}));if(i){var l=a.apply(null,c);r._differs(l,s)&&(s=l,o[t]=!0,e[t]=s)}}};this._computed[t]=o,this._sortComputedProperties();var i=e({},this._state),c={};o.update(i,c,!0),this._set(i,c)},fire:b,get:_,on:y,set:function(t){var e=this._state,n=this._changed={},a=!1;for(var s in t){if(this._computed[s])throw new Error("'"+s+"' is a read-only computed property");this._differs(t[s],e[s])&&(n[s]=a=!0)}a&&this._set(t,n)}});return{App:ct,data:{chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0},store:new lt({})}}));

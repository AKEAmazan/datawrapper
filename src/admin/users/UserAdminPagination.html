<div class="pagination">
    <ul>
        {#each items as item}
        <li class="{item.active ? 'active' : ''}">
            <a href="{item.href}" on:click="navigate(event, item.state)">{item.text}</a>
        </li>
        {/each}
    </ul>
</div>

<script>
    import { stringify } from 'query-string';

    export default {
        computed: {
            items: ({ pages, url, currentPageNum }) => {
                const firstItem = pages[0].state;
                const lastItem = pages[pages.length - 1].state;
                const getUrl = url || (state => `?${stringify(state)}`);

                return [
                    {
                        text: '«',
                        href: getUrl(firstItem),
                        active: currentPageNum === 0,
                        state: firstItem
                    },
                    ...pages.map(({ state }, i) => ({
                        text: i + 1,
                        href: getUrl(state),
                        active: currentPageNum === i,
                        state: state
                    })),
                    {
                        text: '»',
                        href: getUrl(lastItem),
                        active: currentPageNum === pages.length - 1,
                        state: lastItem
                    }
                ];
            }
        },

        methods: {
            navigate(event, state) {
                event.preventDefault();
                this.fire('navigate', state);
            }
        }
    };
</script>

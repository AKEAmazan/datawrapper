<div>
    <p>{ __("upload / select sheet") }</p>
    {#if !sheets.length}
    <div class="alert alert-info">Please wait while we're parsing the spreadsheet...</div>
    {/if}
    <select bind:value="selected">
        {#each sheets as sheet}
            <option value="{sheet}">{sheet.name}</option>
        {/each}
    </select>
</div>

<style>
    select { width: 70%; }
</style>

<script>
    import {__} from '../shared/l10n';

    /* globals dw */
    export default {
        data() {
            return {
                selected: false,
                sheets: []
            }
        },
        helpers: { __ },
        onupdate({changed, current}) {
            if (changed.sheets && current.sheets.length) {
                setTimeout(() => {
                    this.set({selected:current.sheets[0]});
                }, 300);
            }
            if (changed.selected) {
                this.set({chartData: current.selected.csv});
            }
        }
    }
</script>
